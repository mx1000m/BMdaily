{"version":3,"file":"QuantitySelector.js","sources":["../../../src/internal/components/QuantitySelector.tsx"],"sourcesContent":["import { useCallback, useState } from 'react';\nimport { TextInput } from '../../internal/components/TextInput';\nimport { background, border, cn, color, pressable } from '../../styles/theme';\n\nexport const DELAY_MS = 200;\n\ntype QuantitySelectorReact = {\n  className?: string;\n  disabled?: boolean;\n  minQuantity?: number;\n  maxQuantity?: number;\n  onChange: (s: string) => void;\n  placeholder: string;\n};\n\nexport function QuantitySelector({\n  className,\n  disabled,\n  minQuantity = 1,\n  maxQuantity = Number.MAX_SAFE_INTEGER,\n  onChange,\n  placeholder,\n}: QuantitySelectorReact) {\n  const [value, setValue] = useState(`${minQuantity}`);\n\n  // allow entering '' to enable backspace + new value, fix empty string on blur\n  const isValidQuantity = useCallback(\n    (v: string) => {\n      if (Number.parseInt(v, 10) < minQuantity) {\n        return false;\n      }\n\n      if (Number.parseInt(v, 10) > maxQuantity) {\n        return false;\n      }\n      // only numbers are valid\n      const regex = /^[0-9]*$/;\n      return regex.test(v);\n    },\n    [maxQuantity, minQuantity],\n  );\n\n  const handleIncrement = useCallback(() => {\n    const next = `${Math.min(maxQuantity, Number.parseInt(value, 10) + 1)}`;\n    setValue(next);\n    onChange(next);\n  }, [onChange, maxQuantity, value]);\n\n  const handleDecrement = useCallback(() => {\n    const next = `${Math.max(minQuantity, Number.parseInt(value, 10) - 1)}`;\n    setValue(next);\n    onChange(next);\n  }, [onChange, minQuantity, value]);\n\n  const handleOnChange = useCallback(\n    (v: string) => {\n      if (v === '') {\n        return;\n      }\n\n      onChange(v);\n    },\n    [onChange],\n  );\n\n  const handleBlur = useCallback(() => {\n    if (value === '') {\n      setValue(minQuantity.toString());\n      onChange(minQuantity.toString());\n    }\n  }, [onChange, minQuantity, value]);\n\n  const classNames = cn(\n    'h-11 w-11 rounded-lg border',\n    border.defaultActive,\n    color.foreground,\n    background.default,\n    disabled && pressable.disabled,\n  );\n\n  return (\n    <div\n      className={cn('relative flex items-center gap-1', className)}\n      data-testid=\"ockQuantitySelector\"\n    >\n      <div>\n        <button\n          aria-label=\"decrement\"\n          className={cn(classNames, pressable.default)}\n          data-testid=\"ockQuantitySelector_decrement\"\n          disabled={disabled}\n          onClick={handleDecrement}\n          type=\"button\"\n        >\n          -\n        </button>\n      </div>\n      <TextInput\n        aria-label=\"quantity\"\n        className={cn(\n          classNames,\n          'w-full text-center hover:bg-[var(--ock-bg-default-hover)] focus:bg-transparent',\n        )}\n        delayMs={DELAY_MS}\n        disabled={disabled}\n        inputValidator={isValidQuantity}\n        onBlur={handleBlur}\n        onChange={handleOnChange}\n        placeholder={placeholder}\n        setValue={setValue}\n        value={value}\n      />\n      <div>\n        <button\n          aria-label=\"increment\"\n          className={cn(classNames, pressable.default)}\n          data-testid=\"ockQuantitySelector_increment\"\n          disabled={disabled}\n          onClick={handleIncrement}\n          type=\"button\"\n        >\n          +\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAIO,MAAM,WAAW;AAWjB,SAAS,iBAAiB;AAAA,EAC/B;AAAA,EACA;AAAA,EACA,cAAc;AAAA,EACd,cAAc,OAAO;AAAA,EACrB;AAAA,EACA;AACF,GAA0B;AACxB,QAAM,CAAC,OAAO,QAAQ,IAAI,SAAS,GAAG,WAAW,EAAE;AAGnD,QAAM,kBAAkB;AAAA,IACtB,CAAC,MAAc;AACb,UAAI,OAAO,SAAS,GAAG,EAAE,IAAI,aAAa;AACjC,eAAA;AAAA,MAAA;AAGT,UAAI,OAAO,SAAS,GAAG,EAAE,IAAI,aAAa;AACjC,eAAA;AAAA,MAAA;AAGT,YAAM,QAAQ;AACP,aAAA,MAAM,KAAK,CAAC;AAAA,IACrB;AAAA,IACA,CAAC,aAAa,WAAW;AAAA,EAC3B;AAEM,QAAA,kBAAkB,YAAY,MAAM;AAClC,UAAA,OAAO,GAAG,KAAK,IAAI,aAAa,OAAO,SAAS,OAAO,EAAE,IAAI,CAAC,CAAC;AACrE,aAAS,IAAI;AACb,aAAS,IAAI;AAAA,EACZ,GAAA,CAAC,UAAU,aAAa,KAAK,CAAC;AAE3B,QAAA,kBAAkB,YAAY,MAAM;AAClC,UAAA,OAAO,GAAG,KAAK,IAAI,aAAa,OAAO,SAAS,OAAO,EAAE,IAAI,CAAC,CAAC;AACrE,aAAS,IAAI;AACb,aAAS,IAAI;AAAA,EACZ,GAAA,CAAC,UAAU,aAAa,KAAK,CAAC;AAEjC,QAAM,iBAAiB;AAAA,IACrB,CAAC,MAAc;AACb,UAAI,MAAM,IAAI;AACZ;AAAA,MAAA;AAGF,eAAS,CAAC;AAAA,IACZ;AAAA,IACA,CAAC,QAAQ;AAAA,EACX;AAEM,QAAA,aAAa,YAAY,MAAM;AACnC,QAAI,UAAU,IAAI;AACP,eAAA,YAAY,UAAU;AACtB,eAAA,YAAY,UAAU;AAAA,IAAA;AAAA,EAEhC,GAAA,CAAC,UAAU,aAAa,KAAK,CAAC;AAEjC,QAAM,aAAa;AAAA,IACjB;AAAA,IACA,OAAO;AAAA,IACP,MAAM;AAAA,IACN,WAAW;AAAA,IACX,YAAY,UAAU;AAAA,EACxB;AAGE,SAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,GAAG,oCAAoC,SAAS;AAAA,MAC3D,eAAY;AAAA,MAEZ,UAAA;AAAA,QAAA,oBAAC,OACC,EAAA,UAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,cAAW;AAAA,YACX,WAAW,GAAG,YAAY,UAAU,OAAO;AAAA,YAC3C,eAAY;AAAA,YACZ;AAAA,YACA,SAAS;AAAA,YACT,MAAK;AAAA,YACN,UAAA;AAAA,UAAA;AAAA,QAAA,GAGH;AAAA,QACA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,cAAW;AAAA,YACX,WAAW;AAAA,cACT;AAAA,cACA;AAAA,YACF;AAAA,YACA,SAAS;AAAA,YACT;AAAA,YACA,gBAAgB;AAAA,YAChB,QAAQ;AAAA,YACR,UAAU;AAAA,YACV;AAAA,YACA;AAAA,YACA;AAAA,UAAA;AAAA,QACF;AAAA,4BACC,OACC,EAAA,UAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,cAAW;AAAA,YACX,WAAW,GAAG,YAAY,UAAU,OAAO;AAAA,YAC3C,eAAY;AAAA,YACZ;AAAA,YACA,SAAS;AAAA,YACT,MAAK;AAAA,YACN,UAAA;AAAA,UAAA;AAAA,QAAA,EAGH,CAAA;AAAA,MAAA;AAAA,IAAA;AAAA,EACF;AAEJ;"}