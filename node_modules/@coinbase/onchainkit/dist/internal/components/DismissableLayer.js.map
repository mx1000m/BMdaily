{"version":3,"file":"DismissableLayer.js","sources":["../../../src/internal/components/DismissableLayer.tsx"],"sourcesContent":["import type React from 'react';\nimport { useEffect, useRef } from 'react';\n\ntype DismissableLayerProps = {\n  children?: React.ReactNode;\n  disableEscapeKey?: boolean;\n  disableOutsideClick?: boolean;\n  onDismiss?: () => void;\n  /**\n   * Reference to the trigger element (e.g., button) that opens this layer.\n   * Prevents the layer from being dismissed when the trigger is clicked, enabling proper toggle behavior.\n   */\n  triggerRef?: React.RefObject<HTMLElement>;\n  /**\n   * When `true`, prevents trigger click events from bubbling up.\n   * Useful for bottom sheets to prevent unwanted side effects.\n   */\n  preventTriggerEvents?: boolean;\n};\n\n/**\n * DismissableLayer handles dismissal using outside clicks and escape key events\n */\nexport function DismissableLayer({\n  children,\n  disableEscapeKey = false,\n  disableOutsideClick = false,\n  onDismiss,\n  triggerRef,\n  preventTriggerEvents = false,\n}: DismissableLayerProps) {\n  const layerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (disableOutsideClick && disableEscapeKey) {\n      return;\n    }\n\n    const handleTriggerClick = (event: PointerEvent) => {\n      if (preventTriggerEvents) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    };\n\n    const isClickInsideLayer = (target: Node) => {\n      return layerRef.current?.contains(target);\n    };\n\n    const handlePointerDownCapture = (event: PointerEvent) => {\n      if (disableOutsideClick) {\n        return;\n      }\n\n      if (!(event.target instanceof Node)) {\n        return;\n      }\n\n      const target = event.target;\n\n      if (triggerRef?.current?.contains(target)) {\n        handleTriggerClick(event);\n        return;\n      }\n\n      if (!isClickInsideLayer(target)) {\n        onDismiss?.();\n      }\n    };\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (!disableEscapeKey && event.key === 'Escape') {\n        onDismiss?.();\n      }\n    };\n\n    document.addEventListener('pointerdown', handlePointerDownCapture, true);\n    document.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      document.removeEventListener(\n        'pointerdown',\n        handlePointerDownCapture,\n        true,\n      );\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [\n    disableOutsideClick,\n    disableEscapeKey,\n    onDismiss,\n    triggerRef,\n    preventTriggerEvents,\n  ]);\n\n  return (\n    <div data-testid=\"ockDismissableLayer\" ref={layerRef}>\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;AAuBO,SAAS,iBAAiB;AAAA,EAC/B;AAAA,EACA,mBAAmB;AAAA,EACnB,sBAAsB;AAAA,EACtB;AAAA,EACA;AAAA,EACA,uBAAuB;AACzB,GAA0B;AAClB,QAAA,WAAW,OAAuB,IAAI;AAE5C,YAAU,MAAM;AACd,QAAI,uBAAuB,kBAAkB;AAC3C;AAAA,IAAA;AAGI,UAAA,qBAAqB,CAAC,UAAwB;AAClD,UAAI,sBAAsB;AACxB,cAAM,eAAe;AACrB,cAAM,gBAAgB;AAAA,MAAA;AAAA,IAE1B;AAEM,UAAA,qBAAqB,CAAC,WAAiB;;AACpC,cAAA,cAAS,YAAT,mBAAkB,SAAS;AAAA,IACpC;AAEM,UAAA,2BAA2B,CAAC,UAAwB;;AACxD,UAAI,qBAAqB;AACvB;AAAA,MAAA;AAGE,UAAA,EAAE,MAAM,kBAAkB,OAAO;AACnC;AAAA,MAAA;AAGF,YAAM,SAAS,MAAM;AAErB,WAAI,8CAAY,YAAZ,mBAAqB,SAAS,SAAS;AACzC,2BAAmB,KAAK;AACxB;AAAA,MAAA;AAGE,UAAA,CAAC,mBAAmB,MAAM,GAAG;AACnB;AAAA,MAAA;AAAA,IAEhB;AAEM,UAAA,gBAAgB,CAAC,UAAyB;AAC9C,UAAI,CAAC,oBAAoB,MAAM,QAAQ,UAAU;AACnC;AAAA,MAAA;AAAA,IAEhB;AAES,aAAA,iBAAiB,eAAe,0BAA0B,IAAI;AAC9D,aAAA,iBAAiB,WAAW,aAAa;AAElD,WAAO,MAAM;AACF,eAAA;AAAA,QACP;AAAA,QACA;AAAA,QACA;AAAA,MACF;AACS,eAAA,oBAAoB,WAAW,aAAa;AAAA,IACvD;AAAA,EAAA,GACC;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA,CACD;AAED,6BACG,OAAI,EAAA,eAAY,uBAAsB,KAAK,UACzC,UACH;AAEJ;"}