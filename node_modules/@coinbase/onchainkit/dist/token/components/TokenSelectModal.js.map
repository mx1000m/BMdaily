{"version":3,"file":"TokenSelectModal.js","sources":["../../../src/token/components/TokenSelectModal.tsx"],"sourcesContent":["'use client';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { background, cn, text } from '../../styles/theme';\nimport type { Token, TokenSelectModalReact } from '../types';\nimport { TokenChip } from './TokenChip';\nimport { TokenRow } from './TokenRow';\nimport { TokenSearch } from './TokenSearch';\nimport { TokenSelectButton } from './TokenSelectButton';\n\nconst backdropStyle = {\n  background: 'rgba(226, 232, 240, 0.5)',\n};\n\ntype TokenSelectModalInnerReact = {\n  setToken: (t: Token) => void;\n  closeModal: () => void;\n  options: Token[];\n};\n\nfunction TokenSelectModalInner({\n  setToken,\n  closeModal,\n  options,\n}: TokenSelectModalInnerReact) {\n  const [filteredTokens, setFilteredTokens] = useState(options);\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  const handleClick = useCallback(\n    (token: Token) => {\n      setToken(token);\n      closeModal();\n    },\n    [setToken, closeModal],\n  );\n\n  const handleChange = useCallback(\n    (text: string) => {\n      setFilteredTokens(\n        options.filter(({ address, name, symbol }) => {\n          return (\n            address.toLowerCase().startsWith(text) ||\n            name.toLowerCase().includes(text) ||\n            symbol.toLowerCase().includes(text)\n          );\n        }),\n      );\n    },\n    [options],\n  );\n\n  /* v8 ignore next 10 */\n  const handleBlur = useCallback(\n    (event: MouseEvent) => {\n      const isOutsideModal =\n        modalRef.current && !modalRef.current.contains(event.target as Node);\n      if (isOutsideModal) {\n        closeModal();\n      }\n    },\n    [closeModal],\n  );\n\n  useEffect(() => {\n    // NOTE: this ensures that handleBlur doesn't get called on initial mount\n    //       We need to use non-div elements to properly handle onblur events\n    setTimeout(() => {\n      document.addEventListener('click', handleBlur);\n    }, 0);\n    return () => {\n      document.removeEventListener('click', handleBlur);\n    };\n  }, [handleBlur]);\n\n  return (\n    <div\n      data-testid=\"ockTokenSelectModal_Inner\"\n      className=\"fixed top-0 left-0 z-50 flex h-full w-full items-center justify-center\"\n      style={backdropStyle}\n    >\n      <div\n        ref={modalRef}\n        className={cn(\n          background.default,\n          'flex w-[475px] flex-col gap-3 rounded-3xl p-6',\n        )}\n      >\n        <div className=\"flex items-center justify-between\">\n          <span className={text.title3}>Select a token</span>\n          <button\n            data-testid=\"TokenSelectModal_CloseButton\"\n            type=\"button\"\n            onClick={closeModal}\n          >\n            <svg\n              role=\"img\"\n              aria-label=\"ock-close-icon\"\n              width=\"16\"\n              height=\"16\"\n              viewBox=\"0 0 16 16\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <path\n                d=\"M2.3352 1L1 2.33521L6.66479 8L1 13.6648L2.3352 15L8 9.33521L13.6648 15L15 13.6648L9.33521 8L15 2.33521L13.6648 1L8 6.6648L2.3352 1Z\"\n                fill=\"#0A0B0D\"\n              />\n            </svg>\n          </button>\n        </div>\n        <TokenSearch onChange={handleChange} delayMs={0} />\n        {filteredTokens.length > 0 && (\n          <div className=\"flex flex-wrap gap-2\">\n            {filteredTokens.slice(0, 4).map((token, idx) => (\n              <TokenChip\n                key={`${token.name}${idx}`}\n                className=\"shadow-none\"\n                token={token}\n                onClick={handleClick}\n              />\n            ))}\n          </div>\n        )}\n        {filteredTokens.length > 0 ? (\n          <div className=\"mt-3\">\n            <div className=\"text-black text-body\">Tokens</div>\n            <div\n              className=\"ock-scrollbar overflow-y-auto\"\n              style={{ minHeight: '300px', height: '300px' }}\n            >\n              {filteredTokens.map((token, idx) => (\n                <TokenRow\n                  key={`${token.name}${idx}`}\n                  token={token}\n                  onClick={handleClick}\n                />\n              ))}\n            </div>\n          </div>\n        ) : (\n          <div\n            data-testid=\"ockTokenSelectModal_NoTokens\"\n            className=\"text-black text-body\"\n            style={{ minHeight: '368px' }}\n          >\n            No tokens found\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function TokenSelectModal({\n  options,\n  setToken,\n  token,\n}: TokenSelectModalReact) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const closeModal = useCallback(() => {\n    setIsOpen(false);\n  }, []);\n\n  const openModal = useCallback(() => {\n    setIsOpen(true);\n  }, []);\n\n  return (\n    <>\n      <TokenSelectButton onClick={openModal} isOpen={isOpen} token={token} />\n      {isOpen && (\n        <TokenSelectModalInner\n          options={options}\n          setToken={setToken}\n          closeModal={closeModal}\n        />\n      )}\n    </>\n  );\n}\n"],"names":["text"],"mappings":"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"}