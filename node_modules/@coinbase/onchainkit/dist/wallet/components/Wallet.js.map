{"version":3,"file":"Wallet.js","sources":["../../../src/wallet/components/Wallet.tsx"],"sourcesContent":["'use client';\n\nimport { Draggable } from '@/internal/components/Draggable/Draggable';\nimport { useIsMounted } from '@/internal/hooks/useIsMounted';\nimport { useOutsideClick } from '@/internal/hooks/useOutsideClick';\nimport { useTheme } from '@/internal/hooks/useTheme';\nimport { findComponent } from '@/internal/utils/findComponent';\nimport { cn } from '@/styles/theme';\nimport {\n  Children,\n  type ReactNode,\n  isValidElement,\n  useMemo,\n  useRef,\n} from 'react';\nimport type { WalletReact } from '../types';\nimport { getWalletDraggableProps } from '../utils/getWalletDraggableProps';\nimport { ConnectWallet } from './ConnectWallet';\nimport { WalletAdvanced } from './WalletAdvanced';\nimport { WalletDropdown } from './WalletDropdown';\nimport { WalletProvider, useWalletContext } from './WalletProvider';\n\nconst defaultWalletChildren = (\n  <>\n    <ConnectWallet />\n    <WalletDropdown />\n  </>\n);\n\nexport function Wallet({\n  children,\n  className,\n  draggable,\n  draggableStartingPosition,\n  isSponsored,\n}: WalletReact) {\n  const componentTheme = useTheme();\n  const isMounted = useIsMounted();\n\n  // prevents SSR hydration issue\n  if (!isMounted) {\n    return null;\n  }\n\n  return (\n    <WalletProvider isSponsored={isSponsored}>\n      <WalletContent\n        className={cn(componentTheme, className)}\n        {...getWalletDraggableProps({ draggable, draggableStartingPosition })}\n      >\n        {children}\n      </WalletContent>\n    </WalletProvider>\n  );\n}\n\nfunction WalletContent({\n  children,\n  className,\n  draggable,\n  draggableStartingPosition,\n}: WalletReact) {\n  const {\n    isSubComponentOpen,\n    isConnectModalOpen,\n    handleClose,\n    connectRef,\n    breakpoint,\n  } = useWalletContext();\n  const walletContainerRef = useRef<HTMLDivElement>(null);\n\n  useOutsideClick(walletContainerRef, handleClose);\n\n  // Note: this can be removed after deprecating WalletAdvanced\n  const { dropdown, advanced } = useMemo(() => {\n    const childrenArray = Children.toArray(children);\n    return {\n      dropdown: childrenArray.find(findComponent(WalletDropdown)),\n      advanced: childrenArray.find(findComponent(WalletAdvanced)),\n    };\n  }, [children]);\n\n  // Note: this can be removed after deprecating WalletAdvanced\n  // cannot use advanced and dropdown,\n  // default to dropdown\n  const childrenToRender = useMemo(() => {\n    return Children.map(children, (child: ReactNode) => {\n      if (isValidElement(child) && child.type === WalletAdvanced && dropdown) {\n        return null;\n      }\n      return child;\n    });\n  }, [dropdown, children]);\n\n  // Note: this can be removed after deprecating WalletAdvanced\n  if (dropdown && advanced) {\n    console.error(\n      'Defaulted to WalletDropdown. Wallet cannot have both WalletDropdown and WalletAdvanced as children.',\n    );\n  }\n\n  // dragging should be disabled when the connect wallet modal is open\n  // or when the subcomponent is open on mobile (because then we use bottom sheet)\n  const disableDraggable =\n    isConnectModalOpen || (breakpoint === 'sm' && isSubComponentOpen);\n\n  if (draggable) {\n    return (\n      <div\n        ref={walletContainerRef}\n        className={cn('relative w-fit shrink-0', className)}\n      >\n        <Draggable\n          startingPosition={draggableStartingPosition}\n          disabled={disableDraggable}\n        >\n          <div ref={connectRef}>\n            {/* Note: update childrenToRender to children after deprecating WalletAdvanced */}\n            {childrenToRender || defaultWalletChildren}\n          </div>\n        </Draggable>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      ref={walletContainerRef}\n      className={cn('relative w-fit shrink-0', className)}\n    >\n      {/* Note: update childrenToRender to children after deprecating WalletAdvanced */}\n      <div ref={connectRef}>{childrenToRender || defaultWalletChildren}</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAsBA,MAAM,wBAEF,qBAAA,UAAA,EAAA,UAAA;AAAA,EAAA,oBAAC,eAAc,EAAA;AAAA,sBACd,gBAAe,CAAA,CAAA;AAAA,GAClB;AAGK,SAAS,OAAO;AAAA,EACrB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,GAAgB;AACd,QAAM,iBAAiB,SAAS;AAChC,QAAM,YAAY,aAAa;AAG/B,MAAI,CAAC,WAAW;AACP,WAAA;AAAA,EAAA;AAIP,SAAA,oBAAC,kBAAe,aACd,UAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,GAAG,gBAAgB,SAAS;AAAA,MACtC,GAAG,wBAAwB,EAAE,WAAW,2BAA2B;AAAA,MAEnE;AAAA,IAAA;AAAA,EAAA,GAEL;AAEJ;AAEA,SAAS,cAAc;AAAA,EACrB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,GAAgB;AACR,QAAA;AAAA,IACJ;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,MACE,iBAAiB;AACf,QAAA,qBAAqB,OAAuB,IAAI;AAEtD,kBAAgB,oBAAoB,WAAW;AAG/C,QAAM,EAAE,UAAU,SAAS,IAAI,QAAQ,MAAM;AACrC,UAAA,gBAAgB,SAAS,QAAQ,QAAQ;AACxC,WAAA;AAAA,MACL,UAAU,cAAc,KAAK,cAAc,cAAc,CAAC;AAAA,MAC1D,UAAU,cAAc,KAAK,cAAc,cAAc,CAAC;AAAA,IAC5D;AAAA,EAAA,GACC,CAAC,QAAQ,CAAC;AAKP,QAAA,mBAAmB,QAAQ,MAAM;AACrC,WAAO,SAAS,IAAI,UAAU,CAAC,UAAqB;AAClD,UAAI,eAAe,KAAK,KAAK,MAAM,SAAS,kBAAkB,UAAU;AAC/D,eAAA;AAAA,MAAA;AAEF,aAAA;AAAA,IAAA,CACR;AAAA,EAAA,GACA,CAAC,UAAU,QAAQ,CAAC;AAGvB,MAAI,YAAY,UAAU;AAChB,YAAA;AAAA,MACN;AAAA,IACF;AAAA,EAAA;AAKI,QAAA,mBACJ,sBAAuB,eAAe,QAAQ;AAEhD,MAAI,WAAW;AAEX,WAAA;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,KAAK;AAAA,QACL,WAAW,GAAG,2BAA2B,SAAS;AAAA,QAElD,UAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,kBAAkB;AAAA,YAClB,UAAU;AAAA,YAEV,UAAC,oBAAA,OAAA,EAAI,KAAK,YAEP,8BAAoB,sBACvB,CAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MACF;AAAA,IACF;AAAA,EAAA;AAKF,SAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAK;AAAA,MACL,WAAW,GAAG,2BAA2B,SAAS;AAAA,MAGlD,UAAC,oBAAA,OAAA,EAAI,KAAK,YAAa,8BAAoB,sBAAsB,CAAA;AAAA,IAAA;AAAA,EACnE;AAEJ;"}