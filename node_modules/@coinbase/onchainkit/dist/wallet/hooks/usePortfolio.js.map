{"version":3,"file":"usePortfolio.js","sources":["../../../src/wallet/hooks/usePortfolio.ts"],"sourcesContent":["import { getPortfolios } from '@/api/getPortfolios';\nimport type { Portfolio } from '@/api/types';\nimport { RequestContext } from '@/core/network/constants';\nimport { isApiError } from '@/internal/utils/isApiResponseError';\nimport { type UseQueryResult, useQuery } from '@tanstack/react-query';\nimport type { Address } from 'viem';\n\ntype UsePortfolioProps = {\n  address: Address | undefined | null;\n  enabled?: boolean;\n};\n\n/**\n * Retrieves the portfolio for the provided address\n * portfolio includes the address, the balance of the address in USD, and the tokens in the address\n */\nexport function usePortfolio(\n  { address, enabled = true }: UsePortfolioProps,\n  _context: RequestContext = RequestContext.Hook,\n): UseQueryResult<Portfolio> {\n  return useQuery({\n    queryKey: ['usePortfolio', address],\n    queryFn: async () => {\n      const response = await getPortfolios(\n        {\n          addresses: [address as Address], // Safe to coerce to Address because useQuery's enabled flag will prevent the query from running if address is undefined\n        },\n        _context,\n      );\n\n      if (isApiError(response)) {\n        throw new Error(response.message);\n      }\n\n      if (response.portfolios.length === 0) {\n        return {\n          address,\n          portfolioBalanceUsd: 0,\n          tokenBalances: [],\n        };\n      }\n\n      return response.portfolios[0];\n    },\n    retry: false,\n    enabled: !!address && enabled,\n    refetchOnWindowFocus: true, // refresh on window focus\n    staleTime: 1000 * 60 * 5, // refresh on mount every 5 minutes\n    refetchOnMount: true,\n    refetchInterval: 1000 * 60 * 15, // refresh in background every 15 minutes\n    refetchIntervalInBackground: true,\n  });\n}\n"],"names":[],"mappings":";;;;AAgBgB,SAAA,aACd,EAAE,SAAS,UAAU,QACrB,WAA2B,eAAe,MACf;AAC3B,SAAO,SAAS;AAAA,IACd,UAAU,CAAC,gBAAgB,OAAO;AAAA,IAClC,SAAS,YAAY;AACnB,YAAM,WAAW,MAAM;AAAA,QACrB;AAAA,UACE,WAAW,CAAC,OAAkB;AAAA;AAAA,QAChC;AAAA,QACA;AAAA,MACF;AAEI,UAAA,WAAW,QAAQ,GAAG;AAClB,cAAA,IAAI,MAAM,SAAS,OAAO;AAAA,MAAA;AAG9B,UAAA,SAAS,WAAW,WAAW,GAAG;AAC7B,eAAA;AAAA,UACL;AAAA,UACA,qBAAqB;AAAA,UACrB,eAAe,CAAA;AAAA,QACjB;AAAA,MAAA;AAGK,aAAA,SAAS,WAAW,CAAC;AAAA,IAC9B;AAAA,IACA,OAAO;AAAA,IACP,SAAS,CAAC,CAAC,WAAW;AAAA,IACtB,sBAAsB;AAAA;AAAA,IACtB,WAAW,MAAO,KAAK;AAAA;AAAA,IACvB,gBAAgB;AAAA,IAChB,iBAAiB,MAAO,KAAK;AAAA;AAAA,IAC7B,6BAA6B;AAAA,EAAA,CAC9B;AACH;"}