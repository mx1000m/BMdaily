{"version":3,"file":"useFundCardSetupOnrampEventListeners.js","sources":["../../../src/fund/hooks/useFundCardSetupOnrampEventListeners.ts"],"sourcesContent":["import { useCallback, useEffect } from 'react';\nimport { useFundContext } from '../components/FundCardProvider';\nimport { FUND_BUTTON_RESET_TIMEOUT } from '../constants';\nimport type { EventMetadata, SuccessEventData } from '../types';\nimport { setupOnrampEventListeners } from '../utils/setupOnrampEventListeners';\n\nexport const useFundCardSetupOnrampEventListeners = () => {\n  const { setSubmitButtonState, updateLifecycleStatus } = useFundContext();\n\n  const handleOnrampEvent = useCallback(\n    (data: EventMetadata) => {\n      if (data.eventName === 'transition_view') {\n        updateLifecycleStatus({\n          statusName: 'transactionPending',\n          statusData: undefined,\n        });\n      } else if (data.eventName === 'error') {\n        updateLifecycleStatus({\n          statusName: 'error',\n          statusData: data.error,\n        });\n\n        setSubmitButtonState('error');\n        setTimeout(() => {\n          setSubmitButtonState('default');\n        }, FUND_BUTTON_RESET_TIMEOUT);\n      }\n    },\n    [updateLifecycleStatus, setSubmitButtonState],\n  );\n\n  const handleOnrampSuccess = useCallback(\n    (data?: SuccessEventData) => {\n      updateLifecycleStatus({\n        statusName: 'transactionSuccess',\n        statusData: data,\n      });\n\n      setSubmitButtonState('success');\n\n      setTimeout(() => {\n        setSubmitButtonState('default');\n      }, FUND_BUTTON_RESET_TIMEOUT);\n    },\n    [updateLifecycleStatus, setSubmitButtonState],\n  );\n\n  const handleOnrampExit = useCallback(() => {\n    setSubmitButtonState('default');\n\n    updateLifecycleStatus({\n      statusName: 'exit',\n      statusData: undefined,\n    });\n  }, [updateLifecycleStatus, setSubmitButtonState]);\n\n  useEffect(() => {\n    const unsubscribe = setupOnrampEventListeners({\n      onEvent: handleOnrampEvent,\n      onExit: handleOnrampExit,\n      onSuccess: handleOnrampSuccess,\n    });\n\n    return () => {\n      unsubscribe();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n"],"names":[],"mappings":";;;;AAMO,MAAM,uCAAuC,MAAM;AACxD,QAAM,EAAE,sBAAsB,sBAAsB,IAAI,eAAe;AAEvE,QAAM,oBAAoB;AAAA,IACxB,CAAC,SAAwB;AACnB,UAAA,KAAK,cAAc,mBAAmB;AAClB,8BAAA;AAAA,UACpB,YAAY;AAAA,UACZ,YAAY;AAAA,QAAA,CACb;AAAA,MAAA,WACQ,KAAK,cAAc,SAAS;AACf,8BAAA;AAAA,UACpB,YAAY;AAAA,UACZ,YAAY,KAAK;AAAA,QAAA,CAClB;AAED,6BAAqB,OAAO;AAC5B,mBAAW,MAAM;AACf,+BAAqB,SAAS;AAAA,WAC7B,yBAAyB;AAAA,MAAA;AAAA,IAEhC;AAAA,IACA,CAAC,uBAAuB,oBAAoB;AAAA,EAC9C;AAEA,QAAM,sBAAsB;AAAA,IAC1B,CAAC,SAA4B;AACL,4BAAA;AAAA,QACpB,YAAY;AAAA,QACZ,YAAY;AAAA,MAAA,CACb;AAED,2BAAqB,SAAS;AAE9B,iBAAW,MAAM;AACf,6BAAqB,SAAS;AAAA,SAC7B,yBAAyB;AAAA,IAC9B;AAAA,IACA,CAAC,uBAAuB,oBAAoB;AAAA,EAC9C;AAEM,QAAA,mBAAmB,YAAY,MAAM;AACzC,yBAAqB,SAAS;AAER,0BAAA;AAAA,MACpB,YAAY;AAAA,MACZ,YAAY;AAAA,IAAA,CACb;AAAA,EAAA,GACA,CAAC,uBAAuB,oBAAoB,CAAC;AAEhD,YAAU,MAAM;AACd,UAAM,cAAc,0BAA0B;AAAA,MAC5C,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,WAAW;AAAA,IAAA,CACZ;AAED,WAAO,MAAM;AACC,kBAAA;AAAA,IACd;AAAA,EAEF,GAAG,EAAE;AACP;"}