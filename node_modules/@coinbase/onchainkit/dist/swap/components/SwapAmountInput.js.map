{"version":3,"file":"SwapAmountInput.js","sources":["../../../src/swap/components/SwapAmountInput.tsx"],"sourcesContent":["'use client';\nimport { useCallback, useEffect, useMemo } from 'react';\nimport { useAnalytics } from '../../core/analytics/hooks/useAnalytics';\nimport { SwapEvent } from '../../core/analytics/types';\nimport { TextInput } from '../../internal/components/TextInput';\nimport { useValue } from '../../internal/hooks/useValue';\nimport { getRoundedAmount } from '../../internal/utils/getRoundedAmount';\nimport { isValidAmount } from '../../internal/utils/isValidAmount';\nimport {\n  background,\n  border,\n  cn,\n  color,\n  pressable,\n  text,\n} from '../../styles/theme';\nimport type { Token } from '../../token';\nimport { TokenChip, TokenSelectDropdown } from '../../token';\nimport type { SwapAmountInputReact } from '../types';\nimport { formatAmount } from '../utils/formatAmount';\nimport { useSwapContext } from './SwapProvider';\n\nexport function SwapAmountInput({\n  className,\n  delayMs = 1000,\n  label,\n  token,\n  type,\n  swappableTokens,\n}: SwapAmountInputReact) {\n  const { address, to, from, handleAmountChange } = useSwapContext();\n  const { sendAnalytics } = useAnalytics();\n\n  const source = useValue(type === 'from' ? from : to);\n  const destination = useValue(type === 'from' ? to : from);\n  const { setToken, setAmount, balance, amount, amountUSD } = source;\n\n  useEffect(() => {\n    if (token) {\n      setToken?.(token);\n    }\n  }, [token, setToken]);\n\n  const handleMaxButtonClick = useCallback(() => {\n    if (!balance) {\n      return;\n    }\n    setAmount(balance);\n    handleAmountChange(type, balance);\n  }, [balance, setAmount, handleAmountChange, type]);\n\n  const handleChange = useCallback(\n    (amount: string) => {\n      handleAmountChange(type, amount);\n    },\n    [handleAmountChange, type],\n  );\n\n  const handleAnalyticsTokenSelected = useCallback(\n    (token: Token) => {\n      sendAnalytics(SwapEvent.TokenSelected, {\n        token: token.symbol,\n      });\n    },\n    [sendAnalytics],\n  );\n\n  const handleSetToken = useCallback(\n    (token: Token) => {\n      setToken?.(token);\n      handleAmountChange(type, amount, token);\n      handleAnalyticsTokenSelected(token);\n    },\n    [amount, setToken, handleAmountChange, handleAnalyticsTokenSelected, type],\n  );\n\n  // We are mocking the token selectors so I'm not able\n  // to test this since the components aren't actually rendering\n  const sourceTokenOptions = useMemo(() => {\n    return (\n      swappableTokens?.filter(\n        ({ symbol }: Token) => symbol !== destination.token?.symbol,\n      ) ?? []\n    );\n  }, [swappableTokens, destination.token]);\n\n  const hasInsufficientBalance =\n    type === 'from' && Number(balance) < Number(amount);\n\n  const formatUSD = (amount: string) => {\n    if (!amount || amount === '0') {\n      return null;\n    }\n    const roundedAmount = Number(getRoundedAmount(amount, 2));\n    return `~$${roundedAmount.toFixed(2)}`;\n  };\n\n  return (\n    <div\n      className={cn(\n        background.secondary,\n        border.radius,\n        'my-0.5 box-border flex h-[148px] w-full flex-col items-start p-4',\n        className,\n      )}\n      data-testid=\"ockSwapAmountInput_Container\"\n    >\n      <div\n        className={cn(\n          text.label2,\n          color.foregroundMuted,\n          'flex w-full items-center justify-between',\n        )}\n      >\n        {label}\n      </div>\n      <div className=\"flex w-full items-center justify-between\">\n        <TextInput\n          className={cn(\n            'mr-2 w-full border-[none] bg-transparent font-display text-[2.5rem]',\n            'leading-none outline-none',\n            hasInsufficientBalance && address ? color.error : color.foreground,\n          )}\n          placeholder=\"0.0\"\n          delayMs={delayMs}\n          value={formatAmount(amount)}\n          setValue={setAmount}\n          disabled={source.loading}\n          onChange={handleChange}\n          inputValidator={isValidAmount}\n        />\n        {sourceTokenOptions.length > 0 ? (\n          <TokenSelectDropdown\n            token={source.token}\n            setToken={handleSetToken}\n            options={sourceTokenOptions}\n          />\n        ) : (\n          source.token && (\n            <TokenChip className={pressable.inverse} token={source.token} />\n          )\n        )}\n      </div>\n      <div className=\"mt-4 flex w-full items-center justify-between\">\n        <div className={cn(text.label2, color.foregroundMuted)}>\n          {formatUSD(amountUSD)}\n        </div>\n        <div\n          className={cn(\n            text.label2,\n            color.foregroundMuted,\n            'flex grow items-center justify-end',\n          )}\n        >\n          {balance && <span>{`Balance: ${getRoundedAmount(balance, 8)}`}</span>}\n          {type === 'from' && address && (\n            <button\n              type=\"button\"\n              className={cn(\n                text.label1,\n                color.primary,\n                'flex cursor-pointer items-center justify-center px-2 py-1',\n              )}\n              data-testid=\"ockSwapAmountInput_MaxButton\"\n              onClick={handleMaxButtonClick}\n            >\n              Max\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["amount","token"],"mappings":"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"}