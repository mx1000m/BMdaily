{"version":3,"file":"DefaultOnchainKitProviders.js","sources":["../src/DefaultOnchainKitProviders.tsx"],"sourcesContent":["import { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport {\n  type PropsWithChildren,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Config, WagmiProvider } from 'wagmi';\nimport { baseAccount } from 'wagmi/connectors';\nimport { createWagmiConfig } from './core/createWagmiConfig';\nimport { useProviderDependencies } from './internal/hooks/useProviderDependencies';\nimport { useOnchainKit } from './useOnchainKit';\nimport type { CreateWagmiConfigParams } from './core/types';\n\nexport function DefaultOnchainKitProviders({\n  children,\n  connectors,\n}: PropsWithChildren<{ connectors?: CreateWagmiConfigParams['connectors'] }>) {\n  // Check the React context for WagmiProvider and QueryClientProvider\n  const { providedWagmiConfig, providedQueryClient } =\n    useProviderDependencies();\n\n  return (\n    <WagmiProviderWithDefault\n      providedWagmiConfig={providedWagmiConfig}\n      connectors={connectors}\n    >\n      <QueryClientProviderWithDefault providedQueryClient={providedQueryClient}>\n        {children}\n      </QueryClientProviderWithDefault>\n    </WagmiProviderWithDefault>\n  );\n}\n\nfunction WagmiProviderWithDefault({\n  children,\n  providedWagmiConfig,\n  connectors,\n}: PropsWithChildren<{\n  providedWagmiConfig: Config | null;\n  connectors?: CreateWagmiConfigParams['connectors'];\n}>) {\n  const onchainKitConfig = useOnchainKit();\n  const prevConnectorsRef =\n    useRef<CreateWagmiConfigParams['connectors']>(connectors);\n\n  const getWagmiConfig = useCallback(() => {\n    if (providedWagmiConfig) return providedWagmiConfig;\n\n    const appName = onchainKitConfig.config?.appearance?.name ?? undefined;\n    const appLogoUrl = onchainKitConfig.config?.appearance?.logo ?? undefined;\n\n    return createWagmiConfig({\n      apiKey: onchainKitConfig.apiKey ?? undefined,\n      appName,\n      appLogoUrl,\n      connectors: connectors ?? [\n        baseAccount({\n          appName,\n          appLogoUrl,\n        }),\n      ],\n    });\n  }, [\n    onchainKitConfig.apiKey,\n    onchainKitConfig.config,\n    connectors,\n    providedWagmiConfig,\n  ]);\n\n  const [config, setConfig] = useState(() => {\n    return getWagmiConfig();\n  });\n\n  useEffect(() => {\n    if (prevConnectorsRef.current !== connectors) {\n      setConfig(getWagmiConfig());\n      prevConnectorsRef.current = connectors;\n    }\n  }, [connectors, getWagmiConfig]);\n\n  if (providedWagmiConfig) {\n    return children;\n  }\n\n  return <WagmiProvider config={config}>{children}</WagmiProvider>;\n}\n\nfunction QueryClientProviderWithDefault({\n  children,\n  providedQueryClient,\n}: PropsWithChildren<{ providedQueryClient: QueryClient | null }>) {\n  const queryClient = useMemo(() => {\n    return providedQueryClient || new QueryClient();\n  }, [providedQueryClient]);\n\n  if (providedQueryClient) return children;\n\n  return (\n    <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;AAgBO,SAAS,2BAA2B;AAAA,EACzC;AAAA,EACA;AACF,GAA8E;AAE5E,QAAM,EAAE,qBAAqB,oBAAoB,IAC/C,wBAAwB;AAGxB,SAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC;AAAA,MACA;AAAA,MAEA,UAAA,oBAAC,gCAA+B,EAAA,qBAC7B,SACH,CAAA;AAAA,IAAA;AAAA,EACF;AAEJ;AAEA,SAAS,yBAAyB;AAAA,EAChC;AAAA,EACA;AAAA,EACA;AACF,GAGI;AACF,QAAM,mBAAmB,cAAc;AACjC,QAAA,oBACJ,OAA8C,UAAU;AAEpD,QAAA,iBAAiB,YAAY,MAAM;;AACvC,QAAI,oBAA4B,QAAA;AAEhC,UAAM,YAAU,4BAAiB,WAAjB,mBAAyB,eAAzB,mBAAqC,SAAQ;AAC7D,UAAM,eAAa,4BAAiB,WAAjB,mBAAyB,eAAzB,mBAAqC,SAAQ;AAEhE,WAAO,kBAAkB;AAAA,MACvB,QAAQ,iBAAiB,UAAU;AAAA,MACnC;AAAA,MACA;AAAA,MACA,YAAY,cAAc;AAAA,QACxB,YAAY;AAAA,UACV;AAAA,UACA;AAAA,QACD,CAAA;AAAA,MAAA;AAAA,IACH,CACD;AAAA,EAAA,GACA;AAAA,IACD,iBAAiB;AAAA,IACjB,iBAAiB;AAAA,IACjB;AAAA,IACA;AAAA,EAAA,CACD;AAED,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAS,MAAM;AACzC,WAAO,eAAe;AAAA,EAAA,CACvB;AAED,YAAU,MAAM;AACV,QAAA,kBAAkB,YAAY,YAAY;AAC5C,gBAAU,gBAAgB;AAC1B,wBAAkB,UAAU;AAAA,IAAA;AAAA,EAC9B,GACC,CAAC,YAAY,cAAc,CAAC;AAE/B,MAAI,qBAAqB;AAChB,WAAA;AAAA,EAAA;AAGF,SAAA,oBAAC,eAAc,EAAA,QAAiB,SAAS,CAAA;AAClD;AAEA,SAAS,+BAA+B;AAAA,EACtC;AAAA,EACA;AACF,GAAmE;AAC3D,QAAA,cAAc,QAAQ,MAAM;AACzB,WAAA,uBAAuB,IAAI,YAAY;AAAA,EAAA,GAC7C,CAAC,mBAAmB,CAAC;AAExB,MAAI,oBAA4B,QAAA;AAEhC,SACG,oBAAA,qBAAA,EAAoB,QAAQ,aAAc,SAAS,CAAA;AAExD;"}