{"version":3,"file":"analyticsService.js","sources":["../../../../src/core/analytics/utils/analyticsService.ts"],"sourcesContent":["import { getOnchainKitConfig } from '@/core/OnchainKitConfig';\nimport { ANALYTICS_API_URL } from '@/core/analytics/constants';\nimport type {\n  AnalyticsEvent,\n  AnalyticsEventData,\n} from '@/core/analytics/types';\nimport { clientMetaManager } from '@/core/clientMeta/clientMetaManager';\n\nimport { JSON_HEADERS } from '@/core/network/constants';\n\nfunction buildBody<T extends AnalyticsEvent>(\n  event: T,\n  data: AnalyticsEventData[T],\n) {\n  return {\n    apiKey: getOnchainKitConfig('apiKey') ?? 'undefined',\n    sessionId: getOnchainKitConfig('sessionId') ?? 'undefined',\n    timestamp: Date.now(),\n    eventType: event,\n    data,\n    origin: window.location.origin,\n  };\n}\n\nasync function handleSendAnalytics<T extends AnalyticsEvent>(\n  event: T,\n  data: AnalyticsEventData[T],\n) {\n  const config = getOnchainKitConfig('config');\n\n  // Don't send analytics if disabled\n  if (!config?.analytics) {\n    return;\n  }\n\n  try {\n    const clientMeta = await clientMetaManager.getClientMeta();\n    await fetch(config?.analyticsUrl ?? ANALYTICS_API_URL, {\n      method: 'POST',\n      headers: {\n        ...JSON_HEADERS,\n        'OnchainKit-App-Name': document.title,\n        'OnchainKit-Client-Fid': clientMeta.clientFid?.toString() ?? '',\n        'OnchainKit-Mode': clientMeta.mode,\n      },\n      body: JSON.stringify(buildBody(event, data)),\n    });\n  } catch (error) {\n    // Silently fail\n    if (process.env.NODE_ENV !== 'production') {\n      console.error('Error sending analytics:', error);\n    }\n  }\n}\n\nexport const sendAnalyticsPayload = <T extends AnalyticsEvent>(\n  event: T,\n  data: AnalyticsEventData[T],\n) => handleSendAnalytics(event, data);\n"],"names":[],"mappings":";;;;AAUA,SAAS,UACP,OACA,MACA;AACO,SAAA;AAAA,IACL,QAAQ,oBAAoB,QAAQ,KAAK;AAAA,IACzC,WAAW,oBAAoB,WAAW,KAAK;AAAA,IAC/C,WAAW,KAAK,IAAI;AAAA,IACpB,WAAW;AAAA,IACX;AAAA,IACA,QAAQ,OAAO,SAAS;AAAA,EAC1B;AACF;AAEA,eAAe,oBACb,OACA,MACA;;AACM,QAAA,SAAS,oBAAoB,QAAQ;AAGvC,MAAA,EAAC,iCAAQ,YAAW;AACtB;AAAA,EAAA;AAGE,MAAA;AACI,UAAA,aAAa,MAAM,kBAAkB,cAAc;AACnD,UAAA,OAAM,iCAAQ,iBAAgB,mBAAmB;AAAA,MACrD,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,GAAG;AAAA,QACH,uBAAuB,SAAS;AAAA,QAChC,2BAAyB,gBAAW,cAAX,mBAAsB,eAAc;AAAA,QAC7D,mBAAmB,WAAW;AAAA,MAChC;AAAA,MACA,MAAM,KAAK,UAAU,UAAU,OAAO,IAAI,CAAC;AAAA,IAAA,CAC5C;AAAA,WACM,OAAO;AAEV,QAAA,QAAQ,IAAI,aAAa,cAAc;AACjC,cAAA,MAAM,4BAA4B,KAAK;AAAA,IAAA;AAAA,EACjD;AAEJ;AAEO,MAAM,uBAAuB,CAClC,OACA,SACG,oBAAoB,OAAO,IAAI;"}