{"version":3,"file":"NFTAudio.js","sources":["../../../../src/nft/components/view/NFTAudio.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport {\n  type MouseEvent,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { background, cn } from '../../../styles/theme';\n\ntype NFTAudioReact = {\n  className?: string;\n  onLoading?: (mediaUrl: string) => void;\n  onLoaded?: () => void;\n  onError?: (error: NFTError) => void;\n};\n\nexport function NFTAudio({\n  className,\n  onLoading,\n  onLoaded,\n  onError,\n}: NFTAudioReact) {\n  const { animationUrl } = useNFTContext();\n  const audioRef = useRef<HTMLAudioElement>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n\n  useEffect(() => {\n    function onEnded() {\n      setIsPlaying(false);\n    }\n\n    if (animationUrl && audioRef?.current) {\n      audioRef.current.onloadstart = () => {\n        onLoading?.(animationUrl);\n      };\n\n      audioRef.current.onloadeddata = () => {\n        onLoaded?.();\n      };\n\n      audioRef.current.addEventListener('ended', onEnded);\n\n      audioRef.current.onerror = (error: string | Event) => {\n        onError?.({\n          error: typeof error === 'string' ? error : error.type,\n          code: 'NmNAc01', // NFT module NFTAudio component 01 error\n          message: 'Error loading audio',\n        });\n      };\n    }\n  }, [animationUrl, onLoading, onLoaded, onError]);\n\n  const handlePlayPause = useCallback(\n    (event: MouseEvent) => {\n      event.stopPropagation();\n      if (isPlaying) {\n        audioRef.current?.pause();\n        setIsPlaying(false);\n      } else {\n        audioRef.current?.play();\n        setIsPlaying(true);\n      }\n    },\n    [isPlaying],\n  );\n\n  if (!animationUrl) {\n    return null;\n  }\n\n  return (\n    <div className={cn('max-h-350 w-350 max-w-350', className)}>\n      <button\n        type=\"button\"\n        className={cn(\n          background.reverse,\n          'ml-6 inline-flex h-[42px] w-[42px] cursor-pointer items-center justify-center rounded-full',\n        )}\n        onClick={handlePlayPause}\n      >\n        <div\n          className={cn(\n            'ml-px box-border h-[18px] transition-all ease-[100ms] will-change-[border-width]',\n            'border-[var(--ock-bg-default-reverse)] border-l-[var(--ock-bg-default)]',\n            {\n              'border-[length:0_0_0_16px] border-double': isPlaying,\n              '-mr-px border-[length:9px_0_9px_16px] border-solid': !isPlaying,\n            },\n          )}\n        />\n      </button>\n      <audio\n        ref={audioRef}\n        data-testid=\"ockNFTAudio\"\n        autoPlay={false}\n        controls={false}\n        src={animationUrl}\n      >\n        <track kind=\"captions\" />\n      </audio>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAkBO,SAAS,SAAS;AAAA,EACvB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,GAAkB;AACV,QAAA,EAAE,aAAa,IAAI,cAAc;AACjC,QAAA,WAAW,OAAyB,IAAI;AAC9C,QAAM,CAAC,WAAW,YAAY,IAAI,SAAS,KAAK;AAEhD,YAAU,MAAM;AACd,aAAS,UAAU;AACjB,mBAAa,KAAK;AAAA,IAAA;AAGhB,QAAA,iBAAgB,qCAAU,UAAS;AAC5B,eAAA,QAAQ,cAAc,MAAM;AACnC,+CAAY;AAAA,MACd;AAES,eAAA,QAAQ,eAAe,MAAM;AACzB;AAAA,MACb;AAES,eAAA,QAAQ,iBAAiB,SAAS,OAAO;AAEzC,eAAA,QAAQ,UAAU,CAAC,UAA0B;AAC1C,2CAAA;AAAA,UACR,OAAO,OAAO,UAAU,WAAW,QAAQ,MAAM;AAAA,UACjD,MAAM;AAAA;AAAA,UACN,SAAS;AAAA,QAAA;AAAA,MAEb;AAAA,IAAA;AAAA,KAED,CAAC,cAAc,WAAW,UAAU,OAAO,CAAC;AAE/C,QAAM,kBAAkB;AAAA,IACtB,CAAC,UAAsB;;AACrB,YAAM,gBAAgB;AACtB,UAAI,WAAW;AACb,uBAAS,YAAT,mBAAkB;AAClB,qBAAa,KAAK;AAAA,MAAA,OACb;AACL,uBAAS,YAAT,mBAAkB;AAClB,qBAAa,IAAI;AAAA,MAAA;AAAA,IAErB;AAAA,IACA,CAAC,SAAS;AAAA,EACZ;AAEA,MAAI,CAAC,cAAc;AACV,WAAA;AAAA,EAAA;AAGT,8BACG,OAAI,EAAA,WAAW,GAAG,6BAA6B,SAAS,GACvD,UAAA;AAAA,IAAA;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,MAAK;AAAA,QACL,WAAW;AAAA,UACT,WAAW;AAAA,UACX;AAAA,QACF;AAAA,QACA,SAAS;AAAA,QAET,UAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAW;AAAA,cACT;AAAA,cACA;AAAA,cACA;AAAA,gBACE,4CAA4C;AAAA,gBAC5C,sDAAsD,CAAC;AAAA,cAAA;AAAA,YACzD;AAAA,UACF;AAAA,QAAA;AAAA,MACF;AAAA,IACF;AAAA,IACA;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,KAAK;AAAA,QACL,eAAY;AAAA,QACZ,UAAU;AAAA,QACV,UAAU;AAAA,QACV,KAAK;AAAA,QAEL,UAAA,oBAAC,SAAM,EAAA,MAAK,WAAW,CAAA;AAAA,MAAA;AAAA,IAAA;AAAA,EACzB,GACF;AAEJ;"}