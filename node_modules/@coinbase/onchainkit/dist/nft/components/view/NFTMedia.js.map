{"version":3,"file":"NFTMedia.js","sources":["../../../../src/nft/components/view/NFTMedia.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTLifecycleContext } from '@/nft/components/NFTLifecycleProvider';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport { LifecycleType, MediaType } from '@/nft/types';\nimport { useCallback, useMemo } from 'react';\nimport { cn } from '../../../styles/theme';\nimport { NFTAudio } from './NFTAudio';\nimport { NFTImage } from './NFTImage';\nimport { NFTVideo } from './NFTVideo';\n\ntype NFTMediaReact = {\n  className?: string;\n  square?: boolean;\n};\n\nexport function NFTMedia({ className, square }: NFTMediaReact) {\n  const { mimeType } = useNFTContext();\n  const { type, updateLifecycleStatus } = useNFTLifecycleContext();\n\n  const mediaType = useMemo(() => {\n    if (mimeType?.startsWith('video')) {\n      return MediaType.Video;\n    }\n    if (mimeType?.startsWith('audio')) {\n      return MediaType.Audio;\n    }\n    if (mimeType?.startsWith('image')) {\n      return MediaType.Image;\n    }\n    return MediaType.Unknown;\n  }, [mimeType]);\n\n  const handleLoading = useCallback(\n    (mediaUrl: string) => {\n      updateLifecycleStatus({\n        statusName: 'mediaLoading',\n        statusData: {\n          mediaType,\n          mediaUrl,\n        },\n      });\n    },\n    [mediaType, updateLifecycleStatus],\n  );\n\n  const handleLoaded = useCallback(() => {\n    // for Views, this is the success state\n    updateLifecycleStatus({\n      statusName: type === LifecycleType.MINT ? 'mediaLoaded' : 'success',\n    });\n  }, [type, updateLifecycleStatus]);\n\n  const handleError = useCallback(\n    (error: NFTError) => {\n      updateLifecycleStatus({\n        statusName: 'error',\n        statusData: error,\n      });\n    },\n    [updateLifecycleStatus],\n  );\n\n  const media = useMemo(() => {\n    switch (mediaType) {\n      case MediaType.Video:\n        return (\n          <NFTVideo\n            square={square}\n            onLoading={handleLoading}\n            onLoaded={handleLoaded}\n            onError={handleError}\n          />\n        );\n      case MediaType.Audio:\n        return (\n          <div className=\"relative w-full\">\n            <NFTImage square={square} />\n            <div className=\"absolute bottom-4 mx-auto w-full\">\n              <NFTAudio />\n            </div>\n          </div>\n        );\n      default:\n        // fallback to image\n        return (\n          <NFTImage\n            square={square}\n            onLoading={handleLoading}\n            onLoaded={handleLoaded}\n            onError={handleError}\n          />\n        );\n    }\n  }, [handleError, handleLoaded, handleLoading, mediaType, square]);\n\n  return <div className={cn('pb-2', className)}>{media}</div>;\n}\n"],"names":[],"mappings":";;;;;;;;;AAeO,SAAS,SAAS,EAAE,WAAW,UAAyB;AACvD,QAAA,EAAE,SAAS,IAAI,cAAc;AACnC,QAAM,EAAE,MAAM,sBAAsB,IAAI,uBAAuB;AAEzD,QAAA,YAAY,QAAQ,MAAM;AAC1B,QAAA,qCAAU,WAAW,UAAU;AACjC,aAAO,UAAU;AAAA,IAAA;AAEf,QAAA,qCAAU,WAAW,UAAU;AACjC,aAAO,UAAU;AAAA,IAAA;AAEf,QAAA,qCAAU,WAAW,UAAU;AACjC,aAAO,UAAU;AAAA,IAAA;AAEnB,WAAO,UAAU;AAAA,EAAA,GAChB,CAAC,QAAQ,CAAC;AAEb,QAAM,gBAAgB;AAAA,IACpB,CAAC,aAAqB;AACE,4BAAA;AAAA,QACpB,YAAY;AAAA,QACZ,YAAY;AAAA,UACV;AAAA,UACA;AAAA,QAAA;AAAA,MACF,CACD;AAAA,IACH;AAAA,IACA,CAAC,WAAW,qBAAqB;AAAA,EACnC;AAEM,QAAA,eAAe,YAAY,MAAM;AAEf,0BAAA;AAAA,MACpB,YAAY,SAAS,cAAc,OAAO,gBAAgB;AAAA,IAAA,CAC3D;AAAA,EAAA,GACA,CAAC,MAAM,qBAAqB,CAAC;AAEhC,QAAM,cAAc;AAAA,IAClB,CAAC,UAAoB;AACG,4BAAA;AAAA,QACpB,YAAY;AAAA,QACZ,YAAY;AAAA,MAAA,CACb;AAAA,IACH;AAAA,IACA,CAAC,qBAAqB;AAAA,EACxB;AAEM,QAAA,QAAQ,QAAQ,MAAM;AAC1B,YAAQ,WAAW;AAAA,MACjB,KAAK,UAAU;AAEX,eAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC;AAAA,YACA,WAAW;AAAA,YACX,UAAU;AAAA,YACV,SAAS;AAAA,UAAA;AAAA,QACX;AAAA,MAEJ,KAAK,UAAU;AAEX,eAAA,qBAAC,OAAI,EAAA,WAAU,mBACb,UAAA;AAAA,UAAA,oBAAC,YAAS,QAAgB;AAAA,8BACzB,OAAI,EAAA,WAAU,oCACb,UAAA,oBAAC,YAAS,EACZ,CAAA;AAAA,QAAA,GACF;AAAA,MAEJ;AAGI,eAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC;AAAA,YACA,WAAW;AAAA,YACX,UAAU;AAAA,YACV,SAAS;AAAA,UAAA;AAAA,QACX;AAAA,IAAA;AAAA,EAEN,GACC,CAAC,aAAa,cAAc,eAAe,WAAW,MAAM,CAAC;AAEhE,6BAAQ,OAAI,EAAA,WAAW,GAAG,QAAQ,SAAS,GAAI,UAAM,OAAA;AACvD;"}