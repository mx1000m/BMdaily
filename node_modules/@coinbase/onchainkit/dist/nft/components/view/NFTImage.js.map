{"version":3,"file":"NFTImage.js","sources":["../../../../src/nft/components/view/NFTImage.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport { type MouseEvent, useCallback, useEffect, useState } from 'react';\nimport { defaultNFTSvg } from '../../../internal/svg/defaultNFTSvg';\nimport { cn } from '../../../styles/theme';\n\ntype NFTImageReact = {\n  className?: string;\n  square?: boolean;\n  onLoading?: (mediaUrl: string) => void;\n  onLoaded?: () => void;\n  onError?: (error: NFTError) => void;\n};\n\nexport function NFTImage({\n  className,\n  square = true,\n  onLoading,\n  onLoaded,\n  onError,\n}: NFTImageReact) {\n  const { imageUrl, description } = useNFTContext();\n  const [loaded, setLoaded] = useState(false);\n  const [error, setError] = useState(false);\n\n  const loadImage = useCallback(() => {\n    if (imageUrl) {\n      onLoading?.(imageUrl);\n\n      const img = new Image();\n      img.onload = () => {\n        setLoaded(true);\n        onLoaded?.();\n      };\n\n      img.onerror = (error: string | Event) => {\n        onError?.({\n          error: typeof error === 'string' ? error : error.type,\n          code: 'NmNIc01', // NFT module NFTImage component 01 error\n          message: 'Error loading image',\n        });\n        setError(true);\n      };\n      img.src = imageUrl;\n    }\n  }, [imageUrl, onLoading, onLoaded, onError]);\n\n  useEffect(() => {\n    loadImage();\n  }, [loadImage]);\n\n  const handleRetry = useCallback(\n    async (e: MouseEvent) => {\n      e.stopPropagation();\n      setError(false);\n      loadImage();\n    },\n    [loadImage],\n  );\n\n  return (\n    <div\n      className={cn(\n        'grid w-full',\n        '[&>*]:col-start-1 [&>*]:col-end-1 [&>*]:row-start-1 [&>*]:row-end-1',\n        { 'aspect-square': square },\n        className,\n      )}\n    >\n      <div className=\"flex items-center justify-center\">{defaultNFTSvg}</div>\n      <div\n        className={cn(\n          'grid h-full w-full content-center justify-center overflow-hidden',\n          { 'aspect-square': square },\n        )}\n      >\n        <img\n          data-testid=\"ockNFTImage\"\n          src={imageUrl}\n          alt={description}\n          decoding=\"async\"\n          className={cn(\n            'transition-opacity duration-500 ease-in-out',\n            loaded ? 'opacity-100' : 'opacity-0',\n            { 'h-full w-full object-cover': square },\n          )}\n        />\n      </div>\n      {error && (\n        <div className=\"flex items-center justify-center\">\n          <button type=\"button\" onClick={handleRetry} className=\"z-10 mt-[60%]\">\n            retry\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["error"],"mappings":";;;;;AAcO,SAAS,SAAS;AAAA,EACvB;AAAA,EACA,SAAS;AAAA,EACT;AAAA,EACA;AAAA,EACA;AACF,GAAkB;AAChB,QAAM,EAAE,UAAU,YAAY,IAAI,cAAc;AAChD,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAS,KAAK;AAC1C,QAAM,CAAC,OAAO,QAAQ,IAAI,SAAS,KAAK;AAElC,QAAA,YAAY,YAAY,MAAM;AAClC,QAAI,UAAU;AACZ,6CAAY;AAEN,YAAA,MAAM,IAAI,MAAM;AACtB,UAAI,SAAS,MAAM;AACjB,kBAAU,IAAI;AACH;AAAA,MACb;AAEI,UAAA,UAAU,CAACA,WAA0B;AAC7B,2CAAA;AAAA,UACR,OAAO,OAAOA,WAAU,WAAWA,SAAQA,OAAM;AAAA,UACjD,MAAM;AAAA;AAAA,UACN,SAAS;AAAA,QAAA;AAEX,iBAAS,IAAI;AAAA,MACf;AACA,UAAI,MAAM;AAAA,IAAA;AAAA,KAEX,CAAC,UAAU,WAAW,UAAU,OAAO,CAAC;AAE3C,YAAU,MAAM;AACJ,cAAA;AAAA,EAAA,GACT,CAAC,SAAS,CAAC;AAEd,QAAM,cAAc;AAAA,IAClB,OAAO,MAAkB;AACvB,QAAE,gBAAgB;AAClB,eAAS,KAAK;AACJ,gBAAA;AAAA,IACZ;AAAA,IACA,CAAC,SAAS;AAAA,EACZ;AAGE,SAAA;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW;AAAA,QACT;AAAA,QACA;AAAA,QACA,EAAE,iBAAiB,OAAO;AAAA,QAC1B;AAAA,MACF;AAAA,MAEA,UAAA;AAAA,QAAC,oBAAA,OAAA,EAAI,WAAU,oCAAoC,UAAc,eAAA;AAAA,QACjE;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAW;AAAA,cACT;AAAA,cACA,EAAE,iBAAiB,OAAO;AAAA,YAC5B;AAAA,YAEA,UAAA;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,eAAY;AAAA,gBACZ,KAAK;AAAA,gBACL,KAAK;AAAA,gBACL,UAAS;AAAA,gBACT,WAAW;AAAA,kBACT;AAAA,kBACA,SAAS,gBAAgB;AAAA,kBACzB,EAAE,8BAA8B,OAAO;AAAA,gBAAA;AAAA,cACzC;AAAA,YAAA;AAAA,UACF;AAAA,QACF;AAAA,QACC,SACC,oBAAC,OAAI,EAAA,WAAU,oCACb,UAAC,oBAAA,UAAA,EAAO,MAAK,UAAS,SAAS,aAAa,WAAU,iBAAgB,mBAEtE,EACF,CAAA;AAAA,MAAA;AAAA,IAAA;AAAA,EAEJ;AAEJ;"}