(function(H,Tt){typeof exports=="object"&&typeof module<"u"?Tt(exports):typeof define=="function"&&define.amd?define(["exports"],Tt):(H=typeof globalThis<"u"?globalThis:H||self,Tt(H["@walletconnect/core"]={}))})(this,function(H){"use strict";var Tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vf(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var lt={exports:{}},hr=typeof Reflect=="object"?Reflect:null,Ef=hr&&typeof hr.apply=="function"?hr.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Vi;hr&&typeof hr.ownKeys=="function"?Vi=hr.ownKeys:Object.getOwnPropertySymbols?Vi=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Vi=function(t){return Object.getOwnPropertyNames(t)};function Mb(e){console&&console.warn&&console.warn(e)}var _f=Number.isNaN||function(t){return t!==t};function ae(){ae.init.call(this)}lt.exports=ae,lt.exports.once=Kb,ae.EventEmitter=ae,ae.prototype._events=void 0,ae.prototype._eventsCount=0,ae.prototype._maxListeners=void 0;var xf=10;function Hi(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(ae,"defaultMaxListeners",{enumerable:!0,get:function(){return xf},set:function(e){if(typeof e!="number"||e<0||_f(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");xf=e}}),ae.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ae.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||_f(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Sf(e){return e._maxListeners===void 0?ae.defaultMaxListeners:e._maxListeners}ae.prototype.getMaxListeners=function(){return Sf(this)},ae.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[t];if(f===void 0)return!1;if(typeof f=="function")Ef(f,this,n);else for(var c=f.length,u=Df(f,c),r=0;r<c;++r)Ef(u[r],this,n);return!0};function Of(e,t,n,r){var i,s,o;if(Hi(n),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),o===void 0)o=s[t]=n,++e._eventsCount;else if(typeof o=="function"?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=Sf(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,Mb(a)}return e}ae.prototype.addListener=function(t,n){return Of(this,t,n,!1)},ae.prototype.on=ae.prototype.addListener,ae.prototype.prependListener=function(t,n){return Of(this,t,n,!0)};function qb(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function If(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=qb.bind(r);return i.listener=n,r.wrapFn=i,i}ae.prototype.once=function(t,n){return Hi(n),this.on(t,If(this,t,n)),this},ae.prototype.prependOnceListener=function(t,n){return Hi(n),this.prependListener(t,If(this,t,n)),this},ae.prototype.removeListener=function(t,n){var r,i,s,o,a;if(Hi(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():Vb(r,s),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this},ae.prototype.off=ae.prototype.removeListener,ae.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function Bf(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Hb(i):Df(i,i.length)}ae.prototype.listeners=function(t){return Bf(this,t,!0)},ae.prototype.rawListeners=function(t){return Bf(this,t,!1)},ae.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Af.call(e,t)},ae.prototype.listenerCount=Af;function Af(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ae.prototype.eventNames=function(){return this._eventsCount>0?Vi(this._events):[]};function Df(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Vb(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Hb(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Kb(e,t){return new Promise(function(n,r){function i(o){e.removeListener(t,s),r(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}Tf(e,t,s,{once:!0}),t!=="error"&&Gb(e,i,{once:!0})})}function Gb(e,t,n){typeof e.on=="function"&&Tf(e,"error",t,n)}function Tf(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var W={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var wo=function(e,t){return wo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},wo(e,t)};function Zb(e,t){wo(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var vo=function(){return vo=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vo.apply(this,arguments)};function Yb(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Wb(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function Xb(e,t){return function(n,r){t(n,r,e)}}function Jb(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Qb(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function f(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,f)}c((r=r.apply(e,t||[])).next())})}function ep(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return f([c,u])}}function f(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function tp(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}function np(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Eo(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rf(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function rp(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Rf(arguments[t]));return e}function ip(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function Xr(e){return this instanceof Xr?(this.v=e,this):new Xr(e)}function sp(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(l){return new Promise(function(b,y){s.push([h,l,b,y])>1||a(h,l)})})}function a(h,l){try{f(r[h](l))}catch(b){d(s[0][3],b)}}function f(h){h.value instanceof Xr?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,l){h(l),s.shift(),s.length&&a(s[0][0],s[0][1])}}function op(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(o){return(n=!n)?{value:Xr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function ap(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Eo=="function"?Eo(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,f){o=e[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(c){s({value:c,done:a})},o)}}function cp(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function fp(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function up(e){return e&&e.__esModule?e:{default:e}}function lp(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function hp(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}var dp=Object.freeze({__proto__:null,__extends:Zb,get __assign(){return vo},__rest:Yb,__decorate:Wb,__param:Xb,__metadata:Jb,__awaiter:Qb,__generator:ep,__createBinding:tp,__exportStar:np,__values:Eo,__read:Rf,__spread:rp,__spreadArrays:ip,__await:Xr,__asyncGenerator:sp,__asyncDelegator:op,__asyncValues:ap,__makeTemplateObject:cp,__importStar:fp,__importDefault:up,__classPrivateFieldGet:lp,__classPrivateFieldSet:hp}),Ki=vf(dp),_o={},Jr={},Nf;function gp(){if(Nf)return Jr;Nf=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.delay=void 0;function e(t){return new Promise(n=>{setTimeout(()=>{n(!0)},t)})}return Jr.delay=e,Jr}var Mn={},xo={},qn={},Cf;function bp(){return Cf||(Cf=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.ONE_THOUSAND=qn.ONE_HUNDRED=void 0,qn.ONE_HUNDRED=100,qn.ONE_THOUSAND=1e3),qn}var So={},$f;function pp(){return $f||($f=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(So)),So}var Pf;function Lf(){return Pf||(Pf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ki;t.__exportStar(bp(),e),t.__exportStar(pp(),e)}(xo)),xo}var Uf;function yp(){if(Uf)return Mn;Uf=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.fromMiliseconds=Mn.toMiliseconds=void 0;const e=Lf();function t(r){return r*e.ONE_THOUSAND}Mn.toMiliseconds=t;function n(r){return Math.floor(r/e.ONE_THOUSAND)}return Mn.fromMiliseconds=n,Mn}var Ff;function mp(){return Ff||(Ff=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ki;t.__exportStar(gp(),e),t.__exportStar(yp(),e)}(_o)),_o}var dr={},jf;function wp(){if(jf)return dr;jf=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const i=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:i})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return dr.Watch=e,dr.default=e,dr}var Oo={},Qr={},kf;function vp(){if(kf)return Qr;kf=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.IWatch=void 0;class e{}return Qr.IWatch=e,Qr}var zf;function Ep(){return zf||(zf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Ki.__exportStar(vp(),e)}(Oo)),Oo}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ki;t.__exportStar(mp(),e),t.__exportStar(wp(),e),t.__exportStar(Ep(),e),t.__exportStar(Lf(),e)})(W);class Vn{}class _p extends Vn{constructor(t){super()}}const Mf=W.FIVE_SECONDS,Hn={pulse:"heartbeat_pulse"};class Io extends _p{constructor(t){super(t),this.events=new lt.exports.EventEmitter,this.interval=Mf,this.interval=t?.interval||Mf}static async init(t){const n=new Io(t);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),W.toMiliseconds(this.interval))}pulse(){this.events.emit(Hn.pulse)}}const xp=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Sp=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Op=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ip(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Bp(e);return}return t}function Bp(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function Gi(e,t={}){if(typeof e!="string")return e;if(e[0]==='"'&&e[e.length-1]==='"'&&e.indexOf("\\")===-1)return e.slice(1,-1);const n=e.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!Op.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(xp.test(e)||Sp.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,Ip)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function Ap(e){return!e||typeof e.then!="function"?Promise.resolve(e):e}function Ee(e,...t){try{return Ap(e(...t))}catch(n){return Promise.reject(n)}}function Dp(e){const t=typeof e;return e===null||t!=="object"&&t!=="function"}function Tp(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}function Zi(e){if(Dp(e))return String(e);if(Tp(e)||Array.isArray(e))return JSON.stringify(e);if(typeof e.toJSON=="function")return Zi(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Bo="base64:";function Rp(e){return typeof e=="string"?e:Bo+$p(e)}function Np(e){return typeof e!="string"||!e.startsWith(Bo)?e:Cp(e.slice(Bo.length))}function Cp(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),t=>t.codePointAt(0))}function $p(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e))}function Ke(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function Pp(...e){return Ke(e.join(":"))}function Yi(e){return e=Ke(e),e?e+":":""}function Lp(e,t){if(t===void 0)return!0;let n=0,r=e.indexOf(":");for(;r>-1;)n++,r=e.indexOf(":",r+1);return n<=t}function Up(e,t){return t?e.startsWith(t)&&e[e.length-1]!=="$":e[e.length-1]!=="$"}function K9(e){return e}const Fp="memory",jp=()=>{const e=new Map;return{name:Fp,getInstance:()=>e,hasItem(t){return e.has(t)},getItem(t){return e.get(t)??null},getItemRaw(t){return e.get(t)??null},setItem(t,n){e.set(t,n)},setItemRaw(t,n){e.set(t,n)},removeItem(t){e.delete(t)},getKeys(){return[...e.keys()]},clear(){e.clear()},dispose(){e.clear()}}};function kp(e={}){const t={mounts:{"":e.driver||jp()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=c=>{for(const u of t.mountpoints)if(c.startsWith(u))return{base:u,relativeKey:c.slice(u.length),driver:t.mounts[u]};return{base:"",relativeKey:c,driver:t.mounts[""]}},r=(c,u)=>t.mountpoints.filter(d=>d.startsWith(c)||u&&c.startsWith(d)).map(d=>({relativeBase:c.length>d.length?c.slice(d.length):void 0,mountpoint:d,driver:t.mounts[d]})),i=(c,u)=>{if(t.watching){u=Ke(u);for(const d of t.watchListeners)d(c,u)}},s=async()=>{if(!t.watching){t.watching=!0;for(const c in t.mounts)t.unwatch[c]=await qf(t.mounts[c],i,c)}},o=async()=>{if(t.watching){for(const c in t.unwatch)await t.unwatch[c]();t.unwatch={},t.watching=!1}},a=(c,u,d)=>{const h=new Map,l=b=>{let y=h.get(b.base);return y||(y={driver:b.driver,base:b.base,items:[]},h.set(b.base,y)),y};for(const b of c){const y=typeof b=="string",E=Ke(y?b:b.key),A=y?void 0:b.value,C=y||!b.options?u:{...u,...b.options},x=n(E);l(x).items.push({key:E,value:A,relativeKey:x.relativeKey,options:C})}return Promise.all([...h.values()].map(b=>d(b))).then(b=>b.flat())},f={hasItem(c,u={}){c=Ke(c);const{relativeKey:d,driver:h}=n(c);return Ee(h.hasItem,d,u)},getItem(c,u={}){c=Ke(c);const{relativeKey:d,driver:h}=n(c);return Ee(h.getItem,d,u).then(l=>Gi(l))},getItems(c,u={}){return a(c,u,d=>d.driver.getItems?Ee(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(l=>({key:Pp(d.base,l.key),value:Gi(l.value)}))):Promise.all(d.items.map(h=>Ee(d.driver.getItem,h.relativeKey,h.options).then(l=>({key:h.key,value:Gi(l)})))))},getItemRaw(c,u={}){c=Ke(c);const{relativeKey:d,driver:h}=n(c);return h.getItemRaw?Ee(h.getItemRaw,d,u):Ee(h.getItem,d,u).then(l=>Np(l))},async setItem(c,u,d={}){if(u===void 0)return f.removeItem(c);c=Ke(c);const{relativeKey:h,driver:l}=n(c);l.setItem&&(await Ee(l.setItem,h,Zi(u),d),l.watch||i("update",c))},async setItems(c,u){await a(c,u,async d=>{if(d.driver.setItems)return Ee(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:Zi(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>Ee(d.driver.setItem,h.relativeKey,Zi(h.value),h.options)))})},async setItemRaw(c,u,d={}){if(u===void 0)return f.removeItem(c,d);c=Ke(c);const{relativeKey:h,driver:l}=n(c);if(l.setItemRaw)await Ee(l.setItemRaw,h,u,d);else if(l.setItem)await Ee(l.setItem,h,Rp(u),d);else return;l.watch||i("update",c)},async removeItem(c,u={}){typeof u=="boolean"&&(u={removeMeta:u}),c=Ke(c);const{relativeKey:d,driver:h}=n(c);h.removeItem&&(await Ee(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Ee(h.removeItem,d+"$",u),h.watch||i("remove",c))},async getMeta(c,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),c=Ke(c);const{relativeKey:d,driver:h}=n(c),l=Object.create(null);if(h.getMeta&&Object.assign(l,await Ee(h.getMeta,d,u)),!u.nativeOnly){const b=await Ee(h.getItem,d+"$",u).then(y=>Gi(y));b&&typeof b=="object"&&(typeof b.atime=="string"&&(b.atime=new Date(b.atime)),typeof b.mtime=="string"&&(b.mtime=new Date(b.mtime)),Object.assign(l,b))}return l},setMeta(c,u,d={}){return this.setItem(c+"$",u,d)},removeMeta(c,u={}){return this.removeItem(c+"$",u)},async getKeys(c,u={}){c=Yi(c);const d=r(c,!0);let h=[];const l=[];let b=!0;for(const E of d){E.driver.flags?.maxDepth||(b=!1);const A=await Ee(E.driver.getKeys,E.relativeBase,u);for(const C of A){const x=E.mountpoint+Ke(C);h.some(_=>x.startsWith(_))||l.push(x)}h=[E.mountpoint,...h.filter(C=>!C.startsWith(E.mountpoint))]}const y=u.maxDepth!==void 0&&!b;return l.filter(E=>(!y||Lp(E,u.maxDepth))&&Up(E,c))},async clear(c,u={}){c=Yi(c),await Promise.all(r(c,!1).map(async d=>{if(d.driver.clear)return Ee(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(l=>d.driver.removeItem(l,u)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(c=>Vf(c)))},async watch(c){return await s(),t.watchListeners.push(c),async()=>{t.watchListeners=t.watchListeners.filter(u=>u!==c),t.watchListeners.length===0&&await o()}},async unwatch(){t.watchListeners=[],await o()},mount(c,u){if(c=Yi(c),c&&t.mounts[c])throw new Error(`already mounted at ${c}`);return c&&(t.mountpoints.push(c),t.mountpoints.sort((d,h)=>h.length-d.length)),t.mounts[c]=u,t.watching&&Promise.resolve(qf(u,i,c)).then(d=>{t.unwatch[c]=d}).catch(console.error),f},async unmount(c,u=!0){c=Yi(c),!(!c||!t.mounts[c])&&(t.watching&&c in t.unwatch&&(t.unwatch[c]?.(),delete t.unwatch[c]),u&&await Vf(t.mounts[c]),t.mountpoints=t.mountpoints.filter(d=>d!==c),delete t.mounts[c])},getMount(c=""){c=Ke(c)+":";const u=n(c);return{driver:u.driver,base:u.base}},getMounts(c="",u={}){return c=Ke(c),r(c,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(c,u={})=>f.getKeys(c,u),get:(c,u={})=>f.getItem(c,u),set:(c,u,d={})=>f.setItem(c,u,d),has:(c,u={})=>f.hasItem(c,u),del:(c,u={})=>f.removeItem(c,u),remove:(c,u={})=>f.removeItem(c,u)};return f}function qf(e,t,n){return e.watch?e.watch((r,i)=>t(r,n+i)):()=>{}}async function Vf(e){typeof e.dispose=="function"&&await Ee(e.dispose)}function Kn(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function Hf(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=Kn(n);return(i,s)=>r.then(o=>s(o.transaction(t,i).objectStore(t)))}let Ao;function ei(){return Ao||(Ao=Hf("keyval-store","keyval")),Ao}function Kf(e,t=ei()){return t("readonly",n=>Kn(n.get(e)))}function zp(e,t,n=ei()){return n("readwrite",r=>(r.put(t,e),Kn(r.transaction)))}function Mp(e,t=ei()){return t("readwrite",n=>(n.delete(e),Kn(n.transaction)))}function qp(e=ei()){return e("readwrite",t=>(t.clear(),Kn(t.transaction)))}function Vp(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Kn(e.transaction)}function Hp(e=ei()){return e("readonly",t=>{if(t.getAllKeys)return Kn(t.getAllKeys());const n=[];return Vp(t,r=>n.push(r.key)).then(()=>n)})}const Kp=e=>JSON.stringify(e,(t,n)=>typeof n=="bigint"?n.toString()+"n":n),Gp=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=e.replace(t,'$1"$2n"$3');return JSON.parse(n,(r,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function gr(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return Gp(e)}catch{return e}}function kt(e){return typeof e=="string"?e:Kp(e)||""}const Zp="idb-keyval";var Yp=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",n=i=>t+i;let r;return e.dbName&&e.storeName&&(r=Hf(e.dbName,e.storeName)),{name:Zp,options:e,async hasItem(i){return!(typeof await Kf(n(i),r)>"u")},async getItem(i){return await Kf(n(i),r)??null},setItem(i,s){return zp(n(i),s,r)},removeItem(i){return Mp(n(i),r)},getKeys(){return Hp(r)},clear(){return qp(r)}}};const Wp="WALLET_CONNECT_V2_INDEXED_DB",Xp="keyvaluestorage";class Jp{constructor(){this.indexedDb=kp({driver:Yp({dbName:Wp,storeName:Xp})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const n=await this.indexedDb.getItem(t);if(n!==null)return n}async setItem(t,n){await this.indexedDb.setItem(t,kt(n))}async removeItem(t){await this.indexedDb.removeItem(t)}}var Do=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wi={exports:{}};(function(){let e;function t(){}e=t,e.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},e.prototype.setItem=function(n,r){this[n]=String(r)},e.prototype.removeItem=function(n){delete this[n]},e.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},e.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Do<"u"&&Do.localStorage?Wi.exports=Do.localStorage:typeof window<"u"&&window.localStorage?Wi.exports=window.localStorage:Wi.exports=new t})();function Qp(e){var t;return[e[0],gr((t=e[1])!=null?t:"")]}class e1{constructor(){this.localStorage=Wi.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Qp)}async getItem(t){const n=this.localStorage.getItem(t);if(n!==null)return gr(n)}async setItem(t,n){this.localStorage.setItem(t,kt(n))}async removeItem(t){this.localStorage.removeItem(t)}}const t1="wc_storage_version",Gf=1,n1=async(e,t,n)=>{const r=t1,i=await t.getItem(r);if(i&&i>=Gf){n(t);return}const s=await e.getKeys();if(!s.length){n(t);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const f=a.toLowerCase();if(f.includes("wc@")||f.includes("walletconnect")||f.includes("wc_")||f.includes("wallet_connect")){const c=await e.getItem(a);await t.setItem(a,c),o.push(a)}}await t.setItem(r,Gf),n(t),r1(e,o)},r1=async(e,t)=>{t.length&&t.forEach(async n=>{await e.removeItem(n)})};class i1{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const t=new e1;this.storage=t;try{const n=new Jp;n1(t,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,n){return await this.initialize(),this.storage.setItem(t,n)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),t())},20)})}}var Rt={exports:{}};function s1(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Zf=o1;function o1(e,t,n){var r=n&&n.stringify||s1,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var o=new Array(s);o[0]=r(e);for(var a=1;a<s;a++)o[a]=r(t[a]);return o.join(" ")}if(typeof e!="string")return e;var f=t.length;if(f===0)return e;for(var c="",u=1-i,d=-1,h=e&&e.length||0,l=0;l<h;){if(e.charCodeAt(l)===37&&l+1<h){switch(d=d>-1?d:0,e.charCodeAt(l+1)){case 100:case 102:if(u>=f||t[u]==null)break;d<l&&(c+=e.slice(d,l)),c+=Number(t[u]),d=l+2,l++;break;case 105:if(u>=f||t[u]==null)break;d<l&&(c+=e.slice(d,l)),c+=Math.floor(Number(t[u])),d=l+2,l++;break;case 79:case 111:case 106:if(u>=f||t[u]===void 0)break;d<l&&(c+=e.slice(d,l));var b=typeof t[u];if(b==="string"){c+="'"+t[u]+"'",d=l+2,l++;break}if(b==="function"){c+=t[u].name||"<anonymous>",d=l+2,l++;break}c+=r(t[u]),d=l+2,l++;break;case 115:if(u>=f)break;d<l&&(c+=e.slice(d,l)),c+=String(t[u]),d=l+2,l++;break;case 37:d<l&&(c+=e.slice(d,l)),c+="%",d=l+2,l++,u--;break}++u}++l}return d===-1?e:(d<h&&(c+=e.slice(d)),c)}const Yf=Zf;Rt.exports=zt;const ti=E1().console||{},a1={mapHttpRequest:Xi,mapHttpResponse:Xi,wrapRequestSerializer:$o,wrapResponseSerializer:$o,wrapErrorSerializer:$o,req:Xi,res:Xi,err:Xf,errWithCause:Xf};function dn(e,t){return e==="silent"?1/0:t.levels.values[e]}const To=Symbol("pino.logFuncs"),Ro=Symbol("pino.hierarchy"),c1={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Wf(e,t){const n={logger:t,parent:e[Ro]};t[Ro]=n}function f1(e,t,n){const r={};t.forEach(i=>{r[i]=n[i]?n[i]:ti[i]||ti[c1[i]||"log"]||br}),e[To]=r}function u1(e,t){return Array.isArray(e)?e.filter(function(r){return r!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function zt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const n=e.browser.write||ti;e.browser.write&&(e.browser.asObject=!0);const r=e.serializers||{},i=u1(e.browser.serialize,r);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=Object.keys(e.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof n=="function"&&a.forEach(function(y){n[y]=n}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");const f=e.level||"info",c=Object.create(n);c.log||(c.log=br),f1(c,a,n),Wf({},c),Object.defineProperty(c,"levelVal",{get:d}),Object.defineProperty(c,"level",{get:h,set:l});const u={transmit:t,serialize:i,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:a,timestamp:m1(e),messageKey:e.messageKey||"msg",onChild:e.onChild||br};c.levels=l1(e),c.level=f,c.isLevelEnabled=function(y){return this.levels.values[y]?this.levels.values[y]>=this.levels.values[this.level]:!1},c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=br,c.serializers=r,c._serialize=i,c._stdErrSerialize=s,c.child=function(...y){return b.call(this,u,...y)},t&&(c._logEvent=Co());function d(){return dn(this.level,this)}function h(){return this._level}function l(y){if(y!=="silent"&&!this.levels.values[y])throw Error("unknown level "+y);this._level=y,Gn(this,u,c,"error"),Gn(this,u,c,"fatal"),Gn(this,u,c,"warn"),Gn(this,u,c,"info"),Gn(this,u,c,"debug"),Gn(this,u,c,"trace"),o.forEach(E=>{Gn(this,u,c,E)})}function b(y,E,A){if(!E)throw new Error("missing bindings for child Pino");A=A||{},i&&E.serializers&&(A.serializers=E.serializers);const C=A.serializers;if(i&&C){var x=Object.assign({},r,C),_=e.browser.serialize===!0?Object.keys(x):i;delete E.serializers,No([E],_,x,this._stdErrSerialize)}function R(U){this._childLevel=(U._childLevel|0)+1,this.bindings=E,x&&(this.serializers=x,this._serialize=_),t&&(this._logEvent=Co([].concat(U._logEvent.bindings,E)))}R.prototype=this;const P=new R(this);return Wf(this,P),P.child=function(...U){return b.call(this,y,...U)},P.level=A.level||this.level,y.onChild(P),P}return c}function l1(e){const t=e.customLevels||{},n=Object.assign({},zt.levels.values,t),r=Object.assign({},zt.levels.labels,h1(t));return{values:n,labels:r}}function h1(e){const t={};return Object.keys(e).forEach(function(n){t[e[n]]=n}),t}zt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},zt.stdSerializers=a1,zt.stdTimeFunctions=Object.assign({},{nullTime:Jf,epochTime:Qf,unixTime:w1,isoTime:v1});function d1(e){const t=[];e.bindings&&t.push(e.bindings);let n=e[Ro];for(;n.parent;)n=n.parent,n.logger.bindings&&t.push(n.logger.bindings);return t.reverse()}function Gn(e,t,n,r){if(Object.defineProperty(e,r,{value:dn(e.level,n)>dn(r,n)?br:n[To][r],writable:!0,enumerable:!0,configurable:!0}),e[r]===br){if(!t.transmit)return;const s=t.transmit.level||e.level,o=dn(s,n);if(dn(r,n)<o)return}e[r]=b1(e,t,n,r);const i=d1(e);i.length!==0&&(e[r]=g1(i,e[r]))}function g1(e,t){return function(){return t.apply(this,[...e,...arguments])}}function b1(e,t,n,r){return function(i){return function(){const o=t.timestamp(),a=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ti?ti:this;for(var c=0;c<a.length;c++)a[c]=arguments[c];var u=!1;if(t.serialize&&(No(a,this._serialize,this.serializers,this._stdErrSerialize),u=!0),t.asObject||t.formatters?i.call(f,...p1(this,r,a,o,t)):i.apply(f,a),t.transmit){const d=t.transmit.level||e._level,h=dn(d,n),l=dn(r,n);if(l<h)return;y1(this,{ts:o,methodLevel:r,methodValue:l,transmitLevel:d,transmitValue:n.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:dn(e._level,n)},a,u)}}}(e[To][r])}function p1(e,t,n,r,i){const{level:s,log:o=d=>d}=i.formatters||{},a=n.slice();let f=a[0];const c={};let u=(e._childLevel|0)+1;if(u<1&&(u=1),r&&(c.time=r),s){const d=s(t,e.levels.values[t]);Object.assign(c,d)}else c.level=e.levels.values[t];if(i.asObjectBindingsOnly){if(f!==null&&typeof f=="object")for(;u--&&typeof a[0]=="object";)Object.assign(c,a.shift());return[o(c),...a]}else{if(f!==null&&typeof f=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(c,a.shift());f=a.length?Yf(a.shift(),a):void 0}else typeof f=="string"&&(f=Yf(a.shift(),a));return f!==void 0&&(c[i.messageKey]=f),[o(c)]}}function No(e,t,n,r){for(const i in e)if(r&&e[i]instanceof Error)e[i]=zt.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i])&&t)for(const s in e[i])t.indexOf(s)>-1&&s in n&&(e[i][s]=n[s](e[i][s]))}function y1(e,t,n,r=!1){const i=t.send,s=t.ts,o=t.methodLevel,a=t.methodValue,f=t.val,c=e._logEvent.bindings;r||No(n,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=n.filter(function(u){return c.indexOf(u)===-1}),e._logEvent.level.label=o,e._logEvent.level.value=a,i(o,e._logEvent,f),e._logEvent=Co(c)}function Co(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Xf(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const n in e)t[n]===void 0&&(t[n]=e[n]);return t}function m1(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Jf:Qf}function Xi(){return{}}function $o(e){return e}function br(){}function Jf(){return!1}function Qf(){return Date.now()}function w1(){return Math.round(Date.now()/1e3)}function v1(){return new Date(Date.now()).toISOString()}function E1(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}Rt.exports.default=zt,Rt.exports.pino=zt;const _1={level:"info"},Ji="custom_context",Po=1e3*1024;var x1=Object.defineProperty,S1=(e,t,n)=>t in e?x1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,gn=(e,t,n)=>S1(e,typeof t!="symbol"?t+"":t,n);class O1{constructor(t){gn(this,"nodeValue"),gn(this,"sizeInBytes"),gn(this,"next"),this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class eu{constructor(t){gn(this,"lengthInNodes"),gn(this,"sizeInBytes"),gn(this,"head"),gn(this,"tail"),gn(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const n=new O1(t);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let n=this.head;for(;n!==null;)t.push(n.value),n=n.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const n=t.value;return t=t.next,{done:!1,value:n}}}}}var I1=Object.defineProperty,B1=(e,t,n)=>t in e?I1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qi=(e,t,n)=>B1(e,typeof t!="symbol"?t+"":t,n);class tu{constructor(t,n=Po){Qi(this,"logs"),Qi(this,"level"),Qi(this,"levelValue"),Qi(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=t??"error",this.levelValue=Rt.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new eu(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,n){n===Rt.exports.levels.values.error?console.error(t):n===Rt.exports.levels.values.warn?console.warn(t):n===Rt.exports.levels.values.debug?console.debug(t):n===Rt.exports.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(kt({timestamp:new Date().toISOString(),log:t}));const n=typeof t=="string"?JSON.parse(t).level:t.level;n>=this.levelValue&&this.forwardToConsole(t,n)}getLogs(){return this.logs}clearLogs(){this.logs=new eu(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const n=this.getLogArray();return n.push(kt({extraMetadata:t})),new Blob(n,{type:"application/json"})}}var A1=Object.defineProperty,D1=(e,t,n)=>t in e?A1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T1=(e,t,n)=>D1(e,typeof t!="symbol"?t+"":t,n);class R1{constructor(t,n=Po){T1(this,"baseChunkLogger"),this.baseChunkLogger=new tu(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const n=URL.createObjectURL(this.logsToBlob(t)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}}var N1=Object.defineProperty,C1=(e,t,n)=>t in e?N1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$1=(e,t,n)=>C1(e,typeof t!="symbol"?t+"":t,n);class P1{constructor(t,n=Po){$1(this,"baseChunkLogger"),this.baseChunkLogger=new tu(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}}var L1=Object.defineProperty,U1=Object.defineProperties,F1=Object.getOwnPropertyDescriptors,nu=Object.getOwnPropertySymbols,j1=Object.prototype.hasOwnProperty,k1=Object.prototype.propertyIsEnumerable,ru=(e,t,n)=>t in e?L1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,es=(e,t)=>{for(var n in t||(t={}))j1.call(t,n)&&ru(e,n,t[n]);if(nu)for(var n of nu(t))k1.call(t,n)&&ru(e,n,t[n]);return e},ts=(e,t)=>U1(e,F1(t));function z1(e){return ts(es({},e),{level:e?.level||_1.level})}function M1(e,t,n=Ji){return e[n]=t,e}function rt(e,t=Ji){return e[t]||""}function q1(e,t,n=Ji){const r=rt(e,n);return r.trim()?`${r}/${t}`:t}function it(e,t,n=Ji){const r=q1(e,t,n),i=e.child({context:r});return M1(i,r,n)}function V1(e){var t,n;const r=new R1((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Rt.exports(ts(es({},e.opts),{level:"trace",browser:ts(es({},(n=e.opts)==null?void 0:n.browser),{write:i=>r.write(i)})})),chunkLoggerController:r}}function H1(e){var t;const n=new P1((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Rt.exports(ts(es({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}function K1(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?V1(e):H1(e)}var G1=Object.defineProperty,Z1=(e,t,n)=>t in e?G1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,iu=(e,t,n)=>Z1(e,typeof t!="symbol"?t+"":t,n);class Y1 extends Vn{constructor(t){super(),this.opts=t,iu(this,"protocol","wc"),iu(this,"version",2)}}var W1=Object.defineProperty,X1=(e,t,n)=>t in e?W1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,J1=(e,t,n)=>X1(e,typeof t!="symbol"?t+"":t,n);class Q1 extends Vn{constructor(t,n){super(),this.core=t,this.logger=n,J1(this,"records",new Map)}}class ey{constructor(t,n){this.logger=t,this.core=n}}class ty extends Vn{constructor(t,n){super(),this.relayer=t,this.logger=n}}class ny extends Vn{constructor(t){super()}}class ry{constructor(t,n,r,i){this.core=t,this.logger=n,this.name=r}}class iy extends Vn{constructor(t,n){super(),this.relayer=t,this.logger=n}}class sy extends Vn{constructor(t,n){super(),this.core=t,this.logger=n}}class oy{constructor(t,n,r){this.core=t,this.logger=n,this.store=r}}class ay{constructor(t,n){this.projectId=t,this.logger=n}}class cy{constructor(t,n,r){this.core=t,this.logger=n,this.telemetryEnabled=r}}const Lo="wc",Uo=2,ni="core",vt=`${Lo}@2:${ni}:`,su={name:ni,logger:"error"},ou={database:":memory:"},au="crypto",Fo="client_ed25519_seed",cu=W.ONE_DAY,fu="keychain",uu="0.3",lu="messages",hu="0.3",du=W.SIX_HOURS,gu="publisher",bu="irn",pu="error",jo="wss://relay.walletconnect.org",yu="relayer",pe={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},mu="_subscription",st={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},wu=.1,fy={database:":memory:"},ns="2.22.4",uy=1e4,Zn={link_mode:"link_mode",relay:"relay"},ri={inbound:"inbound",outbound:"outbound"},vu="0.3",Eu="WALLETCONNECT_CLIENT_ID",ko="WALLETCONNECT_LINK_MODE_APPS",Ge={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ly=W.THIRTY_DAYS,_u="subscription",xu="0.3",hy=W.FIVE_SECONDS*1e3,Su="pairing",Ou="0.3",dy=W.THIRTY_DAYS,pr={wc_pairingDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:W.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:W.ONE_DAY,prompt:!1,tag:0},res:{ttl:W.ONE_DAY,prompt:!1,tag:0}}},yr={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ht={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Iu="history",Bu="0.3",Au="expirer",dt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Du="0.3",gy=W.ONE_DAY,Tu="verify-api",by="https://verify.walletconnect.com",Ru="https://verify.walletconnect.org",ii=Ru,Nu=`${ii}/v3`,Cu=[by,Ru],$u="echo",Pu="https://echo.walletconnect.com",py="event-client",Nt={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Mt={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},yy={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},my={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},wy={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},vy={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},Lu=.1,Uu="event-client",Fu=86400,ju="https://pulse.walletconnect.org/batch";function Ey(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ku(e,...t){if(!Ey(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function zu(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function _y(e,t){ku(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const mr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zo=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function xy(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Mu(e){return typeof e=="string"&&(e=xy(e)),ku(e),e}class Sy{clone(){return this._cloneInto()}}function Oy(e){const t=r=>e().update(Mu(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function qu(e=32){if(mr&&typeof mr.getRandomValues=="function")return mr.getRandomValues(new Uint8Array(e));if(mr&&typeof mr.randomBytes=="function")return mr.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function Iy(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),f=r?4:0,c=r?0:4;e.setUint32(t+f,o,r),e.setUint32(t+c,a,r)}class By extends Sy{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=zo(this.buffer)}update(t){zu(this);const{view:n,buffer:r,blockLen:i}=this;t=Mu(t);const s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const f=zo(t);for(;i<=s-o;o+=i)this.process(f,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){zu(this),_y(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;Iy(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=zo(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<c;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%n&&t.buffer.set(r),t}}const rs=BigInt(2**32-1),Mo=BigInt(32);function Vu(e,t=!1){return t?{h:Number(e&rs),l:Number(e>>Mo&rs)}:{h:Number(e>>Mo&rs)|0,l:Number(e&rs)|0}}function Ay(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:o}=Vu(e[i],t);[n[i],r[i]]=[s,o]}return[n,r]}const Dy=(e,t)=>BigInt(e>>>0)<<Mo|BigInt(t>>>0),Ty=(e,t,n)=>e>>>n,Ry=(e,t,n)=>e<<32-n|t>>>n,Ny=(e,t,n)=>e>>>n|t<<32-n,Cy=(e,t,n)=>e<<32-n|t>>>n,$y=(e,t,n)=>e<<64-n|t>>>n-32,Py=(e,t,n)=>e>>>n-32|t<<64-n,Ly=(e,t)=>t,Uy=(e,t)=>e,Fy=(e,t,n)=>e<<n|t>>>32-n,jy=(e,t,n)=>t<<n|e>>>32-n,ky=(e,t,n)=>t<<n-32|e>>>64-n,zy=(e,t,n)=>e<<n-32|t>>>64-n;function My(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const qy=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Vy=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Hy=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Ky=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,Gy=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),Zy=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,Q={fromBig:Vu,split:Ay,toBig:Dy,shrSH:Ty,shrSL:Ry,rotrSH:Ny,rotrSL:Cy,rotrBH:$y,rotrBL:Py,rotr32H:Ly,rotr32L:Uy,rotlSH:Fy,rotlSL:jy,rotlBH:ky,rotlBL:zy,add:My,add3L:qy,add3H:Vy,add4L:Hy,add4H:Ky,add5H:Zy,add5L:Gy},[Yy,Wy]=Q.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),bn=new Uint32Array(80),pn=new Uint32Array(80);class Xy extends By{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:f,Eh:c,El:u,Fh:d,Fl:h,Gh:l,Gl:b,Hh:y,Hl:E}=this;return[t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E]}set(t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=l|0,this.Gl=b|0,this.Hh=y|0,this.Hl=E|0}process(t,n){for(let x=0;x<16;x++,n+=4)bn[x]=t.getUint32(n),pn[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){const _=bn[x-15]|0,R=pn[x-15]|0,P=Q.rotrSH(_,R,1)^Q.rotrSH(_,R,8)^Q.shrSH(_,R,7),U=Q.rotrSL(_,R,1)^Q.rotrSL(_,R,8)^Q.shrSL(_,R,7),F=bn[x-2]|0,D=pn[x-2]|0,q=Q.rotrSH(F,D,19)^Q.rotrBH(F,D,61)^Q.shrSH(F,D,6),z=Q.rotrSL(F,D,19)^Q.rotrBL(F,D,61)^Q.shrSL(F,D,6),v=Q.add4L(U,z,pn[x-7],pn[x-16]),p=Q.add4H(v,P,q,bn[x-7],bn[x-16]);bn[x]=p|0,pn[x]=v|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:f,Dh:c,Dl:u,Eh:d,El:h,Fh:l,Fl:b,Gh:y,Gl:E,Hh:A,Hl:C}=this;for(let x=0;x<80;x++){const _=Q.rotrSH(d,h,14)^Q.rotrSH(d,h,18)^Q.rotrBH(d,h,41),R=Q.rotrSL(d,h,14)^Q.rotrSL(d,h,18)^Q.rotrBL(d,h,41),P=d&l^~d&y,U=h&b^~h&E,F=Q.add5L(C,R,U,Wy[x],pn[x]),D=Q.add5H(F,A,_,P,Yy[x],bn[x]),q=F|0,z=Q.rotrSH(r,i,28)^Q.rotrBH(r,i,34)^Q.rotrBH(r,i,39),v=Q.rotrSL(r,i,28)^Q.rotrBL(r,i,34)^Q.rotrBL(r,i,39),p=r&s^r&a^s&a,w=i&o^i&f^o&f;A=y|0,C=E|0,y=l|0,E=b|0,l=d|0,b=h|0,{h:d,l:h}=Q.add(c|0,u|0,D|0,q|0),c=a|0,u=f|0,a=s|0,f=o|0,s=r|0,o=i|0;const g=Q.add3L(q,v,w);r=Q.add3H(g,D,z,p),i=g|0}({h:r,l:i}=Q.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Q.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:f}=Q.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=Q.add(this.Dh|0,this.Dl|0,c|0,u|0),{h:d,l:h}=Q.add(this.Eh|0,this.El|0,d|0,h|0),{h:l,l:b}=Q.add(this.Fh|0,this.Fl|0,l|0,b|0),{h:y,l:E}=Q.add(this.Gh|0,this.Gl|0,y|0,E|0),{h:A,l:C}=Q.add(this.Hh|0,this.Hl|0,A|0,C|0),this.set(r,i,s,o,a,f,c,u,d,h,l,b,y,E,A,C)}roundClean(){bn.fill(0),pn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Jy=Oy(()=>new Xy);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const qo=BigInt(0),Hu=BigInt(1),Qy=BigInt(2);function Vo(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ho(e){if(!Vo(e))throw new Error("Uint8Array expected")}function Ko(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}const em=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Go(e){Ho(e);let t="";for(let n=0;n<e.length;n++)t+=em[e[n]];return t}function Ku(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?qo:BigInt("0x"+e)}const qt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Gu(e){if(e>=qt._0&&e<=qt._9)return e-qt._0;if(e>=qt.A&&e<=qt.F)return e-(qt.A-10);if(e>=qt.a&&e<=qt.f)return e-(qt.a-10)}function Zu(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=Gu(e.charCodeAt(s)),a=Gu(e.charCodeAt(s+1));if(o===void 0||a===void 0){const f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[i]=o*16+a}return r}function tm(e){return Ku(Go(e))}function is(e){return Ho(e),Ku(Go(Uint8Array.from(e).reverse()))}function Yu(e,t){return Zu(e.toString(16).padStart(t*2,"0"))}function Zo(e,t){return Yu(e,t).reverse()}function Vt(e,t,n){let r;if(typeof t=="string")try{r=Zu(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(Vo(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function Wu(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];Ho(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}const Yo=e=>typeof e=="bigint"&&qo<=e;function nm(e,t,n){return Yo(e)&&Yo(t)&&Yo(n)&&t<=e&&e<n}function si(e,t,n,r){if(!nm(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function rm(e){let t;for(t=0;e>qo;e>>=Hu,t+=1);return t}const im=e=>(Qy<<BigInt(e-1))-Hu,sm={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Vo(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Wo(e,t,n={}){const r=(i,s,o)=>{const a=sm[s];if(typeof a!="function")throw new Error("invalid validator function");const f=e[i];if(!(o&&f===void 0)&&!a(f,e))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+f)};for(const[i,s]of Object.entries(t))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return e}function Xu(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}const _e=BigInt(0),ge=BigInt(1),Yn=BigInt(2),om=BigInt(3),Xo=BigInt(4),Ju=BigInt(5),Qu=BigInt(8);function me(e,t){const n=e%t;return n>=_e?n:t+n}function am(e,t,n){if(t<_e)throw new Error("invalid exponent, negatives unsupported");if(n<=_e)throw new Error("invalid modulus");if(n===ge)return _e;let r=ge;for(;t>_e;)t&ge&&(r=r*e%n),e=e*e%n,t>>=ge;return r}function Ct(e,t,n){let r=e;for(;t-- >_e;)r*=r,r%=n;return r}function el(e,t){if(e===_e)throw new Error("invert: expected non-zero number");if(t<=_e)throw new Error("invert: expected positive modulus, got "+t);let n=me(e,t),r=t,i=_e,s=ge;for(;n!==_e;){const o=r/n,a=r%n,f=i-s*o;r=n,n=a,i=s,s=f}if(r!==ge)throw new Error("invert: does not exist");return me(i,t)}function cm(e){const t=(e-ge)/Yn;let n,r,i;for(n=e-ge,r=0;n%Yn===_e;n/=Yn,r++);for(i=Yn;i<e&&am(i,t,e)!==e-ge;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(e+ge)/Xo;return function(a,f){const c=a.pow(f,o);if(!a.eql(a.sqr(c),f))throw new Error("Cannot find square root");return c}}const s=(n+ge)/Yn;return function(o,a){if(o.pow(a,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let f=r,c=o.pow(o.mul(o.ONE,i),n),u=o.pow(a,s),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let b=o.sqr(d);h<f&&!o.eql(b,o.ONE);h++)b=o.sqr(b);const l=o.pow(c,ge<<BigInt(f-h-1));c=o.sqr(l),u=o.mul(u,l),d=o.mul(d,c),f=h}return u}}function fm(e){if(e%Xo===om){const t=(e+ge)/Xo;return function(n,r){const i=n.pow(r,t);if(!n.eql(n.sqr(i),r))throw new Error("Cannot find square root");return i}}if(e%Qu===Ju){const t=(e-Ju)/Qu;return function(n,r){const i=n.mul(r,Yn),s=n.pow(i,t),o=n.mul(r,s),a=n.mul(n.mul(o,Yn),s),f=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(f),r))throw new Error("Cannot find square root");return f}}return cm(e)}const um=(e,t)=>(me(e,t)&ge)===ge,lm=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hm(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=lm.reduce((r,i)=>(r[i]="function",r),t);return Wo(e,n)}function dm(e,t,n){if(n<_e)throw new Error("invalid exponent, negatives unsupported");if(n===_e)return e.ONE;if(n===ge)return t;let r=e.ONE,i=t;for(;n>_e;)n&ge&&(r=e.mul(r,i)),i=e.sqr(i),n>>=ge;return r}function gm(e,t){const n=new Array(t.length),r=t.reduce((s,o,a)=>e.is0(o)?s:(n[a]=s,e.mul(s,o)),e.ONE),i=e.inv(r);return t.reduceRight((s,o,a)=>e.is0(o)?s:(n[a]=e.mul(s,n[a]),e.mul(s,o)),i),n}function tl(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function nl(e,t,n=!1,r={}){if(e<=_e)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=tl(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:s,MASK:im(i),ZERO:_e,ONE:ge,create:f=>me(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return _e<=f&&f<e},is0:f=>f===_e,isOdd:f=>(f&ge)===ge,neg:f=>me(-f,e),eql:(f,c)=>f===c,sqr:f=>me(f*f,e),add:(f,c)=>me(f+c,e),sub:(f,c)=>me(f-c,e),mul:(f,c)=>me(f*c,e),pow:(f,c)=>dm(a,f,c),div:(f,c)=>me(f*el(c,e),e),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>el(f,e),sqrt:r.sqrt||(f=>(o||(o=fm(e)),o(a,f))),invertBatch:f=>gm(a,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>n?Zo(f,s):Yu(f,s),fromBytes:f=>{if(f.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+f.length);return n?is(f):tm(f)}});return Object.freeze(a)}const rl=BigInt(0),ss=BigInt(1);function Jo(e,t){const n=t.negate();return e?n:t}function il(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Qo(e,t){il(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1);return{windows:n,windowSize:r}}function bm(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function pm(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const ea=new WeakMap,sl=new WeakMap;function ta(e){return sl.get(e)||1}function ym(e,t){return{constTimeNegate:Jo,hasPrecomputes(n){return ta(n)!==1},unsafeLadder(n,r,i=e.ZERO){let s=n;for(;r>rl;)r&ss&&(i=i.add(s)),s=s.double(),r>>=ss;return i},precomputeWindow(n,r){const{windows:i,windowSize:s}=Qo(r,t),o=[];let a=n,f=a;for(let c=0;c<i;c++){f=a,o.push(f);for(let u=1;u<s;u++)f=f.add(a),o.push(f);a=f.double()}return o},wNAF(n,r,i){const{windows:s,windowSize:o}=Qo(n,t);let a=e.ZERO,f=e.BASE;const c=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<s;h++){const l=h*o;let b=Number(i&c);i>>=d,b>o&&(b-=u,i+=ss);const y=l,E=l+Math.abs(b)-1,A=h%2!==0,C=b<0;b===0?f=f.add(Jo(A,r[y])):a=a.add(Jo(C,r[E]))}return{p:a,f}},wNAFUnsafe(n,r,i,s=e.ZERO){const{windows:o,windowSize:a}=Qo(n,t),f=BigInt(2**n-1),c=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(i===rl)break;let l=Number(i&f);if(i>>=u,l>a&&(l-=c,i+=ss),l===0)continue;let b=r[h+Math.abs(l)-1];l<0&&(b=b.negate()),s=s.add(b)}return s},getPrecomputes(n,r,i){let s=ea.get(r);return s||(s=this.precomputeWindow(r,n),n!==1&&ea.set(r,i(s))),s},wNAFCached(n,r,i){const s=ta(n);return this.wNAF(s,this.getPrecomputes(s,n,i),r)},wNAFCachedUnsafe(n,r,i,s){const o=ta(n);return o===1?this.unsafeLadder(n,r,s):this.wNAFUnsafe(o,this.getPrecomputes(o,n,i),r,s)},setWindowSize(n,r){il(r,t),sl.set(n,r),ea.delete(n)}}}function mm(e,t,n,r){if(bm(n,e),pm(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,s=rm(BigInt(n.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,f=new Array(a+1).fill(i),c=Math.floor((t.BITS-1)/o)*o;let u=i;for(let d=c;d>=0;d-=o){f.fill(i);for(let l=0;l<r.length;l++){const b=r[l],y=Number(b>>BigInt(d)&BigInt(a));f[y]=f[y].add(n[l])}let h=i;for(let l=f.length-1,b=i;l>0;l--)b=b.add(f[l]),h=h.add(b);if(u=u.add(h),d!==0)for(let l=0;l<o;l++)u=u.double()}return u}function wm(e){return hm(e.Fp),Wo(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...tl(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Et=BigInt(0),Ze=BigInt(1),os=BigInt(2),vm=BigInt(8),Em={zip215:!0};function _m(e){const t=wm(e);return Wo(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function xm(e){const t=_m(e),{Fp:n,n:r,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:f}=t,c=os<<BigInt(a*8)-Ze,u=n.create,d=nl(t.n,t.nBitLength),h=t.uvRatio||((g,m)=>{try{return{isValid:!0,value:n.sqrt(g*n.inv(m))}}catch{return{isValid:!1,value:Et}}}),l=t.adjustScalarBytes||(g=>g),b=t.domain||((g,m,S)=>{if(Ko("phflag",S),m.length||S)throw new Error("Contexts/pre-hash are not supported");return g});function y(g,m){si("coordinate "+g,m,Et,c)}function E(g){if(!(g instanceof x))throw new Error("ExtendedPoint expected")}const A=Xu((g,m)=>{const{ex:S,ey:O,ez:I}=g,B=g.is0();m==null&&(m=B?vm:n.inv(I));const T=u(S*m),L=u(O*m),$=u(I*m);if(B)return{x:Et,y:Ze};if($!==Ze)throw new Error("invZ was invalid");return{x:T,y:L}}),C=Xu(g=>{const{a:m,d:S}=t;if(g.is0())throw new Error("bad point: ZERO");const{ex:O,ey:I,ez:B,et:T}=g,L=u(O*O),$=u(I*I),j=u(B*B),N=u(j*j),k=u(L*m),M=u(j*u(k+$)),G=u(N+u(S*u(L*$)));if(M!==G)throw new Error("bad point: equation left != right (1)");const V=u(O*I),K=u(B*T);if(V!==K)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(m,S,O,I){this.ex=m,this.ey=S,this.ez=O,this.et=I,y("x",m),y("y",S),y("z",O),y("t",I),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(m){if(m instanceof x)throw new Error("extended point not allowed");const{x:S,y:O}=m||{};return y("x",S),y("y",O),new x(S,O,Ze,u(S*O))}static normalizeZ(m){const S=n.invertBatch(m.map(O=>O.ez));return m.map((O,I)=>O.toAffine(S[I])).map(x.fromAffine)}static msm(m,S){return mm(x,d,m,S)}_setWindowSize(m){P.setWindowSize(this,m)}assertValidity(){C(this)}equals(m){E(m);const{ex:S,ey:O,ez:I}=this,{ex:B,ey:T,ez:L}=m,$=u(S*L),j=u(B*I),N=u(O*L),k=u(T*I);return $===j&&N===k}is0(){return this.equals(x.ZERO)}negate(){return new x(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:m}=t,{ex:S,ey:O,ez:I}=this,B=u(S*S),T=u(O*O),L=u(os*u(I*I)),$=u(m*B),j=S+O,N=u(u(j*j)-B-T),k=$+T,M=k-L,G=$-T,V=u(N*M),K=u(k*G),J=u(N*G),ee=u(M*k);return new x(V,K,ee,J)}add(m){E(m);const{a:S,d:O}=t,{ex:I,ey:B,ez:T,et:L}=this,{ex:$,ey:j,ez:N,et:k}=m;if(S===BigInt(-1)){const Pb=u((B-I)*(j+$)),Lb=u((B+I)*(j-$)),wf=u(Lb-Pb);if(wf===Et)return this.double();const Ub=u(T*os*k),Fb=u(L*os*N),jb=Fb+Ub,kb=Lb+Pb,zb=Fb-Ub,M9=u(jb*wf),q9=u(kb*zb),V9=u(jb*zb),H9=u(wf*kb);return new x(M9,q9,H9,V9)}const M=u(I*$),G=u(B*j),V=u(L*O*k),K=u(T*N),J=u((I+B)*($+j)-M-G),ee=K-V,re=K+V,he=u(G-S*M),de=u(J*ee),hn=u(re*he),mo=u(J*he),z9=u(ee*re);return new x(de,hn,z9,mo)}subtract(m){return this.add(m.negate())}wNAF(m){return P.wNAFCached(this,m,x.normalizeZ)}multiply(m){const S=m;si("scalar",S,Ze,r);const{p:O,f:I}=this.wNAF(S);return x.normalizeZ([O,I])[0]}multiplyUnsafe(m,S=x.ZERO){const O=m;return si("scalar",O,Et,r),O===Et?R:this.is0()||O===Ze?this:P.wNAFCachedUnsafe(this,O,x.normalizeZ,S)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return P.unsafeLadder(this,r).is0()}toAffine(m){return A(this,m)}clearCofactor(){const{h:m}=t;return m===Ze?this:this.multiplyUnsafe(m)}static fromHex(m,S=!1){const{d:O,a:I}=t,B=n.BYTES;m=Vt("pointHex",m,B),Ko("zip215",S);const T=m.slice(),L=m[B-1];T[B-1]=L&-129;const $=is(T),j=S?c:n.ORDER;si("pointHex.y",$,Et,j);const N=u($*$),k=u(N-Ze),M=u(O*N-I);let{isValid:G,value:V}=h(k,M);if(!G)throw new Error("Point.fromHex: invalid y coordinate");const K=(V&Ze)===Ze,J=(L&128)!==0;if(!S&&V===Et&&J)throw new Error("Point.fromHex: x=0 and x_0=1");return J!==K&&(V=u(-V)),x.fromAffine({x:V,y:$})}static fromPrivateKey(m){return D(m).point}toRawBytes(){const{x:m,y:S}=this.toAffine(),O=Zo(S,n.BYTES);return O[O.length-1]|=m&Ze?128:0,O}toHex(){return Go(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,Ze,u(t.Gx*t.Gy)),x.ZERO=new x(Et,Ze,Ze,Et);const{BASE:_,ZERO:R}=x,P=ym(x,a*8);function U(g){return me(g,r)}function F(g){return U(is(g))}function D(g){const m=n.BYTES;g=Vt("private key",g,m);const S=Vt("hashed private key",s(g),2*m),O=l(S.slice(0,m)),I=S.slice(m,2*m),B=F(O),T=_.multiply(B),L=T.toRawBytes();return{head:O,prefix:I,scalar:B,point:T,pointBytes:L}}function q(g){return D(g).pointBytes}function z(g=new Uint8Array,...m){const S=Wu(...m);return F(s(b(S,Vt("context",g),!!i)))}function v(g,m,S={}){g=Vt("message",g),i&&(g=i(g));const{prefix:O,scalar:I,pointBytes:B}=D(m),T=z(S.context,O,g),L=_.multiply(T).toRawBytes(),$=z(S.context,L,B,g),j=U(T+$*I);si("signature.s",j,Et,r);const N=Wu(L,Zo(j,n.BYTES));return Vt("result",N,n.BYTES*2)}const p=Em;function w(g,m,S,O=p){const{context:I,zip215:B}=O,T=n.BYTES;g=Vt("signature",g,2*T),m=Vt("message",m),S=Vt("publicKey",S,T),B!==void 0&&Ko("zip215",B),i&&(m=i(m));const L=is(g.slice(T,2*T));let $,j,N;try{$=x.fromHex(S,B),j=x.fromHex(g.slice(0,T),B),N=_.multiplyUnsafe(L)}catch{return!1}if(!B&&$.isSmallOrder())return!1;const k=z(I,j.toRawBytes(),$.toRawBytes(),m);return j.add($.multiplyUnsafe(k)).subtract(N).clearCofactor().equals(x.ZERO)}return _._setWindowSize(8),{CURVE:t,getPublicKey:q,sign:v,verify:w,ExtendedPoint:x,utils:{getExtendedPublicKey:D,randomPrivateKey:()=>o(n.BYTES),precompute(g=8,m=x.BASE){return m._setWindowSize(g),m.multiply(BigInt(3)),m}}}}BigInt(0),BigInt(1);const na=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ol=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Sm=BigInt(1),al=BigInt(2);BigInt(3);const Om=BigInt(5),Im=BigInt(8);function Bm(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),s=na,o=e*e%s*e%s,a=Ct(o,al,s)*o%s,f=Ct(a,Sm,s)*e%s,c=Ct(f,Om,s)*f%s,u=Ct(c,t,s)*c%s,d=Ct(u,n,s)*u%s,h=Ct(d,r,s)*d%s,l=Ct(h,i,s)*h%s,b=Ct(l,i,s)*h%s,y=Ct(b,t,s)*c%s;return{pow_p_5_8:Ct(y,al,s)*e%s,b2:o}}function Am(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Dm(e,t){const n=na,r=me(t*t*t,n),i=me(r*r*t,n),s=Bm(e*i).pow_p_5_8;let o=me(e*r*s,n);const a=me(t*o*o,n),f=o,c=me(o*ol,n),u=a===e,d=a===me(-e,n),h=a===me(-e*ol,n);return u&&(o=f),(d||h)&&(o=c),um(o,n)&&(o=me(-o,n)),{isValid:u||d,value:o}}const Tm=nl(na,void 0,!0),Rm={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Tm,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Im,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Jy,randomBytes:qu,adjustScalarBytes:Am,uvRatio:Dm},cl=xm(Rm),Nm="EdDSA",Cm="JWT",as=".",cs="base64url",fl="utf8",ul="utf8",$m=":",Pm="did",Lm="key",ll="base58btc",Um="z",Fm="K36",jm=32;function ra(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function hl(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ra(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function dl(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const n=hl(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return ra(n)}function km(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(n[o]!==255)throw new TypeError(s+" is ambiguous");n[o]=i}var a=e.length,f=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var y=0,E=0,A=0,C=b.length;A!==C&&b[A]===0;)A++,y++;for(var x=(C-A)*u+1>>>0,_=new Uint8Array(x);A!==C;){for(var R=b[A],P=0,U=x-1;(R!==0||P<E)&&U!==-1;U--,P++)R+=256*_[U]>>>0,_[U]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");E=P,A++}for(var F=x-E;F!==x&&_[F]===0;)F++;for(var D=f.repeat(y);F<x;++F)D+=e.charAt(_[F]);return D}function h(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;var y=0;if(b[y]!==" "){for(var E=0,A=0;b[y]===f;)E++,y++;for(var C=(b.length-y)*c+1>>>0,x=new Uint8Array(C);b[y];){var _=n[b.charCodeAt(y)];if(_===255)return;for(var R=0,P=C-1;(_!==0||R<A)&&P!==-1;P--,R++)_+=a*x[P]>>>0,x[P]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");A=R,y++}if(b[y]!==" "){for(var U=C-A;U!==C&&x[U]===0;)U++;for(var F=new Uint8Array(E+(C-U)),D=E;U!==C;)F[D++]=x[U++];return F}}}function l(b){var y=h(b);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:l}}var zm=km,Mm=zm;const gl=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},qm=e=>new TextEncoder().encode(e),Vm=e=>new TextDecoder().decode(e);class Hm{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Km{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return bl(this,t)}}class Gm{constructor(t){this.decoders=t}or(t){return bl(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bl=(e,t)=>new Gm({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Zm{constructor(t,n,r,i){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new Hm(t,n,r),this.decoder=new Km(t,n,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const fs=({name:e,prefix:t,encode:n,decode:r})=>new Zm(e,t,n,r),oi=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=Mm(n,t);return fs({prefix:e,name:t,encode:r,decode:s=>gl(i(s))})},Ym=(e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*n/8|0);let a=0,f=0,c=0;for(let u=0;u<s;++u){const d=i[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);f=f<<n|d,a+=n,a>=8&&(a-=8,o[c++]=255&f>>a)}if(a>=n||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},Wm=(e,t,n)=>{const r=t[t.length-1]==="=",i=(1<<n)-1;let s="",o=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],o+=8;o>n;)o-=n,s+=t[i&a>>o];if(o&&(s+=t[i&a<<n-o]),r)for(;s.length*n&7;)s+="=";return s},Ie=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>fs({prefix:t,name:e,encode(i){return Wm(i,r,n)},decode(i){return Ym(i,r,n,e)}}),Xm=fs({prefix:"\0",name:"identity",encode:e=>Vm(e),decode:e=>qm(e)});var Jm=Object.freeze({__proto__:null,identity:Xm});const Qm=Ie({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ew=Object.freeze({__proto__:null,base2:Qm});const tw=Ie({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var nw=Object.freeze({__proto__:null,base8:tw});const rw=oi({prefix:"9",name:"base10",alphabet:"0123456789"});var iw=Object.freeze({__proto__:null,base10:rw});const sw=Ie({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ow=Ie({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var aw=Object.freeze({__proto__:null,base16:sw,base16upper:ow});const cw=Ie({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),fw=Ie({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uw=Ie({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lw=Ie({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hw=Ie({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),dw=Ie({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),gw=Ie({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bw=Ie({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),pw=Ie({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var yw=Object.freeze({__proto__:null,base32:cw,base32upper:fw,base32pad:uw,base32padupper:lw,base32hex:hw,base32hexupper:dw,base32hexpad:gw,base32hexpadupper:bw,base32z:pw});const mw=oi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ww=oi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var vw=Object.freeze({__proto__:null,base36:mw,base36upper:ww});const Ew=oi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_w=oi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xw=Object.freeze({__proto__:null,base58btc:Ew,base58flickr:_w});const Sw=Ie({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ow=Ie({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Iw=Ie({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bw=Ie({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Aw=Object.freeze({__proto__:null,base64:Sw,base64pad:Ow,base64url:Iw,base64urlpad:Bw});const pl=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Dw=pl.reduce((e,t,n)=>(e[n]=t,e),[]),Tw=pl.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function Rw(e){return e.reduce((t,n)=>(t+=Dw[n],t),"")}function Nw(e){const t=[];for(const n of e){const r=Tw[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const Cw=fs({prefix:"\u{1F680}",name:"base256emoji",encode:Rw,decode:Nw});var $w=Object.freeze({__proto__:null,base256emoji:Cw}),Pw=ml,yl=128,Lw=127,Uw=~Lw,Fw=Math.pow(2,31);function ml(e,t,n){t=t||[],n=n||0;for(var r=n;e>=Fw;)t[n++]=e&255|yl,e/=128;for(;e&Uw;)t[n++]=e&255|yl,e>>>=7;return t[n]=e|0,ml.bytes=n-r+1,t}var jw=ia,kw=128,wl=127;function ia(e,r){var n=0,r=r||0,i=0,s=r,o,a=e.length;do{if(s>=a)throw ia.bytes=0,new RangeError("Could not decode varint");o=e[s++],n+=i<28?(o&wl)<<i:(o&wl)*Math.pow(2,i),i+=7}while(o>=kw);return ia.bytes=s-r,n}var zw=Math.pow(2,7),Mw=Math.pow(2,14),qw=Math.pow(2,21),Vw=Math.pow(2,28),Hw=Math.pow(2,35),Kw=Math.pow(2,42),Gw=Math.pow(2,49),Zw=Math.pow(2,56),Yw=Math.pow(2,63),Ww=function(e){return e<zw?1:e<Mw?2:e<qw?3:e<Vw?4:e<Hw?5:e<Kw?6:e<Gw?7:e<Zw?8:e<Yw?9:10},Xw={encode:Pw,decode:jw,encodingLength:Ww},vl=Xw;const El=(e,t,n=0)=>(vl.encode(e,t,n),t),_l=e=>vl.encodingLength(e),sa=(e,t)=>{const n=t.byteLength,r=_l(e),i=r+_l(n),s=new Uint8Array(i+n);return El(e,s,0),El(n,s,r),s.set(t,i),new Jw(e,n,t,s)};class Jw{constructor(t,n,r,i){this.code=t,this.size=n,this.digest=r,this.bytes=i}}const xl=({name:e,code:t,encode:n})=>new Qw(e,t,n);class Qw{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?sa(this.code,n):n.then(r=>sa(this.code,r))}else throw Error("Unknown type, must be binary type")}}const Sl=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),e2=xl({name:"sha2-256",code:18,encode:Sl("SHA-256")}),t2=xl({name:"sha2-512",code:19,encode:Sl("SHA-512")});var n2=Object.freeze({__proto__:null,sha256:e2,sha512:t2});const Ol=0,r2="identity",Il=gl;var i2=Object.freeze({__proto__:null,identity:{code:Ol,name:r2,encode:Il,digest:e=>sa(Ol,Il(e))}});new TextEncoder,new TextDecoder;const Bl={...Jm,...ew,...nw,...iw,...aw,...yw,...vw,...xw,...Aw,...$w};({...n2,...i2});function Al(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Dl=Al("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),oa=Al("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=hl(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),Tl={utf8:Dl,"utf-8":Dl,hex:Bl.base16,latin1:oa,ascii:oa,binary:oa,...Bl};function us(e,t="utf8"){const n=Tl[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}function wr(e,t="utf8"){const n=Tl[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ra(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}function Rl(e){return gr(us(wr(e,cs),fl))}function ls(e){return us(wr(kt(e),fl),cs)}function Nl(e){const t=wr(Fm,ll),n=Um+us(dl([t,e]),ll);return[Pm,Lm,n].join($m)}function s2(e){return us(e,cs)}function o2(e){return wr(e,cs)}function a2(e){return wr([ls(e.header),ls(e.payload)].join(as),ul)}function c2(e){return[ls(e.header),ls(e.payload),s2(e.signature)].join(as)}function aa(e){const t=e.split(as),n=Rl(t[0]),r=Rl(t[1]),i=o2(t[2]),s=wr(t.slice(0,2).join(as),ul);return{header:n,payload:r,signature:i,data:s}}function Cl(e=qu(jm)){const t=cl.getPublicKey(e);return{secretKey:dl([e,t]),publicKey:t}}async function f2(e,t,n,r,i=W.fromMiliseconds(Date.now())){const s={alg:Nm,typ:Cm},o=Nl(r.publicKey),a=i+n,f={iss:o,sub:e,aud:t,iat:i,exp:a},c=a2({header:s,payload:f}),u=cl.sign(c,r.secretKey.slice(0,32));return c2({header:s,payload:f,signature:u})}function u2(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(n[o]!==255)throw new TypeError(s+" is ambiguous");n[o]=i}var a=e.length,f=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var y=0,E=0,A=0,C=b.length;A!==C&&b[A]===0;)A++,y++;for(var x=(C-A)*u+1>>>0,_=new Uint8Array(x);A!==C;){for(var R=b[A],P=0,U=x-1;(R!==0||P<E)&&U!==-1;U--,P++)R+=256*_[U]>>>0,_[U]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");E=P,A++}for(var F=x-E;F!==x&&_[F]===0;)F++;for(var D=f.repeat(y);F<x;++F)D+=e.charAt(_[F]);return D}function h(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;var y=0;if(b[y]!==" "){for(var E=0,A=0;b[y]===f;)E++,y++;for(var C=(b.length-y)*c+1>>>0,x=new Uint8Array(C);b[y];){var _=n[b.charCodeAt(y)];if(_===255)return;for(var R=0,P=C-1;(_!==0||R<A)&&P!==-1;P--,R++)_+=a*x[P]>>>0,x[P]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");A=R,y++}if(b[y]!==" "){for(var U=C-A;U!==C&&x[U]===0;)U++;for(var F=new Uint8Array(E+(C-U)),D=E;U!==C;)F[D++]=x[U++];return F}}}function l(b){var y=h(b);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:l}}var l2=u2,h2=l2;const $l=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},d2=e=>new TextEncoder().encode(e),g2=e=>new TextDecoder().decode(e);class b2{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class p2{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Pl(this,t)}}class y2{constructor(t){this.decoders=t}or(t){return Pl(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Pl=(e,t)=>new y2({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class m2{constructor(t,n,r,i){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new b2(t,n,r),this.decoder=new p2(t,n,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const hs=({name:e,prefix:t,encode:n,decode:r})=>new m2(e,t,n,r),ai=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=h2(n,t);return hs({prefix:e,name:t,encode:r,decode:s=>$l(i(s))})},w2=(e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*n/8|0);let a=0,f=0,c=0;for(let u=0;u<s;++u){const d=i[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);f=f<<n|d,a+=n,a>=8&&(a-=8,o[c++]=255&f>>a)}if(a>=n||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},v2=(e,t,n)=>{const r=t[t.length-1]==="=",i=(1<<n)-1;let s="",o=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],o+=8;o>n;)o-=n,s+=t[i&a>>o];if(o&&(s+=t[i&a<<n-o]),r)for(;s.length*n&7;)s+="=";return s},Be=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>hs({prefix:t,name:e,encode(i){return v2(i,r,n)},decode(i){return w2(i,r,n,e)}}),E2=hs({prefix:"\0",name:"identity",encode:e=>g2(e),decode:e=>d2(e)});var _2=Object.freeze({__proto__:null,identity:E2});const x2=Be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var S2=Object.freeze({__proto__:null,base2:x2});const O2=Be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var I2=Object.freeze({__proto__:null,base8:O2});const B2=ai({prefix:"9",name:"base10",alphabet:"0123456789"});var A2=Object.freeze({__proto__:null,base10:B2});const D2=Be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),T2=Be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var R2=Object.freeze({__proto__:null,base16:D2,base16upper:T2});const N2=Be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),C2=Be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$2=Be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),P2=Be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),L2=Be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),U2=Be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),F2=Be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j2=Be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),k2=Be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var z2=Object.freeze({__proto__:null,base32:N2,base32upper:C2,base32pad:$2,base32padupper:P2,base32hex:L2,base32hexupper:U2,base32hexpad:F2,base32hexpadupper:j2,base32z:k2});const M2=ai({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),q2=ai({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var V2=Object.freeze({__proto__:null,base36:M2,base36upper:q2});const H2=ai({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),K2=ai({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var G2=Object.freeze({__proto__:null,base58btc:H2,base58flickr:K2});const Z2=Be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Y2=Be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),W2=Be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),X2=Be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var J2=Object.freeze({__proto__:null,base64:Z2,base64pad:Y2,base64url:W2,base64urlpad:X2});const Ll=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Q2=Ll.reduce((e,t,n)=>(e[n]=t,e),[]),ev=Ll.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function tv(e){return e.reduce((t,n)=>(t+=Q2[n],t),"")}function nv(e){const t=[];for(const n of e){const r=ev[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const rv=hs({prefix:"\u{1F680}",name:"base256emoji",encode:tv,decode:nv});var iv=Object.freeze({__proto__:null,base256emoji:rv}),sv=Fl,Ul=128,ov=127,av=~ov,cv=Math.pow(2,31);function Fl(e,t,n){t=t||[],n=n||0;for(var r=n;e>=cv;)t[n++]=e&255|Ul,e/=128;for(;e&av;)t[n++]=e&255|Ul,e>>>=7;return t[n]=e|0,Fl.bytes=n-r+1,t}var fv=ca,uv=128,jl=127;function ca(e,r){var n=0,r=r||0,i=0,s=r,o,a=e.length;do{if(s>=a)throw ca.bytes=0,new RangeError("Could not decode varint");o=e[s++],n+=i<28?(o&jl)<<i:(o&jl)*Math.pow(2,i),i+=7}while(o>=uv);return ca.bytes=s-r,n}var lv=Math.pow(2,7),hv=Math.pow(2,14),dv=Math.pow(2,21),gv=Math.pow(2,28),bv=Math.pow(2,35),pv=Math.pow(2,42),yv=Math.pow(2,49),mv=Math.pow(2,56),wv=Math.pow(2,63),vv=function(e){return e<lv?1:e<hv?2:e<dv?3:e<gv?4:e<bv?5:e<pv?6:e<yv?7:e<mv?8:e<wv?9:10},Ev={encode:sv,decode:fv,encodingLength:vv},kl=Ev;const zl=(e,t,n=0)=>(kl.encode(e,t,n),t),Ml=e=>kl.encodingLength(e),fa=(e,t)=>{const n=t.byteLength,r=Ml(e),i=r+Ml(n),s=new Uint8Array(i+n);return zl(e,s,0),zl(n,s,r),s.set(t,i),new _v(e,n,t,s)};class _v{constructor(t,n,r,i){this.code=t,this.size=n,this.digest=r,this.bytes=i}}const ql=({name:e,code:t,encode:n})=>new xv(e,t,n);class xv{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?fa(this.code,n):n.then(r=>fa(this.code,r))}else throw Error("Unknown type, must be binary type")}}const Vl=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Sv=ql({name:"sha2-256",code:18,encode:Vl("SHA-256")}),Ov=ql({name:"sha2-512",code:19,encode:Vl("SHA-512")});var Iv=Object.freeze({__proto__:null,sha256:Sv,sha512:Ov});const Hl=0,Bv="identity",Kl=$l;var Av=Object.freeze({__proto__:null,identity:{code:Hl,name:Bv,encode:Kl,digest:e=>fa(Hl,Kl(e))}});new TextEncoder,new TextDecoder;const Gl={..._2,...S2,...I2,...A2,...R2,...z2,...V2,...G2,...J2,...iv};({...Iv,...Av});function ua(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Zl(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ua(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Yl(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Wl=Yl("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),la=Yl("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=Zl(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),Xl={utf8:Wl,"utf-8":Wl,hex:Gl.base16,latin1:la,ascii:la,binary:la,...Gl};function ot(e,t="utf8"){const n=Xl[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ua(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}var Jl=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},Dv=function(){function e(t,n,r){this.name=t,this.version=n,this.os=r,this.type="browser"}return e}(),Tv=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),Rv=function(){function e(t,n,r,i){this.name=t,this.version=n,this.os=r,this.bot=i,this.type="bot-device"}return e}(),Nv=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),Cv=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),$v=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Pv=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ql=3,Lv=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$v]],eh=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Uv(e){return e?th(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Cv:typeof navigator<"u"?th(navigator.userAgent):kv()}function Fv(e){return e!==""&&Lv.reduce(function(t,n){var r=n[0],i=n[1];if(t)return t;var s=i.exec(e);return!!s&&[r,s]},!1)}function th(e){var t=Fv(e);if(!t)return null;var n=t[0],r=t[1];if(n==="searchbot")return new Nv;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ql&&(i=Jl(Jl([],i,!0),zv(Ql-i.length),!0)):i=[];var s=i.join("."),o=jv(e),a=Pv.exec(e);return a&&a[1]?new Rv(n,s,o,a[1]):new Dv(n,s,o)}function jv(e){for(var t=0,n=eh.length;t<n;t++){var r=eh[t],i=r[0],s=r[1],o=s.exec(e);if(o)return i}return null}function kv(){var e=typeof process<"u"&&process.version;return e?new Tv(process.version.slice(1)):null}function zv(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}var ue={};Object.defineProperty(ue,"__esModule",{value:!0}),ue.getLocalStorage=ue.getLocalStorageOrThrow=ue.getCrypto=ue.getCryptoOrThrow=nh=ue.getLocation=ue.getLocationOrThrow=ha=ue.getNavigator=ue.getNavigatorOrThrow=Er=ue.getDocument=ue.getDocumentOrThrow=ue.getFromWindowOrThrow=ue.getFromWindow=void 0;function Wn(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}ue.getFromWindow=Wn;function vr(e){const t=Wn(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}ue.getFromWindowOrThrow=vr;function Mv(){return vr("document")}ue.getDocumentOrThrow=Mv;function qv(){return Wn("document")}var Er=ue.getDocument=qv;function Vv(){return vr("navigator")}ue.getNavigatorOrThrow=Vv;function Hv(){return Wn("navigator")}var ha=ue.getNavigator=Hv;function Kv(){return vr("location")}ue.getLocationOrThrow=Kv;function Gv(){return Wn("location")}var nh=ue.getLocation=Gv;function Zv(){return vr("crypto")}ue.getCryptoOrThrow=Zv;function Yv(){return Wn("crypto")}ue.getCrypto=Yv;function Wv(){return vr("localStorage")}ue.getLocalStorageOrThrow=Wv;function Xv(){return Wn("localStorage")}ue.getLocalStorage=Xv;var da={};Object.defineProperty(da,"__esModule",{value:!0});var rh=da.getWindowMetadata=void 0;const ih=ue;function Jv(){let e,t;try{e=ih.getDocumentOrThrow(),t=ih.getLocationOrThrow()}catch{return null}function n(){const d=e.getElementsByTagName("link"),h=[];for(let l=0;l<d.length;l++){const b=d[l],y=b.getAttribute("rel");if(y&&y.toLowerCase().indexOf("icon")>-1){const E=b.getAttribute("href");if(E)if(E.toLowerCase().indexOf("https:")===-1&&E.toLowerCase().indexOf("http:")===-1&&E.indexOf("//")!==0){let A=t.protocol+"//"+t.host;if(E.indexOf("/")===0)A+=E;else{const C=t.pathname.split("/");C.pop();const x=C.join("/");A+=x+"/"+E}h.push(A)}else if(E.indexOf("//")===0){const A=t.protocol+E;h.push(A)}else h.push(E)}}return h}function r(...d){const h=e.getElementsByTagName("meta");for(let l=0;l<h.length;l++){const b=h[l],y=["itemprop","property","name"].map(E=>b.getAttribute(E)).filter(E=>E?d.includes(E):!1);if(y.length&&y){const E=b.getAttribute("content");if(E)return E}}return""}function i(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=e.title),d}function s(){return r("description","og:description","twitter:description","keywords")}const o=i(),a=s(),f=t.origin,c=n();return{description:a,url:f,icons:c,name:o}}rh=da.getWindowMetadata=Jv;const Qv="0.1.1";function eE(){return Qv}class Fe extends Error{constructor(t,n={}){const r=(()=>{if(n.cause instanceof Fe){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),i=n.cause instanceof Fe&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${i??""}`,a=[t||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||i?["",r?`Details: ${r}`:void 0,i?`See: ${o}`:void 0]:[]].filter(f=>typeof f=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${eE()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=i,this.shortMessage=t}walk(t){return sh(this,t)}}function sh(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause?sh(e.cause,t):t?null:e}const _r=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ds(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function xr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ht(e,...t){if(!ds(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function oh(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");xr(e.outputLen),xr(e.blockLen)}function Sr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ah(e,t){Ht(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function tE(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function yn(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ga(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function $t(e,t){return e<<32-t|e>>>t}const nE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function rE(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function iE(e){for(let t=0;t<e.length;t++)e[t]=rE(e[t]);return e}const ch=nE?e=>e:iE,fh=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",sE=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Or(e){if(Ht(e),fh)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=sE[e[n]];return t}const Kt={_0:48,_9:57,A:65,F:70,a:97,f:102};function uh(e){if(e>=Kt._0&&e<=Kt._9)return e-Kt._0;if(e>=Kt.A&&e<=Kt.F)return e-(Kt.A-10);if(e>=Kt.a&&e<=Kt.f)return e-(Kt.a-10)}function gs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(fh)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=uh(e.charCodeAt(s)),a=uh(e.charCodeAt(s+1));if(o===void 0||a===void 0){const f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[i]=o*16+a}return r}function ba(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function bs(e){return typeof e=="string"&&(e=ba(e)),Ht(e),e}function Gt(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];Ht(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}class pa{}function ps(e){const t=r=>e().update(bs(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ys(e=32){if(_r&&typeof _r.getRandomValues=="function")return _r.getRandomValues(new Uint8Array(e));if(_r&&typeof _r.randomBytes=="function")return Uint8Array.from(_r.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function oE(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),f=r?4:0,c=r?0:4;e.setUint32(t+f,o,r),e.setUint32(t+c,a,r)}function aE(e,t,n){return e&t^~e&n}function cE(e,t,n){return e&t^e&n^t&n}class lh extends pa{constructor(t,n,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(t),this.view=ga(this.buffer)}update(t){Sr(this),t=bs(t),Ht(t);const{view:n,buffer:r,blockLen:i}=this,s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const f=ga(t);for(;i<=s-o;o+=i)this.process(f,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Sr(this),ah(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,yn(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;oE(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=ga(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<c;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=s,t.length=i,t.pos=a,i%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const Zt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Te=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Re=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),ms=BigInt(2**32-1),hh=BigInt(32);function fE(e,t=!1){return t?{h:Number(e&ms),l:Number(e>>hh&ms)}:{h:Number(e>>hh&ms)|0,l:Number(e&ms)|0}}function dh(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let s=0;s<n;s++){const{h:o,l:a}=fE(e[s],t);[r[s],i[s]]=[o,a]}return[r,i]}const gh=(e,t,n)=>e>>>n,bh=(e,t,n)=>e<<32-n|t>>>n,Ir=(e,t,n)=>e>>>n|t<<32-n,Br=(e,t,n)=>e<<32-n|t>>>n,ws=(e,t,n)=>e<<64-n|t>>>n-32,vs=(e,t,n)=>e>>>n-32|t<<64-n,uE=(e,t,n)=>e<<n|t>>>32-n,lE=(e,t,n)=>t<<n|e>>>32-n,hE=(e,t,n)=>t<<n-32|e>>>64-n,dE=(e,t,n)=>e<<n-32|t>>>64-n;function Yt(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const gE=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),bE=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,pE=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),yE=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,mE=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),wE=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,vE=BigInt(0),ci=BigInt(1),EE=BigInt(2),_E=BigInt(7),xE=BigInt(256),SE=BigInt(113),ph=[],yh=[],mh=[];for(let e=0,t=ci,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],ph.push(2*(5*r+n)),yh.push((e+1)*(e+2)/2%64);let i=vE;for(let s=0;s<7;s++)t=(t<<ci^(t>>_E)*SE)%xE,t&EE&&(i^=ci<<(ci<<BigInt(s))-ci);mh.push(i)}const wh=dh(mh,!0),OE=wh[0],IE=wh[1],vh=(e,t,n)=>n>32?hE(e,t,n):uE(e,t,n),Eh=(e,t,n)=>n>32?dE(e,t,n):lE(e,t,n);function BE(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,f=(o+2)%10,c=n[f],u=n[f+1],d=vh(c,u,1)^n[a],h=Eh(c,u,1)^n[a+1];for(let l=0;l<50;l+=10)e[o+l]^=d,e[o+l+1]^=h}let i=e[2],s=e[3];for(let o=0;o<24;o++){const a=yh[o],f=vh(i,s,a),c=Eh(i,s,a),u=ph[o];i=e[u],s=e[u+1],e[u]=f,e[u+1]=c}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=OE[r],e[1]^=IE[r]}yn(n)}class ya extends pa{constructor(t,n,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=i,this.rounds=s,xr(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=tE(this.state)}clone(){return this._cloneInto()}keccak(){ch(this.state32),BE(this.state32,this.rounds),ch(this.state32),this.posOut=0,this.pos=0}update(t){Sr(this),t=bs(t),Ht(t);const{blockLen:n,state:r}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:i}=this;t[r]^=n,(n&128)!==0&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){Sr(this,!1),Ht(t),this.finish();const n=this.state,{blockLen:r}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return xr(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(ah(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,yn(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new ya(n,r,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}}const AE=(e,t,n)=>ps(()=>new ya(t,e,n)),DE=AE(1,136,256/8),TE=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),mn=new Uint32Array(64);class RE extends lh{constructor(t=32){super(64,t,8,!1),this.A=Zt[0]|0,this.B=Zt[1]|0,this.C=Zt[2]|0,this.D=Zt[3]|0,this.E=Zt[4]|0,this.F=Zt[5]|0,this.G=Zt[6]|0,this.H=Zt[7]|0}get(){const{A:t,B:n,C:r,D:i,E:s,F:o,G:a,H:f}=this;return[t,n,r,i,s,o,a,f]}set(t,n,r,i,s,o,a,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=f|0}process(t,n){for(let d=0;d<16;d++,n+=4)mn[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=mn[d-15],l=mn[d-2],b=$t(h,7)^$t(h,18)^h>>>3,y=$t(l,17)^$t(l,19)^l>>>10;mn[d]=y+mn[d-7]+b+mn[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:f,G:c,H:u}=this;for(let d=0;d<64;d++){const h=$t(a,6)^$t(a,11)^$t(a,25),l=u+h+aE(a,f,c)+TE[d]+mn[d]|0,y=($t(r,2)^$t(r,13)^$t(r,22))+cE(r,i,s)|0;u=c,c=f,f=a,a=o+l|0,o=s,s=i,i=r,r=l+y|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,f,c,u)}roundClean(){yn(mn)}destroy(){this.set(0,0,0,0,0,0,0,0),yn(this.buffer)}}const _h=dh(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),NE=_h[0],CE=_h[1],wn=new Uint32Array(80),vn=new Uint32Array(80);class xh extends lh{constructor(t=64){super(128,t,16,!1),this.Ah=Re[0]|0,this.Al=Re[1]|0,this.Bh=Re[2]|0,this.Bl=Re[3]|0,this.Ch=Re[4]|0,this.Cl=Re[5]|0,this.Dh=Re[6]|0,this.Dl=Re[7]|0,this.Eh=Re[8]|0,this.El=Re[9]|0,this.Fh=Re[10]|0,this.Fl=Re[11]|0,this.Gh=Re[12]|0,this.Gl=Re[13]|0,this.Hh=Re[14]|0,this.Hl=Re[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:f,Eh:c,El:u,Fh:d,Fl:h,Gh:l,Gl:b,Hh:y,Hl:E}=this;return[t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E]}set(t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=l|0,this.Gl=b|0,this.Hh=y|0,this.Hl=E|0}process(t,n){for(let x=0;x<16;x++,n+=4)wn[x]=t.getUint32(n),vn[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){const _=wn[x-15]|0,R=vn[x-15]|0,P=Ir(_,R,1)^Ir(_,R,8)^gh(_,R,7),U=Br(_,R,1)^Br(_,R,8)^bh(_,R,7),F=wn[x-2]|0,D=vn[x-2]|0,q=Ir(F,D,19)^ws(F,D,61)^gh(F,D,6),z=Br(F,D,19)^vs(F,D,61)^bh(F,D,6),v=pE(U,z,vn[x-7],vn[x-16]),p=yE(v,P,q,wn[x-7],wn[x-16]);wn[x]=p|0,vn[x]=v|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:f,Dh:c,Dl:u,Eh:d,El:h,Fh:l,Fl:b,Gh:y,Gl:E,Hh:A,Hl:C}=this;for(let x=0;x<80;x++){const _=Ir(d,h,14)^Ir(d,h,18)^ws(d,h,41),R=Br(d,h,14)^Br(d,h,18)^vs(d,h,41),P=d&l^~d&y,U=h&b^~h&E,F=mE(C,R,U,CE[x],vn[x]),D=wE(F,A,_,P,NE[x],wn[x]),q=F|0,z=Ir(r,i,28)^ws(r,i,34)^ws(r,i,39),v=Br(r,i,28)^vs(r,i,34)^vs(r,i,39),p=r&s^r&a^s&a,w=i&o^i&f^o&f;A=y|0,C=E|0,y=l|0,E=b|0,l=d|0,b=h|0,{h:d,l:h}=Yt(c|0,u|0,D|0,q|0),c=a|0,u=f|0,a=s|0,f=o|0,s=r|0,o=i|0;const g=gE(q,v,w);r=bE(g,D,z,p),i=g|0}({h:r,l:i}=Yt(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=Yt(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:f}=Yt(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=Yt(this.Dh|0,this.Dl|0,c|0,u|0),{h:d,l:h}=Yt(this.Eh|0,this.El|0,d|0,h|0),{h:l,l:b}=Yt(this.Fh|0,this.Fl|0,l|0,b|0),{h:y,l:E}=Yt(this.Gh|0,this.Gl|0,y|0,E|0),{h:A,l:C}=Yt(this.Hh|0,this.Hl|0,A|0,C|0),this.set(r,i,s,o,a,f,c,u,d,h,l,b,y,E,A,C)}roundClean(){yn(wn,vn)}destroy(){yn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class $E extends xh{constructor(){super(48),this.Ah=Te[0]|0,this.Al=Te[1]|0,this.Bh=Te[2]|0,this.Bl=Te[3]|0,this.Ch=Te[4]|0,this.Cl=Te[5]|0,this.Dh=Te[6]|0,this.Dl=Te[7]|0,this.Eh=Te[8]|0,this.El=Te[9]|0,this.Fh=Te[10]|0,this.Fl=Te[11]|0,this.Gh=Te[12]|0,this.Gl=Te[13]|0,this.Hh=Te[14]|0,this.Hl=Te[15]|0}}const Ar=ps(()=>new RE),PE=ps(()=>new xh),LE=ps(()=>new $E);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ma=BigInt(0),Es=BigInt(1);function fi(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function En(e){if(!fi(e))throw new Error("Uint8Array expected")}function ui(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function _s(e){const t=e.toString(16);return t.length&1?"0"+t:t}function Sh(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?ma:BigInt("0x"+e)}const Oh=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",UE=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Xn(e){if(En(e),Oh)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=UE[e[n]];return t}const Wt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ih(e){if(e>=Wt._0&&e<=Wt._9)return e-Wt._0;if(e>=Wt.A&&e<=Wt.F)return e-(Wt.A-10);if(e>=Wt.a&&e<=Wt.f)return e-(Wt.a-10)}function xs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Oh)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=Ih(e.charCodeAt(s)),a=Ih(e.charCodeAt(s+1));if(o===void 0||a===void 0){const f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[i]=o*16+a}return r}function je(e){return Sh(Xn(e))}function Bh(e){return En(e),Sh(Xn(Uint8Array.from(e).reverse()))}function we(e,t){return xs(e.toString(16).padStart(t*2,"0"))}function Ah(e,t){return we(e,t).reverse()}function Ne(e,t,n){let r;if(typeof t=="string")try{r=xs(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(fi(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function be(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];En(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}function wa(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}const va=e=>typeof e=="bigint"&&ma<=e;function Ea(e,t,n){return va(e)&&va(t)&&va(n)&&t<=e&&e<n}function Dr(e,t,n,r){if(!Ea(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function li(e){let t;for(t=0;e>ma;e>>=Es,t+=1);return t}function FE(e,t){return e>>BigInt(t)&Es}const Jn=e=>(Es<<BigInt(e))-Es,_a=e=>new Uint8Array(e),Dh=e=>Uint8Array.from(e);function jE(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=_a(e),i=_a(e),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...d)=>n(i,r,...d),f=(d=_a(0))=>{i=a(Dh([0]),d),r=a(),d.length!==0&&(i=a(Dh([1]),d),r=a())},c=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<t;){r=a();const l=r.slice();h.push(l),d+=r.length}return be(...h)};return(d,h)=>{o(),f(d);let l;for(;!(l=h(c()));)f();return o(),l}}const kE={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||fi(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function hi(e,t,n={}){const r=(i,s,o)=>{const a=kE[s];if(typeof a!="function")throw new Error("invalid validator function");const f=e[i];if(!(o&&f===void 0)&&!a(f,e))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+f)};for(const[i,s]of Object.entries(t))r(i,s,!1);for(const[i,s]of Object.entries(n))r(i,s,!0);return e}const Th=()=>{throw new Error("not implemented")};function xa(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}function zE(e,t){if(Ph(e)>t)throw new r3({givenSize:Ph(e),maxSize:t})}const Xt={zero:48,nine:57,A:65,F:70,a:97,f:102};function Rh(e){if(e>=Xt.zero&&e<=Xt.nine)return e-Xt.zero;if(e>=Xt.A&&e<=Xt.F)return e-(Xt.A-10);if(e>=Xt.a&&e<=Xt.f)return e-(Xt.a-10)}function ME(e,t={}){const{dir:n,size:r=32}=t;if(r===0)return e;if(e.length>r)throw new i3({size:e.length,targetSize:r,type:"Bytes"});const i=new Uint8Array(r);for(let s=0;s<r;s++){const o=n==="right";i[o?s:r-s-1]=e[o?s:e.length-s-1]}return i}function Sa(e,t){if(Ia(e)>t)throw new YE({givenSize:Ia(e),maxSize:t})}function Nh(e,t={}){const{dir:n,size:r=32}=t;if(r===0)return e;const i=e.replace("0x","");if(i.length>r*2)throw new WE({size:Math.ceil(i.length/2),targetSize:r,type:"Hex"});return`0x${i[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const qE=new TextEncoder,VE=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ch(...e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function HE(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(Sa(n,t.size),Ss(n,t.size)):n}function $h(e,t={}){let n="";for(let i=0;i<e.length;i++)n+=VE[e[i]];const r=`0x${n}`;return typeof t.size=="number"?(Sa(r,t.size),Oa(r,t.size)):r}function KE(e,t={}){const{signed:n,size:r}=t,i=BigInt(e);let s;r?n?s=(1n<<BigInt(r)*8n-1n)-1n:s=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&n?-s-1n:0;if(s&&i>s||i<o){const c=typeof e=="bigint"?"n":"";throw new ZE({max:s?`${s}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${e}${c}`})}const f=`0x${(n&&i<0?(1n<<BigInt(r*8))+BigInt(i):i).toString(16)}`;return r?Ss(f,r):f}function GE(e,t={}){return $h(qE.encode(e),t)}function Ss(e,t){return Nh(e,{dir:"left",size:t})}function Oa(e,t){return Nh(e,{dir:"right",size:t})}function Ia(e){return Math.ceil((e.length-2)/2)}class ZE extends Fe{constructor({max:t,min:n,signed:r,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${i*8}-bit`:""}${r?" signed":" unsigned"} integer range ${t?`(\`${n}\` to \`${t}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class YE extends Fe{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class WE extends Fe{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}const XE=new TextEncoder;function JE(e){return e instanceof Uint8Array?e:typeof e=="string"?e3(e):QE(e)}function QE(e){return e instanceof Uint8Array?e:new Uint8Array(e)}function e3(e,t={}){const{size:n}=t;let r=e;n&&(Sa(e,n),r=Oa(e,n));let i=r.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,f=0;a<s;a++){const c=Rh(i.charCodeAt(f++)),u=Rh(i.charCodeAt(f++));if(c===void 0||u===void 0)throw new Fe(`Invalid byte sequence ("${i[f-2]}${i[f-1]}" in "${i}").`);o[a]=c*16+u}return o}function t3(e,t={}){const{size:n}=t,r=XE.encode(e);return typeof n=="number"?(zE(r,n),n3(r,n)):r}function n3(e,t){return ME(e,{dir:"right",size:t})}function Ph(e){return e.length}class r3 extends Fe{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${t}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class i3 extends Fe{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${t}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function s3(e,t={}){const{as:n=typeof e=="string"?"Hex":"Bytes"}=t,r=DE(JE(e));return n==="Bytes"?r:$h(r)}class o3 extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const Ba={checksum:new o3(8192)}.checksum,a3=/^0x[a-fA-F0-9]{40}$/;function Lh(e,t={}){const{strict:n=!0}=t;if(!a3.test(e))throw new Uh({address:e,cause:new f3});if(n){if(e.toLowerCase()===e)return;if(c3(e)!==e)throw new Uh({address:e,cause:new u3})}}function c3(e){if(Ba.has(e))return Ba.get(e);Lh(e,{strict:!1});const t=e.substring(2).toLowerCase(),n=s3(t3(t),{as:"Bytes"}),r=t.split("");for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&r[s]&&(r[s]=r[s].toUpperCase()),(n[s>>1]&15)>=8&&r[s+1]&&(r[s+1]=r[s+1].toUpperCase());const i=`0x${r.join("")}`;return Ba.set(e,i),i}class Uh extends Fe{constructor({address:t,cause:n}){super(`Address "${t}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class f3 extends Fe{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class u3 extends Fe{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const l3=/^(.*)\[([0-9]*)\]$/,h3=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,d3=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Aa(e,t){if(e.length!==t.length)throw new b3({expectedLength:e.length,givenLength:t.length});const n=[];for(let r=0;r<e.length;r++){const i=e[r],s=t[r];n.push(Aa.encode(i,s))}return Ch(...n)}(function(e){function t(n,r,i=!1){if(n==="address"){const f=r;return Lh(f),Ss(f.toLowerCase(),i?32:0)}if(n==="string")return GE(r);if(n==="bytes")return r;if(n==="bool")return Ss(HE(r),i?32:1);const s=n.match(d3);if(s){const[f,c,u="256"]=s,d=Number.parseInt(u,10)/8;return KE(r,{size:i?32:d,signed:c==="int"})}const o=n.match(h3);if(o){const[f,c]=o;if(Number.parseInt(c,10)!==(r.length-2)/2)throw new g3({expectedSize:Number.parseInt(c,10),value:r});return Oa(r,i?32:0)}const a=n.match(l3);if(a&&Array.isArray(r)){const[f,c]=a,u=[];for(let d=0;d<r.length;d++)u.push(t(c,r[d],!0));return u.length===0?"0x":Ch(...u)}throw new p3(n)}e.encode=t})(Aa||(Aa={}));class g3 extends Fe{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${Ia(n)}) does not match expected size (bytes${t}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class b3 extends Fe{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${t}`,`Given length (values): ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class p3 extends Fe{constructor(t){super(`Type \`${t}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class Fh extends pa{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,oh(t);const r=bs(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?t.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),yn(s)}update(t){return Sr(this),this.iHash.update(t),this}digestInto(t){Sr(this),Ht(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Da=(e,t,n)=>new Fh(e,t).update(n).digest();Da.create=(e,t)=>new Fh(e,t);const Ye=BigInt(0),ke=BigInt(1),Qn=BigInt(2),y3=BigInt(3),jh=BigInt(4),kh=BigInt(5),zh=BigInt(8);function ze(e,t){const n=e%t;return n>=Ye?n:t+n}function gt(e,t,n){let r=e;for(;t-- >Ye;)r*=r,r%=n;return r}function Ta(e,t){if(e===Ye)throw new Error("invert: expected non-zero number");if(t<=Ye)throw new Error("invert: expected positive modulus, got "+t);let n=ze(e,t),r=t,i=Ye,s=ke;for(;n!==Ye;){const a=r/n,f=r%n,c=i-s*a;r=n,n=f,i=s,s=c}if(r!==ke)throw new Error("invert: does not exist");return ze(i,t)}function Mh(e,t){const n=(e.ORDER+ke)/jh,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function m3(e,t){const n=(e.ORDER-kh)/zh,r=e.mul(t,Qn),i=e.pow(r,n),s=e.mul(t,i),o=e.mul(e.mul(s,Qn),i),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function w3(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-ke,n=0;for(;t%Qn===Ye;)t/=Qn,n++;let r=Qn;const i=_n(e);for(;Is(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Mh;let s=i.pow(r,t);const o=(t+ke)/Qn;return function(f,c){if(f.is0(c))return c;if(Is(f,c)!==1)throw new Error("Cannot find square root");let u=n,d=f.mul(f.ONE,s),h=f.pow(c,t),l=f.pow(c,o);for(;!f.eql(h,f.ONE);){if(f.is0(h))return f.ZERO;let b=1,y=f.sqr(h);for(;!f.eql(y,f.ONE);)if(b++,y=f.sqr(y),b===u)throw new Error("Cannot find square root");const E=ke<<BigInt(u-b-1),A=f.pow(d,E);u=b,d=f.sqr(A),h=f.mul(h,d),l=f.mul(l,A)}return l}}function v3(e){return e%jh===y3?Mh:e%zh===kh?m3:w3(e)}const E3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qh(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=E3.reduce((r,i)=>(r[i]="function",r),t);return hi(e,n)}function Os(e,t,n){if(n<Ye)throw new Error("invalid exponent, negatives unsupported");if(n===Ye)return e.ONE;if(n===ke)return t;let r=e.ONE,i=t;for(;n>Ye;)n&ke&&(r=e.mul(r,i)),i=e.sqr(i),n>>=ke;return r}function er(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((o,a,f)=>e.is0(a)?o:(r[f]=o,e.mul(o,a)),e.ONE),s=e.inv(i);return t.reduceRight((o,a,f)=>e.is0(a)?o:(r[f]=e.mul(o,r[f]),e.mul(o,a)),s),r}function Is(e,t){const n=(e.ORDER-ke)/Qn,r=e.pow(t,n),i=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function Vh(e,t){t!==void 0&&xr(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function _n(e,t,n=!1,r={}){if(e<=Ye)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=Vh(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:s,MASK:Jn(i),ZERO:Ye,ONE:ke,create:f=>ze(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return Ye<=f&&f<e},is0:f=>f===Ye,isOdd:f=>(f&ke)===ke,neg:f=>ze(-f,e),eql:(f,c)=>f===c,sqr:f=>ze(f*f,e),add:(f,c)=>ze(f+c,e),sub:(f,c)=>ze(f-c,e),mul:(f,c)=>ze(f*c,e),pow:(f,c)=>Os(a,f,c),div:(f,c)=>ze(f*Ta(c,e),e),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>Ta(f,e),sqrt:r.sqrt||(f=>(o||(o=v3(e)),o(a,f))),toBytes:f=>n?Ah(f,s):we(f,s),fromBytes:f=>{if(f.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+f.length);return n?Bh(f):je(f)},invertBatch:f=>er(a,f),cmov:(f,c,u)=>u?c:f});return Object.freeze(a)}function Hh(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Ra(e){const t=Hh(e);return t+Math.ceil(t/2)}function Kh(e,t,n=!1){const r=e.length,i=Hh(t),s=Ra(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=n?Bh(e):je(e),a=ze(o,t-ke)+ke;return n?Ah(a,i):we(a,i)}const Gh=BigInt(0),Na=BigInt(1);function Ca(e,t){const n=t.negate();return e?n:t}function Zh(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function $a(e,t){Zh(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,s=Jn(e),o=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function Yh(e,t,n){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=n;let a=Number(e&i),f=e>>o;a>r&&(a-=s,f+=Na);const c=t*r,u=c+Math.abs(a)-1,d=a===0,h=a<0,l=t%2!==0;return{nextN:f,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:c}}function _3(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function x3(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Pa=new WeakMap,Wh=new WeakMap;function La(e){return Wh.get(e)||1}function S3(e,t){return{constTimeNegate:Ca,hasPrecomputes(n){return La(n)!==1},unsafeLadder(n,r,i=e.ZERO){let s=n;for(;r>Gh;)r&Na&&(i=i.add(s)),s=s.double(),r>>=Na;return i},precomputeWindow(n,r){const{windows:i,windowSize:s}=$a(r,t),o=[];let a=n,f=a;for(let c=0;c<i;c++){f=a,o.push(f);for(let u=1;u<s;u++)f=f.add(a),o.push(f);a=f.double()}return o},wNAF(n,r,i){let s=e.ZERO,o=e.BASE;const a=$a(n,t);for(let f=0;f<a.windows;f++){const{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:b}=Yh(i,f,a);i=c,d?o=o.add(Ca(l,r[b])):s=s.add(Ca(h,r[u]))}return{p:s,f:o}},wNAFUnsafe(n,r,i,s=e.ZERO){const o=$a(n,t);for(let a=0;a<o.windows&&i!==Gh;a++){const{nextN:f,offset:c,isZero:u,isNeg:d}=Yh(i,a,o);if(i=f,!u){const h=r[c];s=s.add(d?h.negate():h)}}return s},getPrecomputes(n,r,i){let s=Pa.get(r);return s||(s=this.precomputeWindow(r,n),n!==1&&Pa.set(r,i(s))),s},wNAFCached(n,r,i){const s=La(n);return this.wNAF(s,this.getPrecomputes(s,n,i),r)},wNAFCachedUnsafe(n,r,i,s){const o=La(n);return o===1?this.unsafeLadder(n,r,s):this.wNAFUnsafe(o,this.getPrecomputes(o,n,i),r,s)},setWindowSize(n,r){Zh(r,t),Wh.set(n,r),Pa.delete(n)}}}function O3(e,t,n,r){_3(n,e),x3(r,t);const i=n.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=li(BigInt(i));let f=1;a>12?f=a-3:a>4?f=a-2:a>0&&(f=2);const c=Jn(f),u=new Array(Number(c)+1).fill(o),d=Math.floor((t.BITS-1)/f)*f;let h=o;for(let l=d;l>=0;l-=f){u.fill(o);for(let y=0;y<s;y++){const E=r[y],A=Number(E>>BigInt(l)&c);u[A]=u[A].add(n[y])}let b=o;for(let y=u.length-1,E=o;y>0;y--)E=E.add(u[y]),b=b.add(E);if(h=h.add(b),l!==0)for(let y=0;y<f;y++)h=h.double()}return h}function Xh(e){return qh(e.Fp),hi(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Vh(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Jh(e){e.lowS!==void 0&&ui("lowS",e.lowS),e.prehash!==void 0&&ui("prehash",e.prehash)}function I3(e){const t=Xh(e);hi(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}class B3 extends Error{constructor(t=""){super(t)}}const Jt={Err:B3,_tlv:{encode:(e,t)=>{const{Err:n}=Jt;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=_s(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?_s(i.length/2|128):"";return _s(e)+s+i+t},decode(e,t){const{Err:n}=Jt;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const f=i&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+f);if(c.length!==f)throw new n("tlv.decode: length bytes not complete");if(c[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of c)o=o<<8|u;if(r+=f,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=Jt;if(e<_t)throw new t("integer: negative integers are not allowed");let n=_s(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Jt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return je(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Jt,i=Ne("signature",e),{v:s,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:f}=r.decode(2,s),{v:c,l:u}=r.decode(2,f);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=Jt,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),s=r+i;return t.encode(48,s)}};function Ua(e,t){return Xn(we(e,t))}const _t=BigInt(0),ce=BigInt(1),xn=BigInt(2),di=BigInt(3),Fa=BigInt(4);function ja(e){const t=I3(e),{Fp:n}=t,r=_n(t.n,t.nBitLength),i=t.toBytes||((x,_,R)=>{const P=_.toAffine();return be(Uint8Array.from([4]),n.toBytes(P.x),n.toBytes(P.y))}),s=t.fromBytes||(x=>{const _=x.subarray(1),R=n.fromBytes(_.subarray(0,n.BYTES)),P=n.fromBytes(_.subarray(n.BYTES,2*n.BYTES));return{x:R,y:P}});function o(x){const{a:_,b:R}=t,P=n.sqr(x),U=n.mul(P,x);return n.add(n.add(U,n.mul(x,_)),R)}function a(x,_){const R=n.sqr(_),P=o(x);return n.eql(R,P)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const f=n.mul(n.pow(t.a,di),Fa),c=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(f,c)))throw new Error("bad curve params: a or b");function u(x){return Ea(x,ce,t.n)}function d(x){const{allowedPrivateKeyLengths:_,nByteLength:R,wrapPrivateKey:P,n:U}=t;if(_&&typeof x!="bigint"){if(fi(x)&&(x=Xn(x)),typeof x!="string"||!_.includes(x.length))throw new Error("invalid private key");x=x.padStart(R*2,"0")}let F;try{F=typeof x=="bigint"?x:je(Ne("private key",x,R))}catch{throw new Error("invalid private key, expected hex or "+R+" bytes, got "+typeof x)}return P&&(F=ze(F,U)),Dr("private key",F,ce,U),F}function h(x){if(!(x instanceof y))throw new Error("ProjectivePoint expected")}const l=xa((x,_)=>{const{px:R,py:P,pz:U}=x;if(n.eql(U,n.ONE))return{x:R,y:P};const F=x.is0();_==null&&(_=F?n.ONE:n.inv(U));const D=n.mul(R,_),q=n.mul(P,_),z=n.mul(U,_);if(F)return{x:n.ZERO,y:n.ZERO};if(!n.eql(z,n.ONE))throw new Error("invZ was invalid");return{x:D,y:q}}),b=xa(x=>{if(x.is0()){if(t.allowInfinityPoint&&!n.is0(x.py))return;throw new Error("bad point: ZERO")}const{x:_,y:R}=x.toAffine();if(!n.isValid(_)||!n.isValid(R))throw new Error("bad point: x or y not FE");if(!a(_,R))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class y{constructor(_,R,P){if(_==null||!n.isValid(_))throw new Error("x required");if(R==null||!n.isValid(R)||n.is0(R))throw new Error("y required");if(P==null||!n.isValid(P))throw new Error("z required");this.px=_,this.py=R,this.pz=P,Object.freeze(this)}static fromAffine(_){const{x:R,y:P}=_||{};if(!_||!n.isValid(R)||!n.isValid(P))throw new Error("invalid affine point");if(_ instanceof y)throw new Error("projective point not allowed");const U=F=>n.eql(F,n.ZERO);return U(R)&&U(P)?y.ZERO:new y(R,P,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const R=er(n,_.map(P=>P.pz));return _.map((P,U)=>P.toAffine(R[U])).map(y.fromAffine)}static fromHex(_){const R=y.fromAffine(s(Ne("pointHex",_)));return R.assertValidity(),R}static fromPrivateKey(_){return y.BASE.multiply(d(_))}static msm(_,R){return O3(y,r,_,R)}_setWindowSize(_){C.setWindowSize(this,_)}assertValidity(){b(this)}hasEvenY(){const{y:_}=this.toAffine();if(n.isOdd)return!n.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){h(_);const{px:R,py:P,pz:U}=this,{px:F,py:D,pz:q}=_,z=n.eql(n.mul(R,q),n.mul(F,U)),v=n.eql(n.mul(P,q),n.mul(D,U));return z&&v}negate(){return new y(this.px,n.neg(this.py),this.pz)}double(){const{a:_,b:R}=t,P=n.mul(R,di),{px:U,py:F,pz:D}=this;let q=n.ZERO,z=n.ZERO,v=n.ZERO,p=n.mul(U,U),w=n.mul(F,F),g=n.mul(D,D),m=n.mul(U,F);return m=n.add(m,m),v=n.mul(U,D),v=n.add(v,v),q=n.mul(_,v),z=n.mul(P,g),z=n.add(q,z),q=n.sub(w,z),z=n.add(w,z),z=n.mul(q,z),q=n.mul(m,q),v=n.mul(P,v),g=n.mul(_,g),m=n.sub(p,g),m=n.mul(_,m),m=n.add(m,v),v=n.add(p,p),p=n.add(v,p),p=n.add(p,g),p=n.mul(p,m),z=n.add(z,p),g=n.mul(F,D),g=n.add(g,g),p=n.mul(g,m),q=n.sub(q,p),v=n.mul(g,w),v=n.add(v,v),v=n.add(v,v),new y(q,z,v)}add(_){h(_);const{px:R,py:P,pz:U}=this,{px:F,py:D,pz:q}=_;let z=n.ZERO,v=n.ZERO,p=n.ZERO;const w=t.a,g=n.mul(t.b,di);let m=n.mul(R,F),S=n.mul(P,D),O=n.mul(U,q),I=n.add(R,P),B=n.add(F,D);I=n.mul(I,B),B=n.add(m,S),I=n.sub(I,B),B=n.add(R,U);let T=n.add(F,q);return B=n.mul(B,T),T=n.add(m,O),B=n.sub(B,T),T=n.add(P,U),z=n.add(D,q),T=n.mul(T,z),z=n.add(S,O),T=n.sub(T,z),p=n.mul(w,B),z=n.mul(g,O),p=n.add(z,p),z=n.sub(S,p),p=n.add(S,p),v=n.mul(z,p),S=n.add(m,m),S=n.add(S,m),O=n.mul(w,O),B=n.mul(g,B),S=n.add(S,O),O=n.sub(m,O),O=n.mul(w,O),B=n.add(B,O),m=n.mul(S,B),v=n.add(v,m),m=n.mul(T,B),z=n.mul(I,z),z=n.sub(z,m),m=n.mul(I,S),p=n.mul(T,p),p=n.add(p,m),new y(z,v,p)}subtract(_){return this.add(_.negate())}is0(){return this.equals(y.ZERO)}wNAF(_){return C.wNAFCached(this,_,y.normalizeZ)}multiplyUnsafe(_){const{endo:R,n:P}=t;Dr("scalar",_,_t,P);const U=y.ZERO;if(_===_t)return U;if(this.is0()||_===ce)return this;if(!R||C.hasPrecomputes(this))return C.wNAFCachedUnsafe(this,_,y.normalizeZ);let{k1neg:F,k1:D,k2neg:q,k2:z}=R.splitScalar(_),v=U,p=U,w=this;for(;D>_t||z>_t;)D&ce&&(v=v.add(w)),z&ce&&(p=p.add(w)),w=w.double(),D>>=ce,z>>=ce;return F&&(v=v.negate()),q&&(p=p.negate()),p=new y(n.mul(p.px,R.beta),p.py,p.pz),v.add(p)}multiply(_){const{endo:R,n:P}=t;Dr("scalar",_,ce,P);let U,F;if(R){const{k1neg:D,k1:q,k2neg:z,k2:v}=R.splitScalar(_);let{p,f:w}=this.wNAF(q),{p:g,f:m}=this.wNAF(v);p=C.constTimeNegate(D,p),g=C.constTimeNegate(z,g),g=new y(n.mul(g.px,R.beta),g.py,g.pz),U=p.add(g),F=w.add(m)}else{const{p:D,f:q}=this.wNAF(_);U=D,F=q}return y.normalizeZ([U,F])[0]}multiplyAndAddUnsafe(_,R,P){const U=y.BASE,F=(q,z)=>z===_t||z===ce||!q.equals(U)?q.multiplyUnsafe(z):q.multiply(z),D=F(this,R).add(F(_,P));return D.is0()?void 0:D}toAffine(_){return l(this,_)}isTorsionFree(){const{h:_,isTorsionFree:R}=t;if(_===ce)return!0;if(R)return R(y,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:R}=t;return _===ce?this:R?R(y,this):this.multiplyUnsafe(t.h)}toRawBytes(_=!0){return ui("isCompressed",_),this.assertValidity(),i(y,this,_)}toHex(_=!0){return ui("isCompressed",_),Xn(this.toRawBytes(_))}}y.BASE=new y(t.Gx,t.Gy,n.ONE),y.ZERO=new y(n.ZERO,n.ONE,n.ZERO);const{endo:E,nBitLength:A}=t,C=S3(y,E?Math.ceil(A/2):A);return{CURVE:t,ProjectivePoint:y,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function A3(e){const t=Xh(e);return hi(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function D3(e){const t=A3(e),{Fp:n,n:r,nByteLength:i,nBitLength:s}=t,o=n.BYTES+1,a=2*n.BYTES+1;function f(g){return ze(g,r)}function c(g){return Ta(g,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:l}=ja({...t,toBytes(g,m,S){const O=m.toAffine(),I=n.toBytes(O.x),B=be;return ui("isCompressed",S),S?B(Uint8Array.from([m.hasEvenY()?2:3]),I):B(Uint8Array.from([4]),I,n.toBytes(O.y))},fromBytes(g){const m=g.length,S=g[0],O=g.subarray(1);if(m===o&&(S===2||S===3)){const I=je(O);if(!Ea(I,ce,n.ORDER))throw new Error("Point is not on curve");const B=h(I);let T;try{T=n.sqrt(B)}catch(j){const N=j instanceof Error?": "+j.message:"";throw new Error("Point is not on curve"+N)}const L=(T&ce)===ce;return(S&1)===1!==L&&(T=n.neg(T)),{x:I,y:T}}else if(m===a&&S===4){const I=n.fromBytes(O.subarray(0,n.BYTES)),B=n.fromBytes(O.subarray(n.BYTES,2*n.BYTES));return{x:I,y:B}}else{const I=o,B=a;throw new Error("invalid Point, expected length of "+I+", or uncompressed "+B+", got "+m)}}});function b(g){const m=r>>ce;return g>m}function y(g){return b(g)?f(-g):g}const E=(g,m,S)=>je(g.slice(m,S));class A{constructor(m,S,O){Dr("r",m,ce,r),Dr("s",S,ce,r),this.r=m,this.s=S,O!=null&&(this.recovery=O),Object.freeze(this)}static fromCompact(m){const S=i;return m=Ne("compactSignature",m,S*2),new A(E(m,0,S),E(m,S,2*S))}static fromDER(m){const{r:S,s:O}=Jt.toSig(Ne("DER",m));return new A(S,O)}assertValidity(){}addRecoveryBit(m){return new A(this.r,this.s,m)}recoverPublicKey(m){const{r:S,s:O,recovery:I}=this,B=U(Ne("msgHash",m));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const T=I===2||I===3?S+t.n:S;if(T>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const L=(I&1)===0?"02":"03",$=u.fromHex(L+Ua(T,n.BYTES)),j=c(T),N=f(-B*j),k=f(O*j),M=u.BASE.multiplyAndAddUnsafe($,N,k);if(!M)throw new Error("point at infinify");return M.assertValidity(),M}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new A(this.r,f(-this.s),this.recovery):this}toDERRawBytes(){return xs(this.toDERHex())}toDERHex(){return Jt.hexFromSig(this)}toCompactRawBytes(){return xs(this.toCompactHex())}toCompactHex(){const m=i;return Ua(this.r,m)+Ua(this.s,m)}}const C={isValidPrivateKey(g){try{return d(g),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const g=Ra(t.n);return Kh(t.randomBytes(g),t.n)},precompute(g=8,m=u.BASE){return m._setWindowSize(g),m.multiply(BigInt(3)),m}};function x(g,m=!0){return u.fromPrivateKey(g).toRawBytes(m)}function _(g){if(typeof g=="bigint")return!1;if(g instanceof u)return!0;const S=Ne("key",g).length,O=n.BYTES,I=O+1,B=2*O+1;if(!(t.allowedPrivateKeyLengths||i===I))return S===I||S===B}function R(g,m,S=!0){if(_(g)===!0)throw new Error("first arg must be private key");if(_(m)===!1)throw new Error("second arg must be public key");return u.fromHex(m).multiply(d(g)).toRawBytes(S)}const P=t.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const m=je(g),S=g.length*8-s;return S>0?m>>BigInt(S):m},U=t.bits2int_modN||function(g){return f(P(g))},F=Jn(s);function D(g){return Dr("num < 2^"+s,g,_t,F),we(g,i)}function q(g,m,S=z){if(["recovered","canonical"].some(V=>V in S))throw new Error("sign() legacy options not supported");const{hash:O,randomBytes:I}=t;let{lowS:B,prehash:T,extraEntropy:L}=S;B==null&&(B=!0),g=Ne("msgHash",g),Jh(S),T&&(g=Ne("prehashed msgHash",O(g)));const $=U(g),j=d(m),N=[D(j),D($)];if(L!=null&&L!==!1){const V=L===!0?I(n.BYTES):L;N.push(Ne("extraEntropy",V))}const k=be(...N),M=$;function G(V){const K=P(V);if(!l(K))return;const J=c(K),ee=u.BASE.multiply(K).toAffine(),re=f(ee.x);if(re===_t)return;const he=f(J*f(M+re*j));if(he===_t)return;let de=(ee.x===re?0:2)|Number(ee.y&ce),hn=he;return B&&b(he)&&(hn=y(he),de^=1),new A(re,hn,de)}return{seed:k,k2sig:G}}const z={lowS:t.lowS,prehash:!1},v={lowS:t.lowS,prehash:!1};function p(g,m,S=z){const{seed:O,k2sig:I}=q(g,m,S),B=t;return jE(B.hash.outputLen,B.nByteLength,B.hmac)(O,I)}u.BASE._setWindowSize(8);function w(g,m,S,O=v){const I=g;m=Ne("msgHash",m),S=Ne("publicKey",S);const{lowS:B,prehash:T,format:L}=O;if(Jh(O),"strict"in O)throw new Error("options.strict was renamed to lowS");if(L!==void 0&&L!=="compact"&&L!=="der")throw new Error("format must be compact or der");const $=typeof I=="string"||fi(I),j=!$&&!L&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!$&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let N,k;try{if(j&&(N=new A(I.r,I.s)),$){try{L!=="compact"&&(N=A.fromDER(I))}catch(de){if(!(de instanceof Jt.Err))throw de}!N&&L!=="der"&&(N=A.fromCompact(I))}k=u.fromHex(S)}catch{return!1}if(!N||B&&N.hasHighS())return!1;T&&(m=t.hash(m));const{r:M,s:G}=N,V=U(m),K=c(G),J=f(V*K),ee=f(M*K),re=u.BASE.multiplyAndAddUnsafe(k,J,ee)?.toAffine();return re?f(re.x)===M:!1}return{CURVE:t,getPublicKey:x,getSharedSecret:R,sign:p,verify:w,ProjectivePoint:u,Signature:A,utils:C}}function T3(e,t){const n=e.ORDER;let r=_t;for(let b=n-ce;b%xn===_t;b/=xn)r+=ce;const i=r,s=xn<<i-ce-ce,o=s*xn,a=(n-ce)/o,f=(a-ce)/xn,c=o-ce,u=s,d=e.pow(t,a),h=e.pow(t,(a+ce)/xn);let l=(b,y)=>{let E=d,A=e.pow(y,c),C=e.sqr(A);C=e.mul(C,y);let x=e.mul(b,C);x=e.pow(x,f),x=e.mul(x,A),A=e.mul(x,y),C=e.mul(x,b);let _=e.mul(C,A);x=e.pow(_,u);let R=e.eql(x,e.ONE);A=e.mul(C,h),x=e.mul(_,E),C=e.cmov(A,C,R),_=e.cmov(x,_,R);for(let P=i;P>ce;P--){let U=P-xn;U=xn<<U-ce;let F=e.pow(_,U);const D=e.eql(F,e.ONE);A=e.mul(C,E),E=e.mul(E,E),F=e.mul(_,E),C=e.cmov(A,C,D),_=e.cmov(F,_,D)}return{isValid:R,value:C}};if(e.ORDER%Fa===di){const b=(e.ORDER-di)/Fa,y=e.sqrt(e.neg(t));l=(E,A)=>{let C=e.sqr(A);const x=e.mul(E,A);C=e.mul(C,x);let _=e.pow(C,b);_=e.mul(_,x);const R=e.mul(_,y),P=e.mul(e.sqr(_),A),U=e.eql(P,E);let F=e.cmov(R,_,U);return{isValid:U,value:F}}}return l}function Qh(e,t){if(qh(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=T3(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,s,o,a,f,c,u,d;i=e.sqr(r),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),c=e.sqr(a),f=e.mul(c,t.A),s=e.add(s,f),s=e.mul(s,o),c=e.mul(c,a),f=e.mul(c,t.B),s=e.add(s,f),u=e.mul(i,o);const{isValid:h,value:l}=n(s,c);d=e.mul(i,r),d=e.mul(d,l),u=e.cmov(u,o,h),d=e.cmov(d,l,h);const b=e.isOdd(r)===e.isOdd(d);d=e.cmov(e.neg(d),d,b);const y=er(e,[a],!0)[0];return u=e.mul(u,y),{x:u,y:d}}}function R3(e){return{hash:e,hmac:(t,...n)=>Da(e,t,Gt(...n)),randomBytes:ys}}function Bs(e,t){const n=r=>D3({...e,...R3(r)});return{...n(t),create:n}}const N3=je;function Sn(e,t){if(gi(e),gi(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}function C3(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function gi(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function $3(e,t,n,r){En(e),En(t),gi(n),t.length>255&&(t=r(be(wa("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:s}=r,o=Math.ceil(n/i);if(n>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=be(t,Sn(t.length,1)),f=Sn(0,s),c=Sn(n,2),u=new Array(o),d=r(be(f,e,c,Sn(0,1),a));u[0]=r(be(d,Sn(1,1),a));for(let l=1;l<=o;l++){const b=[C3(d,u[l-1]),Sn(l+1,1),a];u[l]=r(be(...b))}return be(...u).slice(0,n)}function P3(e,t,n,r,i){if(En(e),En(t),gi(n),t.length>255){const s=Math.ceil(2*r/8);t=i.create({dkLen:s}).update(wa("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(e).update(Sn(n,2)).update(t).update(Sn(t.length,1)).digest()}function ed(e,t,n){hi(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:s,hash:o,expand:a,DST:f}=n;En(e),gi(t);const c=typeof f=="string"?wa(f):f,u=r.toString(2).length,d=Math.ceil((u+i)/8),h=t*s*d;let l;if(a==="xmd")l=$3(e,c,h,o);else if(a==="xof")l=P3(e,c,h,i,o);else if(a==="_internal_pass")l=e;else throw new Error('expand must be "xmd" or "xof"');const b=new Array(t);for(let y=0;y<t;y++){const E=new Array(s);for(let A=0;A<s;A++){const C=d*(A+y*s),x=l.subarray(C,C+d);E[A]=ze(N3(x),r)}b[y]=E}return b}function td(e,t){const n=t.map(r=>Array.from(r).reverse());return(r,i)=>{const[s,o,a,f]=n.map(d=>d.reduce((h,l)=>e.add(e.mul(h,r),l))),[c,u]=er(e,[o,f],!0);return r=e.mul(s,c),i=e.mul(i,e.mul(a,u)),{x:r,y:i}}}function nd(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function r(s){return e.fromAffine(t(s))}function i(s){const o=s.clearCofactor();return o.equals(e.ZERO)?e.ZERO:(o.assertValidity(),o)}return{defaults:n,hashToCurve(s,o){const a=ed(s,2,{...n,DST:n.DST,...o}),f=r(a[0]),c=r(a[1]);return i(f.add(c))},encodeToCurve(s,o){const a=ed(s,1,{...n,DST:n.encodeDST,...o});return i(r(a[0]))},mapToCurve(s){if(!Array.isArray(s))throw new Error("expected array of bigints");for(const o of s)if(typeof o!="bigint")throw new Error("expected array of bigints");return i(r(s))}}}const rd=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),id=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),L3=BigInt(0),U3=BigInt(1),ka=BigInt(2),sd=(e,t)=>(e+t/ka)/t;function F3(e){const t=rd,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),f=BigInt(88),c=e*e*e%t,u=c*c*e%t,d=gt(u,n,t)*u%t,h=gt(d,n,t)*u%t,l=gt(h,ka,t)*c%t,b=gt(l,i,t)*l%t,y=gt(b,s,t)*b%t,E=gt(y,a,t)*y%t,A=gt(E,f,t)*E%t,C=gt(A,a,t)*y%t,x=gt(C,n,t)*u%t,_=gt(x,o,t)*b%t,R=gt(_,r,t)*c%t,P=gt(R,ka,t);if(!za.eql(za.sqr(P),e))throw new Error("Cannot find square root");return P}const za=_n(rd,void 0,void 0,{sqrt:F3});Bs({a:L3,b:BigInt(7),Fp:za,n:id,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=id,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-U3*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,o=BigInt("0x100000000000000000000000000000000"),a=sd(s*e,t),f=sd(-r*e,t);let c=ze(e-a*n-f*i,t),u=ze(-a*r-f*s,t);const d=c>o,h=u>o;if(d&&(c=t-c),h&&(u=t-u),c>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:c,k2neg:h,k2:u}}}},Ar),Object.freeze({1:0n,2:1n,3:2n,4:3n,5:4n,6:5n,7:6n,8:7n,9:8n,A:9n,B:10n,C:11n,D:12n,E:13n,F:14n,G:15n,H:16n,J:17n,K:18n,L:19n,M:20n,N:21n,P:22n,Q:23n,R:24n,S:25n,T:26n,U:27n,V:28n,W:29n,X:30n,Y:31n,Z:32n,a:33n,b:34n,c:35n,d:36n,e:37n,f:38n,g:39n,h:40n,i:41n,j:42n,k:43n,m:44n,n:45n,o:46n,p:47n,q:48n,r:49n,s:50n,t:51n,u:52n,v:53n,w:54n,x:55n,y:56n,z:57n}),Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[t,e.charCodeAt(0)]),{...Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((e,t)=>[e.charCodeAt(0),t]))},Zt.slice();const j3=BigInt(0),As=BigInt(1),od=BigInt(2),Tr=BigInt(3);function k3(e){const t=[];for(;e>As;e>>=As)(e&As)===j3?t.unshift(0):(e&Tr)===Tr?(t.unshift(-1),e+=As):t.unshift(1);return t}function z3(e){const{Fp:t,Fr:n,Fp2:r,Fp6:i,Fp12:s}=e.fields,o=e.params.xNegative,a=e.params.twistType,f=ja({n:n.ORDER,...e.G1}),c=Object.assign(f,nd(f.ProjectivePoint,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),u=ja({n:n.ORDER,...e.G2}),d=Object.assign(u,nd(u.ProjectivePoint,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));let h;if(a==="multiplicative")h=($,j,N,k,M,G)=>s.mul014(k,$,r.mul(j,M),r.mul(N,G));else if(a==="divisive")h=($,j,N,k,M,G)=>s.mul034(k,r.mul(N,G),r.mul(j,M),$);else throw new Error("bls: unknown twist type");const l=r.div(r.ONE,r.mul(r.ONE,od));function b($,j,N,k){const M=r.sqr(N),G=r.sqr(k),V=r.mulByB(r.mul(G,Tr)),K=r.mul(V,Tr),J=r.sub(r.sub(r.sqr(r.add(N,k)),G),M),ee=r.sub(V,M),re=r.mul(r.sqr(j),Tr),he=r.neg(J);return $.push([ee,re,he]),j=r.mul(r.mul(r.mul(r.sub(M,K),j),N),l),N=r.sub(r.sqr(r.mul(r.add(M,K),l)),r.mul(r.sqr(V),Tr)),k=r.mul(M,J),{Rx:j,Ry:N,Rz:k}}function y($,j,N,k,M,G){const V=r.sub(N,r.mul(G,k)),K=r.sub(j,r.mul(M,k)),J=r.sub(r.mul(V,M),r.mul(K,G)),ee=r.neg(V),re=K;$.push([J,ee,re]);const he=r.sqr(K),de=r.mul(he,K),hn=r.mul(he,j),mo=r.add(r.sub(de,r.mul(hn,od)),r.mul(r.sqr(V),k));return j=r.mul(K,mo),N=r.sub(r.mul(r.sub(hn,mo),V),r.mul(de,N)),k=r.mul(k,de),{Rx:j,Ry:N,Rz:k}}const E=k3(e.params.ateLoopSize),A=xa($=>{const j=$,{x:N,y:k}=j.toAffine(),M=N,G=k,V=r.neg(k);let K=M,J=G,ee=r.ONE;const re=[];for(const he of E){const de=[];({Rx:K,Ry:J,Rz:ee}=b(de,K,J,ee)),he&&({Rx:K,Ry:J,Rz:ee}=y(de,K,J,ee,M,he===-1?V:G)),re.push(de)}if(e.postPrecompute){const he=re[re.length-1];e.postPrecompute(K,J,ee,M,G,y.bind(null,he))}return re});function C($,j=!1){let N=s.ONE;if($.length){const k=$[0][0].length;for(let M=0;M<k;M++){N=s.sqr(N);for(const[G,V,K]of $)for(const[J,ee,re]of G[M])N=h(J,ee,re,N,V,K)}}return o&&(N=s.conjugate(N)),j?s.finalExponentiate(N):N}function x($,j=!0){const N=[];c.ProjectivePoint.normalizeZ($.map(({g1:k})=>k)),d.ProjectivePoint.normalizeZ($.map(({g2:k})=>k));for(const{g1:k,g2:M}of $){if(k.equals(c.ProjectivePoint.ZERO)||M.equals(d.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");k.assertValidity(),M.assertValidity();const G=k.toAffine();N.push([A(M),G.x,G.y])}return C(N,j)}function _($,j,N=!0){return x([{g1:$,g2:j}],N)}const R={randomPrivateKey:()=>{const $=Ra(n.ORDER);return Kh(e.randomBytes($),n.ORDER)},calcPairingPrecomputes:A},{ShortSignature:P}=e.G1,{Signature:U}=e.G2;function F($){return $ instanceof c.ProjectivePoint?$:c.ProjectivePoint.fromHex($)}function D($,j){return $ instanceof c.ProjectivePoint?$:c.hashToCurve(Ne("point",$),j)}function q($){return $ instanceof d.ProjectivePoint?$:U.fromHex($)}function z($,j){return $ instanceof d.ProjectivePoint?$:d.hashToCurve(Ne("point",$),j)}function v($){return c.ProjectivePoint.fromPrivateKey($).toRawBytes(!0)}function p($){return d.ProjectivePoint.fromPrivateKey($).toRawBytes(!0)}function w($,j,N){const k=z($,N);k.assertValidity();const M=k.multiply(c.normPrivateKeyToScalar(j));return $ instanceof d.ProjectivePoint?M:U.toRawBytes(M)}function g($,j,N){const k=D($,N);k.assertValidity();const M=k.multiply(c.normPrivateKeyToScalar(j));return $ instanceof c.ProjectivePoint?M:P.toRawBytes(M)}function m($,j,N,k){const M=F(N),G=z(j,k),V=c.ProjectivePoint.BASE,K=q($),J=x([{g1:M.negate(),g2:G},{g1:V,g2:K}]);return s.eql(J,s.ONE)}function S($,j,N,k){const M=q(N),G=D(j,k),V=d.ProjectivePoint.BASE,K=F($),J=x([{g1:G,g2:M},{g1:K,g2:V.negate()}]);return s.eql(J,s.ONE)}function O($){if(!Array.isArray($)||$.length===0)throw new Error("expected non-empty array")}function I($){O($);const N=$.map(F).reduce((k,M)=>k.add(M),c.ProjectivePoint.ZERO);return $[0]instanceof c.ProjectivePoint?(N.assertValidity(),N):N.toRawBytes(!0)}function B($){O($);const N=$.map(q).reduce((k,M)=>k.add(M),d.ProjectivePoint.ZERO);return $[0]instanceof d.ProjectivePoint?(N.assertValidity(),N):U.toRawBytes(N)}function T($){O($);const N=$.map(F).reduce((k,M)=>k.add(M),c.ProjectivePoint.ZERO);return $[0]instanceof c.ProjectivePoint?(N.assertValidity(),N):P.toRawBytes(N)}function L($,j,N,k){if(O(j),N.length!==j.length)throw new Error("amount of public keys and messages should be equal");const M=q($),G=j.map(ee=>z(ee,k)),V=N.map(F),K=new Map;for(let ee=0;ee<V.length;ee++){const re=V[ee],he=G[ee];let de=K.get(he);de===void 0&&(de=[],K.set(he,de)),de.push(re)}const J=[];try{for(const[ee,re]of K){const he=re.reduce((de,hn)=>de.add(hn));J.push({g1:he,g2:ee})}return J.push({g1:c.ProjectivePoint.BASE.negate(),g2:M}),s.eql(x(J),s.ONE)}catch{return!1}}return c.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:v,getPublicKeyForShortSignatures:p,sign:w,signShortSignature:g,verify:m,verifyBatch:L,verifyShortSignature:S,aggregatePublicKeys:I,aggregateSignatures:B,aggregateShortSignatures:T,millerLoopBatch:C,pairing:_,pairingBatch:x,G1:c,G2:d,Signature:U,ShortSignature:P,fields:{Fr:n,Fp:t,Fp2:r,Fp6:i,Fp12:s},params:{ateLoopSize:e.params.ateLoopSize,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:R}}const M3=BigInt(0),Rr=BigInt(1),Qt=BigInt(2),ad=BigInt(3);function Ma(e,t,n,r,i=1,s){const o=BigInt(s===void 0?r:s),a=n**BigInt(r),f=[];for(let c=0;c<i;c++){const u=BigInt(c+1),d=[];for(let h=0,l=Rr;h<r;h++){const b=(u*l-u)/o%a;d.push(e.pow(t,b)),l*=n}f.push(d)}return f}function q3(e,t,n){const r=t.pow(n,(e.ORDER-Rr)/ad),i=t.pow(n,(e.ORDER-Rr)/Qt);function s(h,l){const b=t.mul(t.frobeniusMap(h,1),r),y=t.mul(t.frobeniusMap(l,1),i);return[b,y]}const o=t.pow(n,(e.ORDER**Qt-Rr)/ad),a=t.pow(n,(e.ORDER**Qt-Rr)/Qt);if(!t.eql(a,t.neg(t.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function f(h,l){return[t.mul(h,o),t.neg(l)]}const c=h=>(l,b)=>{const y=b.toAffine(),E=h(y.x,y.y);return l.fromAffine({x:E[0],y:E[1]})},u=c(s),d=c(f);return{psi:s,psi2:f,G2psi:u,G2psi2:d,PSI_X:r,PSI_Y:i,PSI2_X:o,PSI2_Y:a}}function V3(e){const{ORDER:t}=e,n=_n(t),r=n.create(e.NONRESIDUE||BigInt(-1)),i=n.div(n.ONE,Qt),s=Ma(n,r,n.ORDER,2)[0],o=({c0:v,c1:p},{c0:w,c1:g})=>({c0:n.add(v,w),c1:n.add(p,g)}),a=({c0:v,c1:p},{c0:w,c1:g})=>({c0:n.sub(v,w),c1:n.sub(p,g)}),f=({c0:v,c1:p},w)=>{if(typeof w=="bigint")return{c0:n.mul(v,w),c1:n.mul(p,w)};const{c0:g,c1:m}=w;let S=n.mul(v,g),O=n.mul(p,m);const I=n.sub(S,O),B=n.sub(n.mul(n.add(v,p),n.add(g,m)),n.add(S,O));return{c0:I,c1:B}},c=({c0:v,c1:p})=>{const w=n.add(v,p),g=n.sub(v,p),m=n.add(v,v);return{c0:n.mul(w,g),c1:n.mul(m,p)}},u=v=>{if(v.length!==2)throw new Error("invalid tuple");const p=v.map(w=>n.create(w));return{c0:p[0],c1:p[1]}},d=t*t,h=u(e.FP2_NONRESIDUE),l={ORDER:d,isLE:n.isLE,NONRESIDUE:h,BITS:li(d),BYTES:Math.ceil(li(d)/8),MASK:Jn(li(d)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:v=>v,isValid:({c0:v,c1:p})=>typeof v=="bigint"&&typeof p=="bigint",is0:({c0:v,c1:p})=>n.is0(v)&&n.is0(p),eql:({c0:v,c1:p},{c0:w,c1:g})=>n.eql(v,w)&&n.eql(p,g),neg:({c0:v,c1:p})=>({c0:n.neg(v),c1:n.neg(p)}),pow:(v,p)=>Os(l,v,p),invertBatch:v=>er(l,v),add:o,sub:a,mul:f,sqr:c,addN:o,subN:a,mulN:f,sqrN:c,div:(v,p)=>l.mul(v,typeof p=="bigint"?n.inv(n.create(p)):l.inv(p)),inv:({c0:v,c1:p})=>{const w=n.inv(n.create(v*v+p*p));return{c0:n.mul(w,n.create(v)),c1:n.mul(w,n.create(-p))}},sqrt:v=>{if(e.Fp2sqrt)return e.Fp2sqrt(v);const{c0:p,c1:w}=v;if(n.is0(w))return Is(n,p)===1?l.create({c0:n.sqrt(p),c1:n.ZERO}):l.create({c0:n.ZERO,c1:n.sqrt(n.div(p,r))});const g=n.sqrt(n.sub(n.sqr(p),n.mul(n.sqr(w),r)));let m=n.mul(n.add(g,p),i);Is(n,m)===-1&&(m=n.sub(m,g));const O=n.sqrt(m),I=l.create({c0:O,c1:n.div(n.mul(w,i),O)});if(!l.eql(l.sqr(I),v))throw new Error("Cannot find square root");const B=I,T=l.neg(B),{re:L,im:$}=l.reim(B),{re:j,im:N}=l.reim(T);return $>N||$===N&&L>j?B:T},isOdd:v=>{const{re:p,im:w}=l.reim(v),g=p%Qt,m=p===M3,S=w%Qt;return BigInt(g||m&&S)==Rr},fromBytes(v){if(v.length!==l.BYTES)throw new Error("fromBytes invalid length="+v.length);return{c0:n.fromBytes(v.subarray(0,n.BYTES)),c1:n.fromBytes(v.subarray(n.BYTES))}},toBytes:({c0:v,c1:p})=>be(n.toBytes(v),n.toBytes(p)),cmov:({c0:v,c1:p},{c0:w,c1:g},m)=>({c0:n.cmov(v,w,m),c1:n.cmov(p,g,m)}),reim:({c0:v,c1:p})=>({re:v,im:p}),mulByNonresidue:({c0:v,c1:p})=>l.mul({c0:v,c1:p},h),mulByB:e.Fp2mulByB,fromBigTuple:u,frobeniusMap:({c0:v,c1:p},w)=>({c0:v,c1:n.mul(p,s[w%2])})},b=({c0:v,c1:p,c2:w},{c0:g,c1:m,c2:S})=>({c0:l.add(v,g),c1:l.add(p,m),c2:l.add(w,S)}),y=({c0:v,c1:p,c2:w},{c0:g,c1:m,c2:S})=>({c0:l.sub(v,g),c1:l.sub(p,m),c2:l.sub(w,S)}),E=({c0:v,c1:p,c2:w},g)=>{if(typeof g=="bigint")return{c0:l.mul(v,g),c1:l.mul(p,g),c2:l.mul(w,g)};const{c0:m,c1:S,c2:O}=g,I=l.mul(v,m),B=l.mul(p,S),T=l.mul(w,O);return{c0:l.add(I,l.mulByNonresidue(l.sub(l.mul(l.add(p,w),l.add(S,O)),l.add(B,T)))),c1:l.add(l.sub(l.mul(l.add(v,p),l.add(m,S)),l.add(I,B)),l.mulByNonresidue(T)),c2:l.sub(l.add(B,l.mul(l.add(v,w),l.add(m,O))),l.add(I,T))}},A=({c0:v,c1:p,c2:w})=>{let g=l.sqr(v),m=l.mul(l.mul(v,p),Qt),S=l.mul(l.mul(p,w),Qt),O=l.sqr(w);return{c0:l.add(l.mulByNonresidue(S),g),c1:l.add(l.mulByNonresidue(O),m),c2:l.sub(l.sub(l.add(l.add(m,l.sqr(l.add(l.sub(v,p),w))),S),g),O)}},[C,x]=Ma(l,h,n.ORDER,6,2,3),_={ORDER:l.ORDER,isLE:l.isLE,BITS:3*l.BITS,BYTES:3*l.BYTES,MASK:Jn(3*l.BITS),ZERO:{c0:l.ZERO,c1:l.ZERO,c2:l.ZERO},ONE:{c0:l.ONE,c1:l.ZERO,c2:l.ZERO},create:v=>v,isValid:({c0:v,c1:p,c2:w})=>l.isValid(v)&&l.isValid(p)&&l.isValid(w),is0:({c0:v,c1:p,c2:w})=>l.is0(v)&&l.is0(p)&&l.is0(w),neg:({c0:v,c1:p,c2:w})=>({c0:l.neg(v),c1:l.neg(p),c2:l.neg(w)}),eql:({c0:v,c1:p,c2:w},{c0:g,c1:m,c2:S})=>l.eql(v,g)&&l.eql(p,m)&&l.eql(w,S),sqrt:Th,div:(v,p)=>_.mul(v,typeof p=="bigint"?n.inv(n.create(p)):_.inv(p)),pow:(v,p)=>Os(_,v,p),invertBatch:v=>er(_,v),add:b,sub:y,mul:E,sqr:A,addN:b,subN:y,mulN:E,sqrN:A,inv:({c0:v,c1:p,c2:w})=>{let g=l.sub(l.sqr(v),l.mulByNonresidue(l.mul(w,p))),m=l.sub(l.mulByNonresidue(l.sqr(w)),l.mul(v,p)),S=l.sub(l.sqr(p),l.mul(v,w)),O=l.inv(l.add(l.mulByNonresidue(l.add(l.mul(w,m),l.mul(p,S))),l.mul(v,g)));return{c0:l.mul(O,g),c1:l.mul(O,m),c2:l.mul(O,S)}},fromBytes:v=>{if(v.length!==_.BYTES)throw new Error("fromBytes invalid length="+v.length);return{c0:l.fromBytes(v.subarray(0,l.BYTES)),c1:l.fromBytes(v.subarray(l.BYTES,2*l.BYTES)),c2:l.fromBytes(v.subarray(2*l.BYTES))}},toBytes:({c0:v,c1:p,c2:w})=>be(l.toBytes(v),l.toBytes(p),l.toBytes(w)),cmov:({c0:v,c1:p,c2:w},{c0:g,c1:m,c2:S},O)=>({c0:l.cmov(v,g,O),c1:l.cmov(p,m,O),c2:l.cmov(w,S,O)}),fromBigSix:v=>{if(!Array.isArray(v)||v.length!==6)throw new Error("invalid Fp6 usage");return{c0:l.fromBigTuple(v.slice(0,2)),c1:l.fromBigTuple(v.slice(2,4)),c2:l.fromBigTuple(v.slice(4,6))}},frobeniusMap:({c0:v,c1:p,c2:w},g)=>({c0:l.frobeniusMap(v,g),c1:l.mul(l.frobeniusMap(p,g),C[g%6]),c2:l.mul(l.frobeniusMap(w,g),x[g%6])}),mulByFp2:({c0:v,c1:p,c2:w},g)=>({c0:l.mul(v,g),c1:l.mul(p,g),c2:l.mul(w,g)}),mulByNonresidue:({c0:v,c1:p,c2:w})=>({c0:l.mulByNonresidue(w),c1:v,c2:p}),mul1:({c0:v,c1:p,c2:w},g)=>({c0:l.mulByNonresidue(l.mul(w,g)),c1:l.mul(v,g),c2:l.mul(p,g)}),mul01({c0:v,c1:p,c2:w},g,m){let S=l.mul(v,g),O=l.mul(p,m);return{c0:l.add(l.mulByNonresidue(l.sub(l.mul(l.add(p,w),m),O)),S),c1:l.sub(l.sub(l.mul(l.add(g,m),l.add(v,p)),S),O),c2:l.add(l.sub(l.mul(l.add(v,w),g),S),O)}}},R=Ma(l,h,n.ORDER,12,1,6)[0],P=({c0:v,c1:p},{c0:w,c1:g})=>({c0:_.add(v,w),c1:_.add(p,g)}),U=({c0:v,c1:p},{c0:w,c1:g})=>({c0:_.sub(v,w),c1:_.sub(p,g)}),F=({c0:v,c1:p},w)=>{if(typeof w=="bigint")return{c0:_.mul(v,w),c1:_.mul(p,w)};let{c0:g,c1:m}=w,S=_.mul(v,g),O=_.mul(p,m);return{c0:_.add(S,_.mulByNonresidue(O)),c1:_.sub(_.mul(_.add(v,p),_.add(g,m)),_.add(S,O))}},D=({c0:v,c1:p})=>{let w=_.mul(v,p);return{c0:_.sub(_.sub(_.mul(_.add(_.mulByNonresidue(p),v),_.add(v,p)),w),_.mulByNonresidue(w)),c1:_.add(w,w)}};function q(v,p){const w=l.sqr(v),g=l.sqr(p);return{first:l.add(l.mulByNonresidue(g),w),second:l.sub(l.sub(l.sqr(l.add(v,p)),w),g)}}const z={ORDER:l.ORDER,isLE:_.isLE,BITS:2*_.BITS,BYTES:2*_.BYTES,MASK:Jn(2*_.BITS),ZERO:{c0:_.ZERO,c1:_.ZERO},ONE:{c0:_.ONE,c1:_.ZERO},create:v=>v,isValid:({c0:v,c1:p})=>_.isValid(v)&&_.isValid(p),is0:({c0:v,c1:p})=>_.is0(v)&&_.is0(p),neg:({c0:v,c1:p})=>({c0:_.neg(v),c1:_.neg(p)}),eql:({c0:v,c1:p},{c0:w,c1:g})=>_.eql(v,w)&&_.eql(p,g),sqrt:Th,inv:({c0:v,c1:p})=>{let w=_.inv(_.sub(_.sqr(v),_.mulByNonresidue(_.sqr(p))));return{c0:_.mul(v,w),c1:_.neg(_.mul(p,w))}},div:(v,p)=>z.mul(v,typeof p=="bigint"?n.inv(n.create(p)):z.inv(p)),pow:(v,p)=>Os(z,v,p),invertBatch:v=>er(z,v),add:P,sub:U,mul:F,sqr:D,addN:P,subN:U,mulN:F,sqrN:D,fromBytes:v=>{if(v.length!==z.BYTES)throw new Error("fromBytes invalid length="+v.length);return{c0:_.fromBytes(v.subarray(0,_.BYTES)),c1:_.fromBytes(v.subarray(_.BYTES))}},toBytes:({c0:v,c1:p})=>be(_.toBytes(v),_.toBytes(p)),cmov:({c0:v,c1:p},{c0:w,c1:g},m)=>({c0:_.cmov(v,w,m),c1:_.cmov(p,g,m)}),fromBigTwelve:v=>({c0:_.fromBigSix(v.slice(0,6)),c1:_.fromBigSix(v.slice(6,12))}),frobeniusMap(v,p){const{c0:w,c1:g,c2:m}=_.frobeniusMap(v.c1,p),S=R[p%12];return{c0:_.frobeniusMap(v.c0,p),c1:_.create({c0:l.mul(w,S),c1:l.mul(g,S),c2:l.mul(m,S)})}},mulByFp2:({c0:v,c1:p},w)=>({c0:_.mulByFp2(v,w),c1:_.mulByFp2(p,w)}),conjugate:({c0:v,c1:p})=>({c0:v,c1:_.neg(p)}),mul014:({c0:v,c1:p},w,g,m)=>{let S=_.mul01(v,w,g),O=_.mul1(p,m);return{c0:_.add(_.mulByNonresidue(O),S),c1:_.sub(_.sub(_.mul01(_.add(p,v),w,l.add(g,m)),S),O)}},mul034:({c0:v,c1:p},w,g,m)=>{const S=_.create({c0:l.mul(v.c0,w),c1:l.mul(v.c1,w),c2:l.mul(v.c2,w)}),O=_.mul01(p,g,m),I=_.mul01(_.add(v,p),l.add(w,g),m);return{c0:_.add(_.mulByNonresidue(O),S),c1:_.sub(I,_.add(S,O))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:n,Fp2:l,Fp6:_,Fp4Square:q,Fp12:z}}const Me=BigInt(0),Ds=BigInt(1),xe=BigInt(2),Ts=BigInt(3),bi=BigInt(4),On=BigInt("0xd201000000010000"),H3=li(On),{Fp:Y,Fp2:X,Fp6:qa,Fp4Square:Va,Fp12:te}=V3({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[Ds,Ds],Fp2mulByB:({c0:e,c1:t})=>{const n=Y.mul(e,bi),r=Y.mul(t,bi);return{c0:Y.sub(n,r),c1:Y.add(n,r)}},Fp12cyclotomicSquare:({c0:e,c1:t})=>{const{c0:n,c1:r,c2:i}=e,{c0:s,c1:o,c2:a}=t,{first:f,second:c}=Va(n,o),{first:u,second:d}=Va(s,i),{first:h,second:l}=Va(r,a),b=X.mulByNonresidue(l);return{c0:qa.create({c0:X.add(X.mul(X.sub(f,n),xe),f),c1:X.add(X.mul(X.sub(u,r),xe),u),c2:X.add(X.mul(X.sub(h,i),xe),h)}),c1:qa.create({c0:X.add(X.mul(X.add(b,s),xe),b),c1:X.add(X.mul(X.add(c,o),xe),c),c2:X.add(X.mul(X.add(d,a),xe),d)})}},Fp12cyclotomicExp(e,t){let n=te.ONE;for(let r=H3-1;r>=0;r--)n=te._cyclotomicSquare(n),FE(t,r)&&(n=te.mul(n,e));return n},Fp12finalExponentiate:e=>{const t=On,n=te.div(te.frobeniusMap(e,6),e),r=te.mul(te.frobeniusMap(n,2),n),i=te.conjugate(te._cyclotomicExp(r,t)),s=te.mul(te.conjugate(te._cyclotomicSquare(r)),i),o=te.conjugate(te._cyclotomicExp(s,t)),a=te.conjugate(te._cyclotomicExp(o,t)),f=te.mul(te.conjugate(te._cyclotomicExp(a,t)),te._cyclotomicSquare(i)),c=te.conjugate(te._cyclotomicExp(f,t)),u=te.frobeniusMap(te.mul(i,a),2),d=te.frobeniusMap(te.mul(o,r),3),h=te.frobeniusMap(te.mul(f,te.conjugate(r)),1),l=te.mul(te.mul(c,te.conjugate(s)),r);return te.mul(te.mul(te.mul(u,d),h),l)}}),cd=_n(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),K3=td(X,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(e=>e.map(t=>X.fromBigTuple(t.map(BigInt))))),G3=td(Y,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),Z3=Qh(X,{A:X.create({c0:Y.create(Me),c1:Y.create(BigInt(240))}),B:X.create({c0:Y.create(BigInt(1012)),c1:Y.create(BigInt(1012))}),Z:X.create({c0:Y.create(BigInt(-2)),c1:Y.create(BigInt(-1))})}),Y3=Qh(Y,{A:Y.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:Y.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:Y.create(BigInt(11))}),{G2psi:fd,G2psi2:W3}=q3(Y,X,X.div(X.ONE,X.NONRESIDUE)),Ha=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:Y.ORDER,m:2,k:128,expand:"xmd",hash:Ar}),Rs=pi(Y.toBytes(Me),{infinity:!0,compressed:!0});function Ns(e){e=e.slice();const t=e[0]&224,n=!!(t>>7&1),r=!!(t>>6&1),i=!!(t>>5&1);return e[0]&=31,{compressed:n,infinity:r,sort:i,value:e}}function pi(e,t){if(e[0]&224)throw new Error("setMask: non-empty mask");return t.compressed&&(e[0]|=128),t.infinity&&(e[0]|=64),t.sort&&(e[0]|=32),e}function ud(e){e.assertValidity();const t=e.equals(xt.G1.ProjectivePoint.ZERO),{x:n,y:r}=e.toAffine();if(t)return Rs.slice();const i=Y.ORDER,s=!!(r*xe/i);return pi(we(n,Y.BYTES),{compressed:!0,sort:s})}function ld(e){e.assertValidity();const t=Y.BYTES;if(e.equals(xt.G2.ProjectivePoint.ZERO))return be(Rs,we(Me,t));const{x:n,y:r}=e.toAffine(),{re:i,im:s}=X.reim(n),{re:o,im:a}=X.reim(r),c=!!((a>Me?a*xe:o*xe)/Y.ORDER&Ds),u=i;return be(pi(we(s,t),{sort:c,compressed:!0}),we(u,t))}const xt=z3({fields:{Fp:Y,Fp2:X,Fp6:qa,Fp12:te,Fr:cd},G1:{Fp:Y,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:Y.ZERO,b:bi,htfDefaults:{...Ha,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new e(Y.mul(t.px,n),t.py,t.pz);return t.multiplyUnsafe(On).negate().multiplyUnsafe(On).equals(r)},clearCofactor:(e,t)=>t.multiplyUnsafe(On).add(t),mapToCurve:e=>{const{x:t,y:n}=Y3(Y.create(e[0]));return G3(t,n)},fromBytes:e=>{const{compressed:t,infinity:n,sort:r,value:i}=Ns(e);if(i.length===48&&t){const s=Y.ORDER,o=je(i),a=Y.create(o&Y.MASK);if(n){if(a!==Me)throw new Error("G1: non-empty compressed point at infinity");return{x:Me,y:Me}}const f=Y.add(Y.pow(a,Ts),Y.create(xt.params.G1b));let c=Y.sqrt(f);if(!c)throw new Error("invalid compressed G1 point");return c*xe/s!==BigInt(r)&&(c=Y.neg(c)),{x:Y.create(a),y:Y.create(c)}}else if(i.length===96&&!t){const s=je(i.subarray(0,Y.BYTES)),o=je(i.subarray(Y.BYTES));if(n){if(s!==Me||o!==Me)throw new Error("G1: non-empty point at infinity");return xt.G1.ProjectivePoint.ZERO.toAffine()}return{x:Y.create(s),y:Y.create(o)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(e,t,n)=>{const r=t.equals(e.ZERO),{x:i,y:s}=t.toAffine();if(n){if(r)return Rs.slice();const o=Y.ORDER,a=!!(s*xe/o);return pi(we(i,Y.BYTES),{compressed:!0,sort:a})}else return r?be(new Uint8Array([64]),new Uint8Array(2*Y.BYTES-1)):be(we(i,Y.BYTES),we(s,Y.BYTES))},ShortSignature:{fromHex(e){const{infinity:t,sort:n,value:r}=Ns(Ne("signatureHex",e,48)),i=Y.ORDER,s=je(r);if(t)return xt.G1.ProjectivePoint.ZERO;const o=Y.create(s&Y.MASK),a=Y.add(Y.pow(o,Ts),Y.create(xt.params.G1b));let f=Y.sqrt(a);if(!f)throw new Error("invalid compressed G1 point");const c=BigInt(n);f*xe/i!==c&&(f=Y.neg(f));const u=xt.G1.ProjectivePoint.fromAffine({x:o,y:f});return u.assertValidity(),u},toRawBytes(e){return ud(e)},toHex(e){return Xn(ud(e))}}},G2:{Fp:X,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:X.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:X.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:X.ZERO,b:X.fromBigTuple([bi,bi]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Ha},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:e=>{const{x:t,y:n}=Z3(X.fromBigTuple(e));return K3(t,n)},isTorsionFree:(e,t)=>t.multiplyUnsafe(On).negate().equals(fd(e,t)),clearCofactor:(e,t)=>{const n=On;let r=t.multiplyUnsafe(n).negate(),i=fd(e,t),s=t.double();return s=W3(e,s),s=s.subtract(i),i=r.add(i),i=i.multiplyUnsafe(n).negate(),s=s.add(i),s=s.subtract(r),s.subtract(t)},fromBytes:e=>{const{compressed:t,infinity:n,sort:r,value:i}=Ns(e);if(!t&&!n&&r||!t&&n&&r||r&&n&&t)throw new Error("invalid encoding flag: "+(e[0]&224));const s=Y.BYTES,o=(a,f,c)=>je(a.slice(f,c));if(i.length===96&&t){const a=xt.params.G2b,f=Y.ORDER;if(n){if(i.reduce((y,E)=>y!==0?E+1:E,0)>0)throw new Error("invalid compressed G2 point");return{x:X.ZERO,y:X.ZERO}}const c=o(i,0,s),u=o(i,s,2*s),d=X.create({c0:Y.create(u),c1:Y.create(c)}),h=X.add(X.pow(d,Ts),a);let l=X.sqrt(h);const b=l.c1===Me?l.c0*xe/f:l.c1*xe/f?Ds:Me;return l=r&&b>0?l:X.neg(l),{x:d,y:l}}else if(i.length===192&&!t){if(n){if(i.reduce((d,h)=>d!==0?h+1:h,0)>0)throw new Error("invalid uncompressed G2 point");return{x:X.ZERO,y:X.ZERO}}const a=o(i,0,s),f=o(i,s,2*s),c=o(i,2*s,3*s),u=o(i,3*s,4*s);return{x:X.fromBigTuple([f,a]),y:X.fromBigTuple([u,c])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(e,t,n)=>{const{BYTES:r,ORDER:i}=Y,s=t.equals(e.ZERO),{x:o,y:a}=t.toAffine();if(n){if(s)return be(Rs,we(Me,r));const f=!!(a.c1===Me?a.c0*xe/i:a.c1*xe/i);return be(pi(we(o.c1,r),{compressed:!0,sort:f}),we(o.c0,r))}else{if(s)return be(new Uint8Array([64]),new Uint8Array(4*r-1));const{re:f,im:c}=X.reim(o),{re:u,im:d}=X.reim(a);return be(we(c,r),we(f,r),we(d,r),we(u,r))}},Signature:{fromHex(e){const{infinity:t,sort:n,value:r}=Ns(Ne("signatureHex",e)),i=Y.ORDER,s=r.length/2;if(s!==48&&s!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const o=je(r.slice(0,s)),a=je(r.slice(s));if(t)return xt.G2.ProjectivePoint.ZERO;const f=Y.create(o&Y.MASK),c=Y.create(a),u=X.create({c0:c,c1:f}),d=X.add(X.pow(u,Ts),xt.params.G2b);let h=X.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:l,im:b}=X.reim(h),y=BigInt(n),E=b>Me&&b*xe/i!==y,A=b===Me&&l*xe/i!==y;(E||A)&&(h=X.neg(h));const C=xt.G2.ProjectivePoint.fromAffine({x:u,y:h});return C.assertValidity(),C},toRawBytes(e){return ld(e)},toHex(e){return Xn(ld(e))}}},params:{ateLoopSize:On,r:cd.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:Ha,hash:Ar,randomBytes:ys});BigInt(0),BigInt(1),BigInt(2),BigInt(8),BigInt(0),BigInt(1),BigInt(2),BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),BigInt(0),BigInt(1),BigInt(2),BigInt(3),BigInt(5),BigInt(8);const Ka=BigInt(0),Ga=BigInt(1);function Cs(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function tr(e,t,n=""){const r=ds(e),i=e?.length,s=t!==void 0;if(!r||s&&i!==t){const o=n&&`"${n}" `,a=s?` of length ${t}`:"",f=r?`length=${i}`:`type=${typeof e}`;throw new Error(o+"expected Uint8Array"+a+", got "+f)}return e}function $s(e){const t=e.toString(16);return t.length&1?"0"+t:t}function hd(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ka:BigInt("0x"+e)}function Ps(e){return hd(Or(e))}function dd(e){return Ht(e),hd(Or(Uint8Array.from(e).reverse()))}function Za(e,t){return gs(e.toString(16).padStart(t*2,"0"))}function gd(e,t){return Za(e,t).reverse()}function We(e,t,n){let r;if(typeof t=="string")try{r=gs(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(ds(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}const Ya=e=>typeof e=="bigint"&&Ka<=e;function X3(e,t,n){return Ya(e)&&Ya(t)&&Ya(n)&&t<=e&&e<n}function J3(e,t,n,r){if(!X3(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function bd(e){let t;for(t=0;e>Ka;e>>=Ga,t+=1);return t}const yi=e=>(Ga<<BigInt(e))-Ga;function Q3(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=l=>new Uint8Array(l),i=l=>Uint8Array.of(l);let s=r(e),o=r(e),a=0;const f=()=>{s.fill(1),o.fill(0),a=0},c=(...l)=>n(o,s,...l),u=(l=r(0))=>{o=c(i(0),l),s=c(),l.length!==0&&(o=c(i(1),l),s=c())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const b=[];for(;l<t;){s=c();const y=s.slice();b.push(y),l+=s.length}return Gt(...b)};return(l,b)=>{f(),u(l);let y;for(;!(y=b(d()));)u();return f(),y}}function Wa(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(i,s,o){const a=e[i];if(o&&a===void 0)return;const f=typeof a;if(f!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${f}`)}Object.entries(t).forEach(([i,s])=>r(i,s,!1)),Object.entries(n).forEach(([i,s])=>r(i,s,!0))}function pd(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}const Xe=BigInt(0),qe=BigInt(1),nr=BigInt(2),yd=BigInt(3),md=BigInt(4),wd=BigInt(5),e8=BigInt(7),vd=BigInt(8),t8=BigInt(9),Ed=BigInt(16);function St(e,t){const n=e%t;return n>=Xe?n:t+n}function bt(e,t,n){let r=e;for(;t-- >Xe;)r*=r,r%=n;return r}function _d(e,t){if(e===Xe)throw new Error("invert: expected non-zero number");if(t<=Xe)throw new Error("invert: expected positive modulus, got "+t);let n=St(e,t),r=t,i=Xe,s=qe;for(;n!==Xe;){const a=r/n,f=r%n,c=i-s*a;r=n,n=f,i=s,s=c}if(r!==qe)throw new Error("invert: does not exist");return St(i,t)}function Xa(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function xd(e,t){const n=(e.ORDER+qe)/md,r=e.pow(t,n);return Xa(e,r,t),r}function n8(e,t){const n=(e.ORDER-wd)/vd,r=e.mul(t,nr),i=e.pow(r,n),s=e.mul(t,i),o=e.mul(e.mul(s,nr),i),a=e.mul(s,e.sub(o,e.ONE));return Xa(e,a,t),a}function r8(e){const t=mi(e),n=Sd(e),r=n(t,t.neg(t.ONE)),i=n(t,r),s=n(t,t.neg(r)),o=(e+e8)/Ed;return(a,f)=>{let c=a.pow(f,o),u=a.mul(c,r);const d=a.mul(c,i),h=a.mul(c,s),l=a.eql(a.sqr(u),f),b=a.eql(a.sqr(d),f);c=a.cmov(c,u,l),u=a.cmov(h,d,b);const y=a.eql(a.sqr(u),f),E=a.cmov(c,u,y);return Xa(a,E,f),E}}function Sd(e){if(e<yd)throw new Error("sqrt is not defined for small field");let t=e-qe,n=0;for(;t%nr===Xe;)t/=nr,n++;let r=nr;const i=mi(e);for(;Id(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return xd;let s=i.pow(r,t);const o=(t+qe)/nr;return function(f,c){if(f.is0(c))return c;if(Id(f,c)!==1)throw new Error("Cannot find square root");let u=n,d=f.mul(f.ONE,s),h=f.pow(c,t),l=f.pow(c,o);for(;!f.eql(h,f.ONE);){if(f.is0(h))return f.ZERO;let b=1,y=f.sqr(h);for(;!f.eql(y,f.ONE);)if(b++,y=f.sqr(y),b===u)throw new Error("Cannot find square root");const E=qe<<BigInt(u-b-1),A=f.pow(d,E);u=b,d=f.sqr(A),h=f.mul(h,d),l=f.mul(l,A)}return l}}function i8(e){return e%md===yd?xd:e%vd===wd?n8:e%Ed===t8?r8(e):Sd(e)}const s8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function o8(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=s8.reduce((r,i)=>(r[i]="function",r),t);return Wa(e,n),e}function a8(e,t,n){if(n<Xe)throw new Error("invalid exponent, negatives unsupported");if(n===Xe)return e.ONE;if(n===qe)return t;let r=e.ONE,i=t;for(;n>Xe;)n&qe&&(r=e.mul(r,i)),i=e.sqr(i),n>>=qe;return r}function Od(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((o,a,f)=>e.is0(a)?o:(r[f]=o,e.mul(o,a)),e.ONE),s=e.inv(i);return t.reduceRight((o,a,f)=>e.is0(a)?o:(r[f]=e.mul(o,r[f]),e.mul(o,a)),s),r}function Id(e,t){const n=(e.ORDER-qe)/nr,r=e.pow(t,n),i=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function Bd(e,t){t!==void 0&&xr(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function mi(e,t,n=!1,r={}){if(e<=Xe)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,s,o=!1,a;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const h=t;h.BITS&&(i=h.BITS),h.sqrt&&(s=h.sqrt),typeof h.isLE=="boolean"&&(n=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof t=="number"&&(i=t),r.sqrt&&(s=r.sqrt);const{nBitLength:f,nByteLength:c}=Bd(e,i);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:e,isLE:n,BITS:f,BYTES:c,MASK:yi(f),ZERO:Xe,ONE:qe,allowedLengths:a,create:h=>St(h,e),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return Xe<=h&&h<e},is0:h=>h===Xe,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&qe)===qe,neg:h=>St(-h,e),eql:(h,l)=>h===l,sqr:h=>St(h*h,e),add:(h,l)=>St(h+l,e),sub:(h,l)=>St(h-l,e),mul:(h,l)=>St(h*l,e),pow:(h,l)=>a8(d,h,l),div:(h,l)=>St(h*_d(l,e),e),sqrN:h=>h*h,addN:(h,l)=>h+l,subN:(h,l)=>h-l,mulN:(h,l)=>h*l,inv:h=>_d(h,e),sqrt:s||(h=>(u||(u=i8(e)),u(d,h))),toBytes:h=>n?gd(h,c):Za(h,c),fromBytes:(h,l=!0)=>{if(a){if(!a.includes(h.length)||h.length>c)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const y=new Uint8Array(c);y.set(h,n?0:y.length-h.length),h=y}if(h.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+h.length);let b=n?dd(h):Ps(h);if(o&&(b=St(b,e)),!l&&!d.isValid(b))throw new Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:h=>Od(d,h),cmov:(h,l,b)=>b?l:h});return Object.freeze(d)}function Ad(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Dd(e){const t=Ad(e);return t+Math.ceil(t/2)}function c8(e,t,n=!1){const r=e.length,i=Ad(t),s=Dd(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=n?dd(e):Ps(e),a=St(o,t-qe)+qe;return n?gd(a,i):Za(a,i)}const Nr=BigInt(0),rr=BigInt(1);function Ls(e,t){const n=t.negate();return e?n:t}function Ja(e,t){const n=Od(e.Fp,t.map(r=>r.Z));return t.map((r,i)=>e.fromAffine(r.toAffine(n[i])))}function Td(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Qa(e,t){Td(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,s=yi(e),o=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function Rd(e,t,n){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=n;let a=Number(e&i),f=e>>o;a>r&&(a-=s,f+=rr);const c=t*r,u=c+Math.abs(a)-1,d=a===0,h=a<0,l=t%2!==0;return{nextN:f,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:c}}function f8(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function u8(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const ec=new WeakMap,Nd=new WeakMap;function tc(e){return Nd.get(e)||1}function Cd(e){if(e!==Nr)throw new Error("invalid wNAF")}class l8{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let i=t;for(;n>Nr;)n&rr&&(r=r.add(i)),i=i.double(),n>>=rr;return r}precomputeWindow(t,n){const{windows:r,windowSize:i}=Qa(n,this.bits),s=[];let o=t,a=o;for(let f=0;f<r;f++){a=o,s.push(a);for(let c=1;c<i;c++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE;const o=Qa(t,this.bits);for(let a=0;a<o.windows;a++){const{nextN:f,offset:c,isZero:u,isNeg:d,isNegF:h,offsetF:l}=Rd(r,a,o);r=f,u?s=s.add(Ls(h,n[l])):i=i.add(Ls(d,n[c]))}return Cd(r),{p:i,f:s}}wNAFUnsafe(t,n,r,i=this.ZERO){const s=Qa(t,this.bits);for(let o=0;o<s.windows&&r!==Nr;o++){const{nextN:a,offset:f,isZero:c,isNeg:u}=Rd(r,o,s);if(r=a,!c){const d=n[f];i=i.add(u?d.negate():d)}}return Cd(r),i}getPrecomputes(t,n,r){let i=ec.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(i=r(i)),ec.set(n,i))),i}cached(t,n,r){const i=tc(t);return this.wNAF(i,this.getPrecomputes(i,t,r),n)}unsafe(t,n,r,i){const s=tc(t);return s===1?this._unsafeLadder(t,n,i):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,i)}createCache(t,n){Td(n,this.bits),Nd.set(t,n),ec.delete(t)}hasCache(t){return tc(t)!==1}}function h8(e,t,n,r){let i=t,s=e.ZERO,o=e.ZERO;for(;n>Nr||r>Nr;)n&rr&&(s=s.add(i)),r&rr&&(o=o.add(i)),i=i.double(),n>>=rr,r>>=rr;return{p1:s,p2:o}}function d8(e,t,n,r){f8(n,e),u8(r,t);const i=n.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=bd(BigInt(i));let f=1;a>12?f=a-3:a>4?f=a-2:a>0&&(f=2);const c=yi(f),u=new Array(Number(c)+1).fill(o),d=Math.floor((t.BITS-1)/f)*f;let h=o;for(let l=d;l>=0;l-=f){u.fill(o);for(let y=0;y<s;y++){const E=r[y],A=Number(E>>BigInt(l)&c);u[A]=u[A].add(n[y])}let b=o;for(let y=u.length-1,E=o;y>0;y--)E=E.add(u[y]),b=b.add(E);if(h=h.add(b),l!==0)for(let y=0;y<f;y++)h=h.double()}return h}function $d(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return o8(t),t}else return mi(e,{isLE:n})}function g8(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const c=t[f];if(!(typeof c=="bigint"&&c>Nr))throw new Error(`CURVE.${f} must be positive bigint`)}const i=$d(t.p,n.Fp,r),s=$d(t.n,n.Fn,r),a=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(const f of a)if(!i.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:i,Fn:s}}const Pd=(e,t)=>(e+(e>=0?t:-t)/Ld)/t;function b8(e,t,n){const[[r,i],[s,o]]=t,a=Pd(o*e,n),f=Pd(-i*e,n);let c=e-a*r-f*s,u=-a*i-f*o;const d=c<tn,h=u<tn;d&&(c=-c),h&&(u=-u);const l=yi(Math.ceil(bd(n)/2))+Cr;if(c<tn||c>=l||u<tn||u>=l)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:d,k1:c,k2neg:h,k2:u}}function nc(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function rc(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return Cs(n.lowS,"lowS"),Cs(n.prehash,"prehash"),n.format!==void 0&&nc(n.format),n}class p8 extends Error{constructor(t=""){super(t)}}const en={Err:p8,_tlv:{encode:(e,t)=>{const{Err:n}=en;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=$s(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?$s(i.length/2|128):"";return $s(e)+s+i+t},decode(e,t){const{Err:n}=en;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const f=i&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+f);if(c.length!==f)throw new n("tlv.decode: length bytes not complete");if(c[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of c)o=o<<8|u;if(r+=f,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=en;if(e<tn)throw new t("integer: negative integers are not allowed");let n=$s(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=en;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ps(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=en,i=We("signature",e),{v:s,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:f}=r.decode(2,s),{v:c,l:u}=r.decode(2,f);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=en,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),s=r+i;return t.encode(48,s)}},tn=BigInt(0),Cr=BigInt(1),Ld=BigInt(2),Us=BigInt(3),y8=BigInt(4);function $r(e,t){const{BYTES:n}=e;let r;if(typeof t=="bigint")r=t;else{let i=We("private key",t);try{r=e.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function m8(e,t={}){const n=g8("weierstrass",e,t),{Fp:r,Fn:i}=n;let s=n.CURVE;const{h:o,n:a}=s;Wa(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!r.is0(s.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const c=Fd(r,i);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(v,p,w){const{x:g,y:m}=p.toAffine(),S=r.toBytes(g);if(Cs(w,"isCompressed"),w){u();const O=!r.isOdd(m);return Gt(Ud(O),S)}else return Gt(Uint8Array.of(4),S,r.toBytes(m))}function h(v){tr(v,void 0,"Point");const{publicKey:p,publicKeyUncompressed:w}=c,g=v.length,m=v[0],S=v.subarray(1);if(g===p&&(m===2||m===3)){const O=r.fromBytes(S);if(!r.isValid(O))throw new Error("bad point: is not on curve, wrong x");const I=y(O);let B;try{B=r.sqrt(I)}catch($){const j=$ instanceof Error?": "+$.message:"";throw new Error("bad point: is not on curve, sqrt error"+j)}u();const T=r.isOdd(B);return(m&1)===1!==T&&(B=r.neg(B)),{x:O,y:B}}else if(g===w&&m===4){const O=r.BYTES,I=r.fromBytes(S.subarray(0,O)),B=r.fromBytes(S.subarray(O,O*2));if(!E(I,B))throw new Error("bad point: is not on curve");return{x:I,y:B}}else throw new Error(`bad point: got length ${g}, expected compressed=${p} or uncompressed=${w}`)}const l=t.toBytes||d,b=t.fromBytes||h;function y(v){const p=r.sqr(v),w=r.mul(p,v);return r.add(r.add(w,r.mul(v,s.a)),s.b)}function E(v,p){const w=r.sqr(p),g=y(v);return r.eql(w,g)}if(!E(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const A=r.mul(r.pow(s.a,Us),y8),C=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(A,C)))throw new Error("bad curve params: a or b");function x(v,p,w=!1){if(!r.isValid(p)||w&&r.is0(p))throw new Error(`bad point coordinate ${v}`);return p}function _(v){if(!(v instanceof D))throw new Error("ProjectivePoint expected")}function R(v){if(!f||!f.basises)throw new Error("no endo");return b8(v,f.basises,i.ORDER)}const P=pd((v,p)=>{const{X:w,Y:g,Z:m}=v;if(r.eql(m,r.ONE))return{x:w,y:g};const S=v.is0();p==null&&(p=S?r.ONE:r.inv(m));const O=r.mul(w,p),I=r.mul(g,p),B=r.mul(m,p);if(S)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:O,y:I}}),U=pd(v=>{if(v.is0()){if(t.allowInfinityPoint&&!r.is0(v.Y))return;throw new Error("bad point: ZERO")}const{x:p,y:w}=v.toAffine();if(!r.isValid(p)||!r.isValid(w))throw new Error("bad point: x or y not field elements");if(!E(p,w))throw new Error("bad point: equation left != right");if(!v.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function F(v,p,w,g,m){return w=new D(r.mul(w.X,v),w.Y,w.Z),p=Ls(g,p),w=Ls(m,w),p.add(w)}class D{constructor(p,w,g){this.X=x("x",p),this.Y=x("y",w,!0),this.Z=x("z",g),Object.freeze(this)}static CURVE(){return s}static fromAffine(p){const{x:w,y:g}=p||{};if(!p||!r.isValid(w)||!r.isValid(g))throw new Error("invalid affine point");if(p instanceof D)throw new Error("projective point not allowed");return r.is0(w)&&r.is0(g)?D.ZERO:new D(w,g,r.ONE)}static fromBytes(p){const w=D.fromAffine(b(tr(p,void 0,"point")));return w.assertValidity(),w}static fromHex(p){return D.fromBytes(We("pointHex",p))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,w=!0){return z.createCache(this,p),w||this.multiply(Us),this}assertValidity(){U(this)}hasEvenY(){const{y:p}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(p)}equals(p){_(p);const{X:w,Y:g,Z:m}=this,{X:S,Y:O,Z:I}=p,B=r.eql(r.mul(w,I),r.mul(S,m)),T=r.eql(r.mul(g,I),r.mul(O,m));return B&&T}negate(){return new D(this.X,r.neg(this.Y),this.Z)}double(){const{a:p,b:w}=s,g=r.mul(w,Us),{X:m,Y:S,Z:O}=this;let I=r.ZERO,B=r.ZERO,T=r.ZERO,L=r.mul(m,m),$=r.mul(S,S),j=r.mul(O,O),N=r.mul(m,S);return N=r.add(N,N),T=r.mul(m,O),T=r.add(T,T),I=r.mul(p,T),B=r.mul(g,j),B=r.add(I,B),I=r.sub($,B),B=r.add($,B),B=r.mul(I,B),I=r.mul(N,I),T=r.mul(g,T),j=r.mul(p,j),N=r.sub(L,j),N=r.mul(p,N),N=r.add(N,T),T=r.add(L,L),L=r.add(T,L),L=r.add(L,j),L=r.mul(L,N),B=r.add(B,L),j=r.mul(S,O),j=r.add(j,j),L=r.mul(j,N),I=r.sub(I,L),T=r.mul(j,$),T=r.add(T,T),T=r.add(T,T),new D(I,B,T)}add(p){_(p);const{X:w,Y:g,Z:m}=this,{X:S,Y:O,Z:I}=p;let B=r.ZERO,T=r.ZERO,L=r.ZERO;const $=s.a,j=r.mul(s.b,Us);let N=r.mul(w,S),k=r.mul(g,O),M=r.mul(m,I),G=r.add(w,g),V=r.add(S,O);G=r.mul(G,V),V=r.add(N,k),G=r.sub(G,V),V=r.add(w,m);let K=r.add(S,I);return V=r.mul(V,K),K=r.add(N,M),V=r.sub(V,K),K=r.add(g,m),B=r.add(O,I),K=r.mul(K,B),B=r.add(k,M),K=r.sub(K,B),L=r.mul($,V),B=r.mul(j,M),L=r.add(B,L),B=r.sub(k,L),L=r.add(k,L),T=r.mul(B,L),k=r.add(N,N),k=r.add(k,N),M=r.mul($,M),V=r.mul(j,V),k=r.add(k,M),M=r.sub(N,M),M=r.mul($,M),V=r.add(V,M),N=r.mul(k,V),T=r.add(T,N),N=r.mul(K,V),B=r.mul(G,B),B=r.sub(B,N),N=r.mul(G,k),L=r.mul(K,L),L=r.add(L,N),new D(B,T,L)}subtract(p){return this.add(p.negate())}is0(){return this.equals(D.ZERO)}multiply(p){const{endo:w}=t;if(!i.isValidNot0(p))throw new Error("invalid scalar: out of range");let g,m;const S=O=>z.cached(this,O,I=>Ja(D,I));if(w){const{k1neg:O,k1:I,k2neg:B,k2:T}=R(p),{p:L,f:$}=S(I),{p:j,f:N}=S(T);m=$.add(N),g=F(w.beta,L,j,O,B)}else{const{p:O,f:I}=S(p);g=O,m=I}return Ja(D,[g,m])[0]}multiplyUnsafe(p){const{endo:w}=t,g=this;if(!i.isValid(p))throw new Error("invalid scalar: out of range");if(p===tn||g.is0())return D.ZERO;if(p===Cr)return g;if(z.hasCache(this))return this.multiply(p);if(w){const{k1neg:m,k1:S,k2neg:O,k2:I}=R(p),{p1:B,p2:T}=h8(D,g,S,I);return F(w.beta,B,T,m,O)}else return z.unsafe(g,p)}multiplyAndAddUnsafe(p,w,g){const m=this.multiplyUnsafe(w).add(p.multiplyUnsafe(g));return m.is0()?void 0:m}toAffine(p){return P(this,p)}isTorsionFree(){const{isTorsionFree:p}=t;return o===Cr?!0:p?p(D,this):z.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:p}=t;return o===Cr?this:p?p(D,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(p=!0){return Cs(p,"isCompressed"),this.assertValidity(),l(D,this,p)}toHex(p=!0){return Or(this.toBytes(p))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(p=!0){return this.toBytes(p)}_setWindowSize(p){this.precompute(p)}static normalizeZ(p){return Ja(D,p)}static msm(p,w){return d8(D,i,p,w)}static fromPrivateKey(p){return D.BASE.multiply($r(i,p))}}D.BASE=new D(s.Gx,s.Gy,r.ONE),D.ZERO=new D(r.ZERO,r.ONE,r.ZERO),D.Fp=r,D.Fn=i;const q=i.BITS,z=new l8(D,t.endo?Math.ceil(q/2):q);return D.BASE.precompute(8),D}function Ud(e){return Uint8Array.of(e?2:3)}function Fd(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function w8(e,t={}){const{Fn:n}=e,r=t.randomBytes||ys,i=Object.assign(Fd(e.Fp,n),{seed:Dd(n.ORDER)});function s(l){try{return!!$r(n,l)}catch{return!1}}function o(l,b){const{publicKey:y,publicKeyUncompressed:E}=i;try{const A=l.length;return b===!0&&A!==y||b===!1&&A!==E?!1:!!e.fromBytes(l)}catch{return!1}}function a(l=r(i.seed)){return c8(tr(l,i.seed,"seed"),n.ORDER)}function f(l,b=!0){return e.BASE.multiply($r(n,l)).toBytes(b)}function c(l){const b=a(l);return{secretKey:b,publicKey:f(b)}}function u(l){if(typeof l=="bigint")return!1;if(l instanceof e)return!0;const{secretKey:b,publicKey:y,publicKeyUncompressed:E}=i;if(n.allowedLengths||b===y)return;const A=We("key",l).length;return A===y||A===E}function d(l,b,y=!0){if(u(l)===!0)throw new Error("first arg must be private key");if(u(b)===!1)throw new Error("second arg must be public key");const E=$r(n,l);return e.fromHex(b).multiply(E).toBytes(y)}return Object.freeze({getPublicKey:f,getSharedSecret:d,keygen:c,Point:e,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:l=>$r(n,l),precompute(l=8,b=e.BASE){return b.precompute(l,!1)}},lengths:i})}function v8(e,t,n={}){oh(t),Wa(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||ys,i=n.hmac||((w,...g)=>Da(t,w,Gt(...g))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:f}=o,{keygen:c,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l}=w8(e,n),b={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},y="compact";function E(w){const g=a>>Cr;return w>g}function A(w,g){if(!o.isValidNot0(g))throw new Error(`invalid signature ${w}: out of range 1..Point.Fn.ORDER`);return g}function C(w,g){nc(g);const m=l.signature,S=g==="compact"?m:g==="recovered"?m+1:void 0;return tr(w,S,`${g} signature`)}class x{constructor(g,m,S){this.r=A("r",g),this.s=A("s",m),S!=null&&(this.recovery=S),Object.freeze(this)}static fromBytes(g,m=y){C(g,m);let S;if(m==="der"){const{r:T,s:L}=en.toSig(tr(g));return new x(T,L)}m==="recovered"&&(S=g[0],m="compact",g=g.subarray(1));const O=o.BYTES,I=g.subarray(0,O),B=g.subarray(O,O*2);return new x(o.fromBytes(I),o.fromBytes(B),S)}static fromHex(g,m){return this.fromBytes(gs(g),m)}addRecoveryBit(g){return new x(this.r,this.s,g)}recoverPublicKey(g){const m=s.ORDER,{r:S,s:O,recovery:I}=this;if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");if(a*Ld<m&&I>1)throw new Error("recovery id is ambiguous for h>1 curve");const T=I===2||I===3?S+a:S;if(!s.isValid(T))throw new Error("recovery id 2 or 3 invalid");const L=s.toBytes(T),$=e.fromBytes(Gt(Ud((I&1)===0),L)),j=o.inv(T),N=R(We("msgHash",g)),k=o.create(-N*j),M=o.create(O*j),G=e.BASE.multiplyUnsafe(k).add($.multiplyUnsafe(M));if(G.is0())throw new Error("point at infinify");return G.assertValidity(),G}hasHighS(){return E(this.s)}toBytes(g=y){if(nc(g),g==="der")return gs(en.hexFromSig(this));const m=o.toBytes(this.r),S=o.toBytes(this.s);if(g==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Gt(Uint8Array.of(this.recovery),m,S)}return Gt(m,S)}toHex(g){return Or(this.toBytes(g))}assertValidity(){}static fromCompact(g){return x.fromBytes(We("sig",g),"compact")}static fromDER(g){return x.fromBytes(We("sig",g),"der")}normalizeS(){return this.hasHighS()?new x(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Or(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Or(this.toBytes("compact"))}}const _=n.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const m=Ps(g),S=g.length*8-f;return S>0?m>>BigInt(S):m},R=n.bits2int_modN||function(g){return o.create(_(g))},P=yi(f);function U(w){return J3("num < 2^"+f,w,tn,P),o.toBytes(w)}function F(w,g){return tr(w,void 0,"message"),g?tr(t(w),void 0,"prehashed message"):w}function D(w,g,m){if(["recovered","canonical"].some(k=>k in m))throw new Error("sign() legacy options not supported");const{lowS:S,prehash:O,extraEntropy:I}=rc(m,b);w=F(w,O);const B=R(w),T=$r(o,g),L=[U(T),U(B)];if(I!=null&&I!==!1){const k=I===!0?r(l.secretKey):I;L.push(We("extraEntropy",k))}const $=Gt(...L),j=B;function N(k){const M=_(k);if(!o.isValidNot0(M))return;const G=o.inv(M),V=e.BASE.multiply(M).toAffine(),K=o.create(V.x);if(K===tn)return;const J=o.create(G*o.create(j+K*T));if(J===tn)return;let ee=(V.x===K?0:2)|Number(V.y&Cr),re=J;return S&&E(J)&&(re=o.neg(J),ee^=1),new x(K,re,ee)}return{seed:$,k2sig:N}}function q(w,g,m={}){w=We("message",w);const{seed:S,k2sig:O}=D(w,g,m);return Q3(t.outputLen,o.BYTES,i)(S,O)}function z(w){let g;const m=typeof w=="string"||ds(w),S=!m&&w!==null&&typeof w=="object"&&typeof w.r=="bigint"&&typeof w.s=="bigint";if(!m&&!S)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(S)g=new x(w.r,w.s);else if(m){try{g=x.fromBytes(We("sig",w),"der")}catch(O){if(!(O instanceof en.Err))throw O}if(!g)try{g=x.fromBytes(We("sig",w),"compact")}catch{return!1}}return g||!1}function v(w,g,m,S={}){const{lowS:O,prehash:I,format:B}=rc(S,b);if(m=We("publicKey",m),g=F(We("message",g),I),"strict"in S)throw new Error("options.strict was renamed to lowS");const T=B===void 0?z(w):x.fromBytes(We("sig",w),B);if(T===!1)return!1;try{const L=e.fromBytes(m);if(O&&T.hasHighS())return!1;const{r:$,s:j}=T,N=R(g),k=o.inv(j),M=o.create(N*k),G=o.create($*k),V=e.BASE.multiplyUnsafe(M).add(L.multiplyUnsafe(G));return V.is0()?!1:o.create(V.x)===$}catch{return!1}}function p(w,g,m={}){const{prehash:S}=rc(m,b);return g=F(g,S),x.fromBytes(w,"recovered").recoverPublicKey(g).toBytes()}return Object.freeze({keygen:c,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l,Point:e,sign:q,verify:v,recoverPublicKey:p,Signature:x,hash:t})}function E8(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const i=mi(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),s={Fp:n,Fn:i,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function _8(e){const{CURVE:t,curveOpts:n}=E8(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}function x8(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,Bd(n.Fn.ORDER,n.Fn.BITS))})}function S8(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:i}=_8(e),s=m8(t,n),o=v8(s,r,i);return x8(e,o)}function O8(e,t){const n=r=>S8({...e,hash:r});return{...n(t),create:n}}ba("HashToScalar-");const ic={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},I8={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},jd=BigInt(2);function B8(e){const t=ic.p,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),f=BigInt(88),c=e*e*e%t,u=c*c*e%t,d=bt(u,n,t)*u%t,h=bt(d,n,t)*u%t,l=bt(h,jd,t)*c%t,b=bt(l,i,t)*l%t,y=bt(b,s,t)*b%t,E=bt(y,a,t)*y%t,A=bt(E,f,t)*E%t,C=bt(A,a,t)*y%t,x=bt(C,n,t)*u%t,_=bt(x,o,t)*b%t,R=bt(_,r,t)*c%t,P=bt(R,jd,t);if(!sc.eql(sc.sqr(P),e))throw new Error("Cannot find square root");return P}const sc=mi(ic.p,{sqrt:B8});O8({...ic,Fp:sc,lowS:!0,endo:I8},Ar);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Pr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function oc(e,...t){if(!Pr(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function kd(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function ac(e){if(typeof e!="function")throw new Error("function expected");return!0}function In(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Lr(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Fs(e){if(!Array.isArray(e))throw new Error("array expected")}function js(e,t){if(!kd(!0,t))throw new Error(`${e}: array of strings expected`)}function cc(e,t){if(!kd(!1,t))throw new Error(`${e}: array of numbers expected`)}function Je(...e){const t=s=>s,n=(s,o)=>a=>s(o(a)),r=e.map(s=>s.encode).reduceRight(n,t),i=e.map(s=>s.decode).reduce(n,t);return{encode:r,decode:i}}function at(e){const t=typeof e=="string"?e.split(""):e,n=t.length;js("alphabet",t);const r=new Map(t.map((i,s)=>[i,s]));return{encode:i=>(Fs(i),i.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${e}`);return t[s]})),decode:i=>(Fs(i),i.map(s=>{In("alphabet.decode",s);const o=r.get(s);if(o===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${e}`);return o}))}}function ct(e=""){return In("join",e),{encode:t=>(js("join.decode",t),t.join(e)),decode:t=>(In("join.decode",t),t.split(e))}}function ks(e,t="="){return Lr(e),In("padding",t),{encode(n){for(js("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){js("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function zd(e){return ac(e),{encode:t=>t,decode:t=>e(t)}}function Md(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(Fs(e),!e.length)return[];let r=0;const i=[],s=Array.from(e,a=>{if(Lr(a),a<0||a>=t)throw new Error(`invalid integer: ${a}`);return a}),o=s.length;for(;;){let a=0,f=!0;for(let c=r;c<o;c++){const u=s[c],d=t*a,h=d+u;if(!Number.isSafeInteger(h)||d/t!==a||h-u!==d)throw new Error("convertRadix: carry overflow");const l=h/n;a=h%n;const b=Math.floor(l);if(s[c]=b,!Number.isSafeInteger(b)||b*n+a!==h)throw new Error("convertRadix: carry overflow");if(f)b?f=!1:r=c;else continue}if(i.push(a),f)break}for(let a=0;a<e.length-1&&e[a]===0;a++)i.push(0);return i.reverse()}const qd=(e,t)=>t===0?e:qd(t,e%t),zs=(e,t)=>e+(t-qd(e,t)),Ms=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function fc(e,t,n,r){if(Fs(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(zs(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${zs(t,n)}`);let i=0,s=0;const o=Ms[t],a=Ms[n]-1,f=[];for(const c of e){if(Lr(c),c>=o)throw new Error(`convertRadix2: invalid data word=${c} from=${t}`);if(i=i<<t|c,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)f.push((i>>s-n&a)>>>0);const u=Ms[s];if(u===void 0)throw new Error("invalid carry");i&=u-1}if(i=i<<n-s&a,!r&&s>=t)throw new Error("Excess padding");if(!r&&i>0)throw new Error(`Non-zero padding: ${i}`);return r&&s>0&&f.push(i>>>0),f}function A8(e){Lr(e);const t=2**8;return{encode:n=>{if(!Pr(n))throw new Error("radix.encode input should be Uint8Array");return Md(Array.from(n),t,e)},decode:n=>(cc("radix.decode",n),Uint8Array.from(Md(n,e,t)))}}function pt(e,t=!1){if(Lr(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(zs(8,e)>32||zs(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Pr(n))throw new Error("radix2.encode input should be Uint8Array");return fc(Array.from(n),8,e,!t)},decode:n=>(cc("radix2.decode",n),Uint8Array.from(fc(n,e,8,t)))}}function Vd(e){return ac(e),function(...t){try{return e.apply(null,t)}catch{}}}function D8(e,t){return Lr(e),ac(t),{encode(n){if(!Pr(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),i=new Uint8Array(n.length+e);return i.set(n),i.set(r,n.length),i},decode(n){if(!Pr(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),i=n.slice(-e),s=t(r).slice(0,e);for(let o=0;o<e;o++)if(s[o]!==i[o])throw new Error("Invalid checksum");return r}}}const Hd=typeof Uint8Array.from([]).toBase64=="function"&&typeof Uint8Array.fromBase64=="function",Kd=(e,t)=>{In("base64",e);const n=t?/^[A-Za-z0-9=_-]+$/:/^[A-Za-z0-9=+/]+$/,r=t?"base64url":"base64";if(e.length>0&&!n.test(e))throw new Error("invalid base64");return Uint8Array.fromBase64(e,{alphabet:r,lastChunkHandling:"strict"})},uc=e=>Je(A8(58),at(e),ct("")),T8=uc("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),R8=e=>Je(D8(4,t=>e(e(t))),T8),lc=Je(at("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),ct("")),Gd=[996825010,642813549,513874426,1027748829,705979059];function wi(e){const t=e>>25;let n=(e&33554431)<<5;for(let r=0;r<Gd.length;r++)(t>>r&1)===1&&(n^=Gd[r]);return n}function Zd(e,t,n=1){const r=e.length;let i=1;for(let s=0;s<r;s++){const o=e.charCodeAt(s);if(o<33||o>126)throw new Error(`Invalid prefix (${e})`);i=wi(i)^o>>5}i=wi(i);for(let s=0;s<r;s++)i=wi(i)^e.charCodeAt(s)&31;for(let s of t)i=wi(i)^s;for(let s=0;s<6;s++)i=wi(i);return i^=n,lc.encode(fc([i%Ms[30]],30,5,!1))}function Yd(e){const t=e==="bech32"?1:734539939,n=pt(5),r=n.decode,i=n.encode,s=Vd(r);function o(d,h,l=90){In("bech32.encode prefix",d),Pr(h)&&(h=Array.from(h)),cc("bech32.encode",h);const b=d.length;if(b===0)throw new TypeError(`Invalid prefix length ${b}`);const y=b+7+h.length;if(l!==!1&&y>l)throw new TypeError(`Length ${y} exceeds limit ${l}`);const E=d.toLowerCase(),A=Zd(E,h,t);return`${E}1${lc.encode(h)}${A}`}function a(d,h=90){In("bech32.decode input",d);const l=d.length;if(l<8||h!==!1&&l>h)throw new TypeError(`invalid string length: ${l} (${d}). Expected (8..${h})`);const b=d.toLowerCase();if(d!==b&&d!==d.toUpperCase())throw new Error("String must be lowercase or uppercase");const y=b.lastIndexOf("1");if(y===0||y===-1)throw new Error('Letter "1" must be present between prefix and data only');const E=b.slice(0,y),A=b.slice(y+1);if(A.length<6)throw new Error("Data must be at least 6 characters long");const C=lc.decode(A).slice(0,-6),x=Zd(E,C,t);if(!A.endsWith(x))throw new Error(`Invalid checksum in ${d}: expected "${x}"`);return{prefix:E,words:C}}const f=Vd(a);function c(d){const{prefix:h,words:l}=a(d,!1);return{prefix:h,words:l,bytes:r(l)}}function u(d,h){return o(d,i(h))}return{encode:o,decode:a,encodeFromBytes:u,decodeToBytes:c,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:s,toWords:i}}const N8=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",C8={encode(e){return oc(e),e.toHex()},decode(e){return In("hex",e),Uint8Array.fromHex(e)}};R8(Ar),ba("Bitcoin seed");/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Wd(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function qs(e,...t){if(!Wd(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Vs(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Xd(e,t){qs(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function vi(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function hc(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function $8(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function P8(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Ei(e){if(typeof e=="string")e=P8(e);else if(Wd(e))e=Jd(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function Jd(e){return Uint8Array.from(e)}const nn=16,dc=new Uint8Array(16),Pt=vi(dc),L8=225,U8=(e,t,n,r)=>{const i=r&1;return{s3:n<<31|r>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^L8<<24&-(i&1)}},yt=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0;function F8(e){e.reverse();const t=e[15]&1;let n=0;for(let r=0;r<e.length;r++){const i=e[r];e[r]=i>>>1|n,n=(i&1)<<7}return e[0]^=-t&225,e}const j8=e=>e>64*1024?8:e>1024?4:2;class Qd{constructor(t,n){this.blockLen=nn,this.outputLen=nn,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=Ei(t),qs(t,16);const r=$8(t);let i=r.getUint32(0,!1),s=r.getUint32(4,!1),o=r.getUint32(8,!1),a=r.getUint32(12,!1);const f=[];for(let b=0;b<128;b++)f.push({s0:yt(i),s1:yt(s),s2:yt(o),s3:yt(a)}),{s0:i,s1:s,s2:o,s3:a}=U8(i,s,o,a);const c=j8(n||1024);if(![1,2,4,8].includes(c))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=c;const d=128/c,h=this.windowSize=2**c,l=[];for(let b=0;b<d;b++)for(let y=0;y<h;y++){let E=0,A=0,C=0,x=0;for(let _=0;_<c;_++){if(!(y>>>c-_-1&1))continue;const{s0:P,s1:U,s2:F,s3:D}=f[c*b+_];E^=P,A^=U,C^=F,x^=D}l.push({s0:E,s1:A,s2:C,s3:x})}this.t=l}_updateBlock(t,n,r,i){t^=this.s0,n^=this.s1,r^=this.s2,i^=this.s3;const{W:s,t:o,windowSize:a}=this;let f=0,c=0,u=0,d=0;const h=(1<<s)-1;let l=0;for(const b of[t,n,r,i])for(let y=0;y<4;y++){const E=b>>>8*y&255;for(let A=8/s-1;A>=0;A--){const C=E>>>s*A&h,{s0:x,s1:_,s2:R,s3:P}=o[l*a+C];f^=x,c^=_,u^=R,d^=P,l+=1}}this.s0=f,this.s1=c,this.s2=u,this.s3=d}update(t){Vs(this),t=Ei(t),qs(t);const n=vi(t),r=Math.floor(t.length/nn),i=t.length%nn;for(let s=0;s<r;s++)this._updateBlock(n[s*4+0],n[s*4+1],n[s*4+2],n[s*4+3]);return i&&(dc.set(t.subarray(r*nn)),this._updateBlock(Pt[0],Pt[1],Pt[2],Pt[3]),hc(Pt)),this}destroy(){const{t}=this;for(const n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(t){Vs(this),Xd(t,this),this.finished=!0;const{s0:n,s1:r,s2:i,s3:s}=this,o=vi(t);return o[0]=n,o[1]=r,o[2]=i,o[3]=s,t}digest(){const t=new Uint8Array(nn);return this.digestInto(t),this.destroy(),t}}class k8 extends Qd{constructor(t,n){t=Ei(t),qs(t);const r=F8(Jd(t));super(r,n),hc(r)}update(t){t=Ei(t),Vs(this);const n=vi(t),r=t.length%nn,i=Math.floor(t.length/nn);for(let s=0;s<i;s++)this._updateBlock(yt(n[s*4+3]),yt(n[s*4+2]),yt(n[s*4+1]),yt(n[s*4+0]));return r&&(dc.set(t.subarray(i*nn)),this._updateBlock(yt(Pt[3]),yt(Pt[2]),yt(Pt[1]),yt(Pt[0])),hc(Pt)),this}digestInto(t){Vs(this),Xd(t,this),this.finished=!0;const{s0:n,s1:r,s2:i,s3:s}=this,o=vi(t);return o[0]=n,o[1]=r,o[2]=i,o[3]=s,t.reverse()}}function e0(e){const t=(r,i)=>e(i,r.length).update(Ei(r)).digest(),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(r,i)=>e(r,i),t}e0((e,t)=>new Qd(e,t)),e0((e,t)=>new k8(e,t));const t0=_n(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),z8=t0.create(BigInt("-3")),M8=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b");Bs({a:z8,b:M8,Fp:t0,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Ar);const n0=_n(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),q8=n0.create(BigInt("-3")),V8=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef");Bs({a:q8,b:V8,Fp:n0,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},LE);const r0=_n(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),H8=r0.create(BigInt("-3")),K8=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00");Bs({a:H8,b:K8,Fp:r0,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},PE);var G8={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(f,c,u){this.fn=f,this.context=c,this.once=u||!1}function s(f,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var l=new i(u,d||f,h),b=n?n+c:c;return f._events[b]?f._events[b].fn?f._events[b]=[f._events[b],l]:f._events[b].push(l):(f._events[b]=l,f._eventsCount++),f}function o(f,c){--f._eventsCount===0?f._events=new r:delete f._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,l=d.length,b=new Array(l);h<l;h++)b[h]=d[h].fn;return b},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,l,b){var y=n?n+c:c;if(!this._events[y])return!1;var E=this._events[y],A=arguments.length,C,x;if(E.fn){switch(E.once&&this.removeListener(c,E.fn,void 0,!0),A){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,u),!0;case 3:return E.fn.call(E.context,u,d),!0;case 4:return E.fn.call(E.context,u,d,h),!0;case 5:return E.fn.call(E.context,u,d,h,l),!0;case 6:return E.fn.call(E.context,u,d,h,l,b),!0}for(x=1,C=new Array(A-1);x<A;x++)C[x-1]=arguments[x];E.fn.apply(E.context,C)}else{var _=E.length,R;for(x=0;x<_;x++)switch(E[x].once&&this.removeListener(c,E[x].fn,void 0,!0),A){case 1:E[x].fn.call(E[x].context);break;case 2:E[x].fn.call(E[x].context,u);break;case 3:E[x].fn.call(E[x].context,u,d);break;case 4:E[x].fn.call(E[x].context,u,d,h);break;default:if(!C)for(R=1,C=new Array(A-1);R<A;R++)C[R-1]=arguments[R];E[x].fn.apply(E[x].context,C)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var l=n?n+c:c;if(!this._events[l])return this;if(!u)return o(this,l),this;var b=this._events[l];if(b.fn)b.fn===u&&(!h||b.once)&&(!d||b.context===d)&&o(this,l);else{for(var y=0,E=[],A=b.length;y<A;y++)(b[y].fn!==u||h&&!b[y].once||d&&b[y].context!==d)&&E.push(b[y]);E.length?this._events[l]=E.length===1?E[0]:E:o(this,l)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(G8);function Z8(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let c=0;c<t.length;c++)t[c]=255;for(let c=0;c<e.length;c++){const u=e.charAt(c),d=u.charCodeAt(0);if(t[d]!==255)throw new TypeError(u+" is ambiguous");t[d]=c}const n=e.length,r=e.charAt(0),i=Math.log(n)/Math.log(256),s=Math.log(256)/Math.log(n);function o(c){if(c instanceof Uint8Array||(ArrayBuffer.isView(c)?c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength):Array.isArray(c)&&(c=Uint8Array.from(c))),!(c instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length===0)return"";let u=0,d=0,h=0;const l=c.length;for(;h!==l&&c[h]===0;)h++,u++;const b=(l-h)*s+1>>>0,y=new Uint8Array(b);for(;h!==l;){let C=c[h],x=0;for(let _=b-1;(C!==0||x<d)&&_!==-1;_--,x++)C+=256*y[_]>>>0,y[_]=C%n>>>0,C=C/n>>>0;if(C!==0)throw new Error("Non-zero carry");d=x,h++}let E=b-d;for(;E!==b&&y[E]===0;)E++;let A=r.repeat(u);for(;E<b;++E)A+=e.charAt(y[E]);return A}function a(c){if(typeof c!="string")throw new TypeError("Expected String");if(c.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;c[u]===r;)d++,u++;const l=(c.length-u)*i+1>>>0,b=new Uint8Array(l);for(;u<c.length;){const C=c.charCodeAt(u);if(C>255)return;let x=t[C];if(x===255)return;let _=0;for(let R=l-1;(x!==0||_<h)&&R!==-1;R--,_++)x+=n*b[R]>>>0,b[R]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");h=_,u++}let y=l-h;for(;y!==l&&b[y]===0;)y++;const E=new Uint8Array(d+(l-y));let A=d;for(;y!==l;)E[A++]=b[y++];return E}function f(c){const u=a(c);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:f}}var Y8="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";Z8(Y8);function _i(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const n=Zl(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return ua(n)}function Qe(e,t="utf8"){const n=Xl[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}const W8={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Lt={exports:{}};const i0=Zf;Lt.exports=rn;const xi=l6().console||{},X8={mapHttpRequest:Hs,mapHttpResponse:Hs,wrapRequestSerializer:mc,wrapResponseSerializer:mc,wrapErrorSerializer:mc,req:Hs,res:Hs,err:o0,errWithCause:o0};function Bn(e,t){return e==="silent"?1/0:t.levels.values[e]}const gc=Symbol("pino.logFuncs"),bc=Symbol("pino.hierarchy"),J8={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function s0(e,t){const n={logger:t,parent:e[bc]};t[bc]=n}function Q8(e,t,n){const r={};t.forEach(i=>{r[i]=n[i]?n[i]:xi[i]||xi[J8[i]||"log"]||Ur}),e[gc]=r}function e6(e,t){return Array.isArray(e)?e.filter(function(r){return r!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function rn(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const n=e.browser.write||xi;e.browser.write&&(e.browser.asObject=!0);const r=e.serializers||{},i=e6(e.browser.serialize,r);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=Object.keys(e.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof n=="function"&&a.forEach(function(y){n[y]=n}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");const f=e.level||"info",c=Object.create(n);c.log||(c.log=Ur),Q8(c,a,n),s0({},c),Object.defineProperty(c,"levelVal",{get:d}),Object.defineProperty(c,"level",{get:h,set:l});const u={transmit:t,serialize:i,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:a,timestamp:c6(e),messageKey:e.messageKey||"msg",onChild:e.onChild||Ur};c.levels=t6(e),c.level=f,c.isLevelEnabled=function(y){return this.levels.values[y]?this.levels.values[y]>=this.levels.values[this.level]:!1},c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Ur,c.serializers=r,c._serialize=i,c._stdErrSerialize=s,c.child=function(...y){return b.call(this,u,...y)},t&&(c._logEvent=yc());function d(){return Bn(this.level,this)}function h(){return this._level}function l(y){if(y!=="silent"&&!this.levels.values[y])throw Error("unknown level "+y);this._level=y,ir(this,u,c,"error"),ir(this,u,c,"fatal"),ir(this,u,c,"warn"),ir(this,u,c,"info"),ir(this,u,c,"debug"),ir(this,u,c,"trace"),o.forEach(E=>{ir(this,u,c,E)})}function b(y,E,A){if(!E)throw new Error("missing bindings for child Pino");A=A||{},i&&E.serializers&&(A.serializers=E.serializers);const C=A.serializers;if(i&&C){var x=Object.assign({},r,C),_=e.browser.serialize===!0?Object.keys(x):i;delete E.serializers,pc([E],_,x,this._stdErrSerialize)}function R(U){this._childLevel=(U._childLevel|0)+1,this.bindings=E,x&&(this.serializers=x,this._serialize=_),t&&(this._logEvent=yc([].concat(U._logEvent.bindings,E)))}R.prototype=this;const P=new R(this);return s0(this,P),P.child=function(...U){return b.call(this,y,...U)},P.level=A.level||this.level,y.onChild(P),P}return c}function t6(e){const t=e.customLevels||{},n=Object.assign({},rn.levels.values,t),r=Object.assign({},rn.levels.labels,n6(t));return{values:n,labels:r}}function n6(e){const t={};return Object.keys(e).forEach(function(n){t[e[n]]=n}),t}rn.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},rn.stdSerializers=X8,rn.stdTimeFunctions=Object.assign({},{nullTime:a0,epochTime:c0,unixTime:f6,isoTime:u6});function r6(e){const t=[];e.bindings&&t.push(e.bindings);let n=e[bc];for(;n.parent;)n=n.parent,n.logger.bindings&&t.push(n.logger.bindings);return t.reverse()}function ir(e,t,n,r){if(Object.defineProperty(e,r,{value:Bn(e.level,n)>Bn(r,n)?Ur:n[gc][r],writable:!0,enumerable:!0,configurable:!0}),e[r]===Ur){if(!t.transmit)return;const s=t.transmit.level||e.level,o=Bn(s,n);if(Bn(r,n)<o)return}e[r]=s6(e,t,n,r);const i=r6(e);i.length!==0&&(e[r]=i6(i,e[r]))}function i6(e,t){return function(){return t.apply(this,[...e,...arguments])}}function s6(e,t,n,r){return function(i){return function(){const o=t.timestamp(),a=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===xi?xi:this;for(var c=0;c<a.length;c++)a[c]=arguments[c];var u=!1;if(t.serialize&&(pc(a,this._serialize,this.serializers,this._stdErrSerialize),u=!0),t.asObject||t.formatters?i.call(f,...o6(this,r,a,o,t)):i.apply(f,a),t.transmit){const d=t.transmit.level||e._level,h=Bn(d,n),l=Bn(r,n);if(l<h)return;a6(this,{ts:o,methodLevel:r,methodValue:l,transmitLevel:d,transmitValue:n.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:Bn(e._level,n)},a,u)}}}(e[gc][r])}function o6(e,t,n,r,i){const{level:s,log:o=d=>d}=i.formatters||{},a=n.slice();let f=a[0];const c={};let u=(e._childLevel|0)+1;if(u<1&&(u=1),r&&(c.time=r),s){const d=s(t,e.levels.values[t]);Object.assign(c,d)}else c.level=e.levels.values[t];if(i.asObjectBindingsOnly){if(f!==null&&typeof f=="object")for(;u--&&typeof a[0]=="object";)Object.assign(c,a.shift());return[o(c),...a]}else{if(f!==null&&typeof f=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(c,a.shift());f=a.length?i0(a.shift(),a):void 0}else typeof f=="string"&&(f=i0(a.shift(),a));return f!==void 0&&(c[i.messageKey]=f),[o(c)]}}function pc(e,t,n,r){for(const i in e)if(r&&e[i]instanceof Error)e[i]=rn.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i])&&t)for(const s in e[i])t.indexOf(s)>-1&&s in n&&(e[i][s]=n[s](e[i][s]))}function a6(e,t,n,r=!1){const i=t.send,s=t.ts,o=t.methodLevel,a=t.methodValue,f=t.val,c=e._logEvent.bindings;r||pc(n,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=n.filter(function(u){return c.indexOf(u)===-1}),e._logEvent.level.label=o,e._logEvent.level.value=a,i(o,e._logEvent,f),e._logEvent=yc(c)}function yc(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function o0(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const n in e)t[n]===void 0&&(t[n]=e[n]);return t}function c6(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?a0:c0}function Hs(){return{}}function mc(e){return e}function Ur(){}function a0(){return!1}function c0(){return Date.now()}function f6(){return Math.round(Date.now()/1e3)}function u6(){return new Date(Date.now()).toISOString()}function l6(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}Lt.exports.default=rn,Lt.exports.pino=rn;const wc=1e3*1024;var h6=Object.defineProperty,d6=(e,t,n)=>t in e?h6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,An=(e,t,n)=>d6(e,typeof t!="symbol"?t+"":t,n);class g6{constructor(t){An(this,"nodeValue"),An(this,"sizeInBytes"),An(this,"next"),this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class f0{constructor(t){An(this,"lengthInNodes"),An(this,"sizeInBytes"),An(this,"head"),An(this,"tail"),An(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const n=new g6(t);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let n=this.head;for(;n!==null;)t.push(n.value),n=n.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const n=t.value;return t=t.next,{done:!1,value:n}}}}}var b6=Object.defineProperty,p6=(e,t,n)=>t in e?b6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ks=(e,t,n)=>p6(e,typeof t!="symbol"?t+"":t,n);class u0{constructor(t,n=wc){Ks(this,"logs"),Ks(this,"level"),Ks(this,"levelValue"),Ks(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=t??"error",this.levelValue=Lt.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new f0(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,n){n===Lt.exports.levels.values.error?console.error(t):n===Lt.exports.levels.values.warn?console.warn(t):n===Lt.exports.levels.values.debug?console.debug(t):n===Lt.exports.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(kt({timestamp:new Date().toISOString(),log:t}));const n=typeof t=="string"?JSON.parse(t).level:t.level;n>=this.levelValue&&this.forwardToConsole(t,n)}getLogs(){return this.logs}clearLogs(){this.logs=new f0(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const n=this.getLogArray();return n.push(kt({extraMetadata:t})),new Blob(n,{type:"application/json"})}}var y6=Object.defineProperty,m6=(e,t,n)=>t in e?y6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w6=(e,t,n)=>m6(e,typeof t!="symbol"?t+"":t,n);class v6{constructor(t,n=wc){w6(this,"baseChunkLogger"),this.baseChunkLogger=new u0(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const n=URL.createObjectURL(this.logsToBlob(t)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}}var E6=Object.defineProperty,_6=(e,t,n)=>t in e?E6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x6=(e,t,n)=>_6(e,typeof t!="symbol"?t+"":t,n);class S6{constructor(t,n=wc){x6(this,"baseChunkLogger"),this.baseChunkLogger=new u0(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}}var O6=Object.defineProperty,I6=Object.defineProperties,B6=Object.getOwnPropertyDescriptors,l0=Object.getOwnPropertySymbols,A6=Object.prototype.hasOwnProperty,D6=Object.prototype.propertyIsEnumerable,h0=(e,t,n)=>t in e?O6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vc=(e,t)=>{for(var n in t||(t={}))A6.call(t,n)&&h0(e,n,t[n]);if(l0)for(var n of l0(t))D6.call(t,n)&&h0(e,n,t[n]);return e},Ec=(e,t)=>I6(e,B6(t));function T6(e){var t,n;const r=new v6((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Lt.exports(Ec(vc({},e.opts),{level:"trace",browser:Ec(vc({},(n=e.opts)==null?void 0:n.browser),{write:i=>r.write(i)})})),chunkLoggerController:r}}function R6(e){var t;const n=new S6((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Lt.exports(Ec(vc({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}function N6(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?T6(e):R6(e)}var C6=Object.defineProperty,$6=Object.defineProperties,P6=Object.getOwnPropertyDescriptors,d0=Object.getOwnPropertySymbols,L6=Object.prototype.hasOwnProperty,U6=Object.prototype.propertyIsEnumerable,g0=(e,t,n)=>t in e?C6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Fr=(e,t)=>{for(var n in t||(t={}))L6.call(t,n)&&g0(e,n,t[n]);if(d0)for(var n of d0(t))U6.call(t,n)&&g0(e,n,t[n]);return e},Si=(e,t)=>$6(e,P6(t));const F6="ReactNative",Ot={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},j6="js";function Gs(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function sr(){return!Er()&&!!ha()&&navigator.product===F6}function k6(){return sr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function z6(){return sr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Oi(){return!Gs()&&!!ha()&&!!Er()}function Zs(){return sr()?Ot.reactNative:Gs()?Ot.node:Oi()?Ot.browser:Ot.unknown}function b0(){var e;try{return sr()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(e=global.Application)==null?void 0:e.applicationId:void 0}catch{return}}function M6(e,t){const n=new URLSearchParams(e);return Object.entries(t).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!=null&&n.set(r,String(i))}),n.toString()}function q6(){return rh()||{name:"",description:"",url:"",icons:[""]}}function V6(){if(Zs()===Ot.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const e=Uv();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function H6(){var e;const t=Zs();return t===Ot.browser?[t,((e=nh())==null?void 0:e.host)||"unknown"].join(":"):t}function p0(e,t,n){const r=V6(),i=H6();return[[e,t].join("-"),[j6,n].join("-"),r,i].join("/")}function K6({protocol:e,version:t,relayUrl:n,sdkVersion:r,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:f}){const c=n.split("?"),u=p0(e,t,r),d={auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:f||void 0,bundleId:a||void 0},h=M6(c[1]||"",d);return c[0]+"?"+h}function _c(e){return Object.fromEntries(e.entries())}function xc(e){return new Map(Object.entries(e))}function G6(e=W.FIVE_MINUTES,t){const n=W.toMiliseconds(e||W.FIVE_MINUTES);let r,i,s,o;return{resolve:a=>{s&&r&&(clearTimeout(s),r(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,f)=>{if(o)return a(o);s=setTimeout(()=>{const c=new Error(t);o=Promise.reject(c),f(c)},n),r=a,i=f})}}function Ut(e,t,n){return new Promise(async(r,i)=>{const s=setTimeout(()=>i(new Error(n)),t);try{const o=await e;r(o)}catch(o){i(o)}clearTimeout(s)})}function y0(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Z6(e){return y0("topic",e)}function Y6(e){return y0("id",e)}function W6(e){const[t,n]=e.split(":"),r={id:void 0,topic:void 0};if(t==="topic"&&typeof n=="string")r.topic=n;else if(t==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${n}`);return r}function Ii(e,t){return W.fromMiliseconds((t||Date.now())+W.toMiliseconds(e))}function m0(e){return Date.now()>=W.toMiliseconds(e)}function Sc(e,t){return`${e}${t?`:${t}`:""}`}function w0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function v0(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function E0(e){return Buffer.from(e,"base64").toString("utf-8")}function X6(e){return new Promise(t=>setTimeout(t,e))}const Ys=BigInt(2**32-1),_0=BigInt(32);function x0(e,t=!1){return t?{h:Number(e&Ys),l:Number(e>>_0&Ys)}:{h:Number(e>>_0&Ys)|0,l:Number(e&Ys)|0}}function S0(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let s=0;s<n;s++){const{h:o,l:a}=x0(e[s],t);[r[s],i[s]]=[o,a]}return[r,i]}const O0=(e,t,n)=>e>>>n,I0=(e,t,n)=>e<<32-n|t>>>n,Dn=(e,t,n)=>e>>>n|t<<32-n,Tn=(e,t,n)=>e<<32-n|t>>>n,Bi=(e,t,n)=>e<<64-n|t>>>n-32,Ai=(e,t,n)=>e>>>n-32|t<<64-n,J6=(e,t)=>t,Q6=(e,t)=>e,e_=(e,t,n)=>e<<n|t>>>32-n,t_=(e,t,n)=>t<<n|e>>>32-n,n_=(e,t,n)=>t<<n-32|e>>>64-n,r_=(e,t,n)=>e<<n-32|t>>>64-n;function It(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}const Oc=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Ic=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,i_=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),s_=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,o_=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),a_=(e,t,n,r,i,s)=>t+n+r+i+s+(e/2**32|0)|0,jr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Ws(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function sn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Bt(e,...t){if(!Ws(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Xs(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");sn(e.outputLen),sn(e.blockLen)}function Rn(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Bc(e,t){Bt(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Di(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function mt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Ac(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ft(e,t){return e<<32-t|e>>>t}const B0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function A0(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const on=B0?e=>e:e=>A0(e);function c_(e){for(let t=0;t<e.length;t++)e[t]=A0(e[t]);return e}const Nn=B0?e=>e:c_,D0=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",f_=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function kr(e){if(Bt(e),D0)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=f_[e[n]];return t}const an={_0:48,_9:57,A:65,F:70,a:97,f:102};function T0(e){if(e>=an._0&&e<=an._9)return e-an._0;if(e>=an.A&&e<=an.F)return e-(an.A-10);if(e>=an.a&&e<=an.f)return e-(an.a-10)}function Js(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(D0)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,s=0;i<n;i++,s+=2){const o=T0(e.charCodeAt(s)),a=T0(e.charCodeAt(s+1));if(o===void 0||a===void 0){const f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[i]=o*16+a}return r}function R0(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function At(e){return typeof e=="string"&&(e=R0(e)),Bt(e),e}function Cn(...e){let t=0;for(let r=0;r<e.length;r++){const i=e[r];Bt(i),t+=i.length}const n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}class Qs{}function Ti(e){const t=r=>e().update(At(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function u_(e){const t=(r,i)=>e(i).update(At(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function or(e=32){if(jr&&typeof jr.getRandomValues=="function")return jr.getRandomValues(new Uint8Array(e));if(jr&&typeof jr.randomBytes=="function")return Uint8Array.from(jr.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const l_=BigInt(0),Ri=BigInt(1),h_=BigInt(2),d_=BigInt(7),g_=BigInt(256),b_=BigInt(113),N0=[],C0=[],$0=[];for(let e=0,t=Ri,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],N0.push(2*(5*r+n)),C0.push((e+1)*(e+2)/2%64);let i=l_;for(let s=0;s<7;s++)t=(t<<Ri^(t>>d_)*b_)%g_,t&h_&&(i^=Ri<<(Ri<<BigInt(s))-Ri);$0.push(i)}const P0=S0($0,!0),p_=P0[0],y_=P0[1],L0=(e,t,n)=>n>32?n_(e,t,n):e_(e,t,n),U0=(e,t,n)=>n>32?r_(e,t,n):t_(e,t,n);function m_(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,f=(o+2)%10,c=n[f],u=n[f+1],d=L0(c,u,1)^n[a],h=U0(c,u,1)^n[a+1];for(let l=0;l<50;l+=10)e[o+l]^=d,e[o+l+1]^=h}let i=e[2],s=e[3];for(let o=0;o<24;o++){const a=C0[o],f=L0(i,s,a),c=U0(i,s,a),u=N0[o];i=e[u],s=e[u+1],e[u]=f,e[u+1]=c}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=p_[r],e[1]^=y_[r]}mt(n)}class Dc extends Qs{constructor(t,n,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=i,this.rounds=s,sn(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Di(this.state)}clone(){return this._cloneInto()}keccak(){Nn(this.state32),m_(this.state32,this.rounds),Nn(this.state32),this.posOut=0,this.pos=0}update(t){Rn(this),t=At(t),Bt(t);const{blockLen:n,state:r}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:i}=this;t[r]^=n,(n&128)!==0&&r===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){Rn(this,!1),Bt(t),this.finish();const n=this.state,{blockLen:r}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return sn(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Bc(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,mt(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new Dc(n,r,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}}((e,t,n)=>Ti(()=>new Dc(t,e,n)))(1,136,256/8);function w_(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),f=r?4:0,c=r?0:4;e.setUint32(t+f,o,r),e.setUint32(t+c,a,r)}function v_(e,t,n){return e&t^~e&n}function E_(e,t,n){return e&t^e&n^t&n}class F0 extends Qs{constructor(t,n,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(t),this.view=Ac(this.buffer)}update(t){Rn(this),t=At(t),Bt(t);const{view:n,buffer:r,blockLen:i}=this,s=t.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const f=Ac(t);for(;i<=s-o;o+=i)this.process(f,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Rn(this),Bc(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;n[o++]=128,mt(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let d=o;d<i;d++)n[d]=0;w_(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=Ac(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<c;d++)a.setUint32(4*d,u[d],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=s,t.length=i,t.pos=a,i%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const $n=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ce=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),$e=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),__=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pn=new Uint32Array(64);class x_ extends F0{constructor(t=32){super(64,t,8,!1),this.A=$n[0]|0,this.B=$n[1]|0,this.C=$n[2]|0,this.D=$n[3]|0,this.E=$n[4]|0,this.F=$n[5]|0,this.G=$n[6]|0,this.H=$n[7]|0}get(){const{A:t,B:n,C:r,D:i,E:s,F:o,G:a,H:f}=this;return[t,n,r,i,s,o,a,f]}set(t,n,r,i,s,o,a,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=f|0}process(t,n){for(let d=0;d<16;d++,n+=4)Pn[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=Pn[d-15],l=Pn[d-2],b=Ft(h,7)^Ft(h,18)^h>>>3,y=Ft(l,17)^Ft(l,19)^l>>>10;Pn[d]=y+Pn[d-7]+b+Pn[d-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:f,G:c,H:u}=this;for(let d=0;d<64;d++){const h=Ft(a,6)^Ft(a,11)^Ft(a,25),l=u+h+v_(a,f,c)+__[d]+Pn[d]|0,b=(Ft(r,2)^Ft(r,13)^Ft(r,22))+E_(r,i,s)|0;u=c,c=f,f=a,a=o+l|0,o=s,s=i,i=r,r=l+b|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,f,c,u)}roundClean(){mt(Pn)}destroy(){this.set(0,0,0,0,0,0,0,0),mt(this.buffer)}}const j0=S0(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),S_=j0[0],O_=j0[1],Ln=new Uint32Array(80),Un=new Uint32Array(80);class Tc extends F0{constructor(t=64){super(128,t,16,!1),this.Ah=$e[0]|0,this.Al=$e[1]|0,this.Bh=$e[2]|0,this.Bl=$e[3]|0,this.Ch=$e[4]|0,this.Cl=$e[5]|0,this.Dh=$e[6]|0,this.Dl=$e[7]|0,this.Eh=$e[8]|0,this.El=$e[9]|0,this.Fh=$e[10]|0,this.Fl=$e[11]|0,this.Gh=$e[12]|0,this.Gl=$e[13]|0,this.Hh=$e[14]|0,this.Hl=$e[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:f,Eh:c,El:u,Fh:d,Fl:h,Gh:l,Gl:b,Hh:y,Hl:E}=this;return[t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E]}set(t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=l|0,this.Gl=b|0,this.Hh=y|0,this.Hl=E|0}process(t,n){for(let x=0;x<16;x++,n+=4)Ln[x]=t.getUint32(n),Un[x]=t.getUint32(n+=4);for(let x=16;x<80;x++){const _=Ln[x-15]|0,R=Un[x-15]|0,P=Dn(_,R,1)^Dn(_,R,8)^O0(_,R,7),U=Tn(_,R,1)^Tn(_,R,8)^I0(_,R,7),F=Ln[x-2]|0,D=Un[x-2]|0,q=Dn(F,D,19)^Bi(F,D,61)^O0(F,D,6),z=Tn(F,D,19)^Ai(F,D,61)^I0(F,D,6),v=i_(U,z,Un[x-7],Un[x-16]),p=s_(v,P,q,Ln[x-7],Ln[x-16]);Ln[x]=p|0,Un[x]=v|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:f,Dh:c,Dl:u,Eh:d,El:h,Fh:l,Fl:b,Gh:y,Gl:E,Hh:A,Hl:C}=this;for(let x=0;x<80;x++){const _=Dn(d,h,14)^Dn(d,h,18)^Bi(d,h,41),R=Tn(d,h,14)^Tn(d,h,18)^Ai(d,h,41),P=d&l^~d&y,U=h&b^~h&E,F=o_(C,R,U,O_[x],Un[x]),D=a_(F,A,_,P,S_[x],Ln[x]),q=F|0,z=Dn(r,i,28)^Bi(r,i,34)^Bi(r,i,39),v=Tn(r,i,28)^Ai(r,i,34)^Ai(r,i,39),p=r&s^r&a^s&a,w=i&o^i&f^o&f;A=y|0,C=E|0,y=l|0,E=b|0,l=d|0,b=h|0,{h:d,l:h}=It(c|0,u|0,D|0,q|0),c=a|0,u=f|0,a=s|0,f=o|0,s=r|0,o=i|0;const g=Oc(q,v,w);r=Ic(g,D,z,p),i=g|0}({h:r,l:i}=It(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=It(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:f}=It(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=It(this.Dh|0,this.Dl|0,c|0,u|0),{h:d,l:h}=It(this.Eh|0,this.El|0,d|0,h|0),{h:l,l:b}=It(this.Fh|0,this.Fl|0,l|0,b|0),{h:y,l:E}=It(this.Gh|0,this.Gl|0,y|0,E|0),{h:A,l:C}=It(this.Hh|0,this.Hl|0,A|0,C|0),this.set(r,i,s,o,a,f,c,u,d,h,l,b,y,E,A,C)}roundClean(){mt(Ln,Un)}destroy(){mt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class I_ extends Tc{constructor(){super(48),this.Ah=Ce[0]|0,this.Al=Ce[1]|0,this.Bh=Ce[2]|0,this.Bl=Ce[3]|0,this.Ch=Ce[4]|0,this.Cl=Ce[5]|0,this.Dh=Ce[6]|0,this.Dl=Ce[7]|0,this.Eh=Ce[8]|0,this.El=Ce[9]|0,this.Fh=Ce[10]|0,this.Fl=Ce[11]|0,this.Gh=Ce[12]|0,this.Gl=Ce[13]|0,this.Hh=Ce[14]|0,this.Hl=Ce[15]|0}}const Pe=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class B_ extends Tc{constructor(){super(32),this.Ah=Pe[0]|0,this.Al=Pe[1]|0,this.Bh=Pe[2]|0,this.Bl=Pe[3]|0,this.Ch=Pe[4]|0,this.Cl=Pe[5]|0,this.Dh=Pe[6]|0,this.Dl=Pe[7]|0,this.Eh=Pe[8]|0,this.El=Pe[9]|0,this.Fh=Pe[10]|0,this.Fl=Pe[11]|0,this.Gh=Pe[12]|0,this.Gl=Pe[13]|0,this.Hh=Pe[14]|0,this.Hl=Pe[15]|0}}const k0=Ti(()=>new x_),A_=Ti(()=>new Tc),D_=Ti(()=>new I_);Ti(()=>new B_);const T_=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),ve=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Z=new Uint32Array(32);function Fn(e,t,n,r,i,s){const o=i[s],a=i[s+1];let f=Z[2*e],c=Z[2*e+1],u=Z[2*t],d=Z[2*t+1],h=Z[2*n],l=Z[2*n+1],b=Z[2*r],y=Z[2*r+1],E=Oc(f,u,o);c=Ic(E,c,d,a),f=E|0,{Dh:y,Dl:b}={Dh:y^c,Dl:b^f},{Dh:y,Dl:b}={Dh:J6(y,b),Dl:Q6(y)},{h:l,l:h}=It(l,h,y,b),{Bh:d,Bl:u}={Bh:d^l,Bl:u^h},{Bh:d,Bl:u}={Bh:Dn(d,u,24),Bl:Tn(d,u,24)},Z[2*e]=f,Z[2*e+1]=c,Z[2*t]=u,Z[2*t+1]=d,Z[2*n]=h,Z[2*n+1]=l,Z[2*r]=b,Z[2*r+1]=y}function jn(e,t,n,r,i,s){const o=i[s],a=i[s+1];let f=Z[2*e],c=Z[2*e+1],u=Z[2*t],d=Z[2*t+1],h=Z[2*n],l=Z[2*n+1],b=Z[2*r],y=Z[2*r+1],E=Oc(f,u,o);c=Ic(E,c,d,a),f=E|0,{Dh:y,Dl:b}={Dh:y^c,Dl:b^f},{Dh:y,Dl:b}={Dh:Dn(y,b,16),Dl:Tn(y,b,16)},{h:l,l:h}=It(l,h,y,b),{Bh:d,Bl:u}={Bh:d^l,Bl:u^h},{Bh:d,Bl:u}={Bh:Bi(d,u,63),Bl:Ai(d,u,63)},Z[2*e]=f,Z[2*e+1]=c,Z[2*t]=u,Z[2*t+1]=d,Z[2*n]=h,Z[2*n+1]=l,Z[2*r]=b,Z[2*r+1]=y}function R_(e,t={},n,r,i){if(sn(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=t;if(s!==void 0&&(s.length<1||s.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==i)throw new Error("personalization must be undefined or "+i)}class N_ extends Qs{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,sn(t),sn(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=Di(this.buffer)}update(t){Rn(this),t=At(t),Bt(t);const{blockLen:n,buffer:r,buffer32:i}=this,s=t.length,o=t.byteOffset,a=t.buffer;for(let f=0;f<s;){this.pos===n&&(Nn(i),this.compress(i,0,!1),Nn(i),this.pos=0);const c=Math.min(n-this.pos,s-f),u=o+f;if(c===n&&!(u%4)&&f+c<s){const d=new Uint32Array(a,u,Math.floor((s-f)/4));Nn(d);for(let h=0;f+n<s;h+=i.length,f+=n)this.length+=n,this.compress(d,h,!1);Nn(d);continue}r.set(t.subarray(f,f+c),this.pos),this.pos+=c,this.length+=c,f+=c}return this}digestInto(t){Rn(this),Bc(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,mt(this.buffer.subarray(n)),Nn(r),this.compress(r,0,!0),Nn(r);const i=Di(t);this.get().forEach((s,o)=>i[o]=on(s))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.buffer.set(n),t.destroyed=s,t.finished=i,t.length=r,t.pos=a,t.outputLen=o,t}clone(){return this._cloneInto()}}class C_ extends N_{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=ve[0]|0,this.v0h=ve[1]|0,this.v1l=ve[2]|0,this.v1h=ve[3]|0,this.v2l=ve[4]|0,this.v2h=ve[5]|0,this.v3l=ve[6]|0,this.v3h=ve[7]|0,this.v4l=ve[8]|0,this.v4h=ve[9]|0,this.v5l=ve[10]|0,this.v5h=ve[11]|0,this.v6l=ve[12]|0,this.v6h=ve[13]|0,this.v7l=ve[14]|0,this.v7h=ve[15]|0,R_(n,t,64,16,16);let{key:r,personalization:i,salt:s}=t,o=0;if(r!==void 0&&(r=At(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=At(s);const a=Di(s);this.v4l^=on(a[0]),this.v4h^=on(a[1]),this.v5l^=on(a[2]),this.v5h^=on(a[3])}if(i!==void 0){i=At(i);const a=Di(i);this.v6l^=on(a[0]),this.v6h^=on(a[1]),this.v7l^=on(a[2]),this.v7h^=on(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:i,v2l:s,v2h:o,v3l:a,v3h:f,v4l:c,v4h:u,v5l:d,v5h:h,v6l:l,v6h:b,v7l:y,v7h:E}=this;return[t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E]}set(t,n,r,i,s,o,a,f,c,u,d,h,l,b,y,E){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=f|0,this.v4l=c|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=l|0,this.v6h=b|0,this.v7l=y|0,this.v7h=E|0}compress(t,n,r){this.get().forEach((f,c)=>Z[c]=f),Z.set(ve,16);let{h:i,l:s}=x0(BigInt(this.length));Z[24]=ve[8]^s,Z[25]=ve[9]^i,r&&(Z[28]=~Z[28],Z[29]=~Z[29]);let o=0;const a=T_;for(let f=0;f<12;f++)Fn(0,4,8,12,t,n+2*a[o++]),jn(0,4,8,12,t,n+2*a[o++]),Fn(1,5,9,13,t,n+2*a[o++]),jn(1,5,9,13,t,n+2*a[o++]),Fn(2,6,10,14,t,n+2*a[o++]),jn(2,6,10,14,t,n+2*a[o++]),Fn(3,7,11,15,t,n+2*a[o++]),jn(3,7,11,15,t,n+2*a[o++]),Fn(0,5,10,15,t,n+2*a[o++]),jn(0,5,10,15,t,n+2*a[o++]),Fn(1,6,11,12,t,n+2*a[o++]),jn(1,6,11,12,t,n+2*a[o++]),Fn(2,7,8,13,t,n+2*a[o++]),jn(2,7,8,13,t,n+2*a[o++]),Fn(3,4,9,14,t,n+2*a[o++]),jn(3,4,9,14,t,n+2*a[o++]);this.v0l^=Z[0]^Z[16],this.v0h^=Z[1]^Z[17],this.v1l^=Z[2]^Z[18],this.v1h^=Z[3]^Z[19],this.v2l^=Z[4]^Z[20],this.v2h^=Z[5]^Z[21],this.v3l^=Z[6]^Z[22],this.v3h^=Z[7]^Z[23],this.v4l^=Z[8]^Z[24],this.v4h^=Z[9]^Z[25],this.v5l^=Z[10]^Z[26],this.v5h^=Z[11]^Z[27],this.v6l^=Z[12]^Z[28],this.v6h^=Z[13]^Z[29],this.v7l^=Z[14]^Z[30],this.v7h^=Z[15]^Z[31],mt(Z)}destroy(){this.destroyed=!0,mt(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}u_(e=>new C_(e));/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function z0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Rc(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Nc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function et(e,...t){if(!z0(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function M0(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $_(e,t){et(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function kn(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function zr(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function P_(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const L_=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function U_(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Cc(e){if(typeof e=="string")e=U_(e);else if(z0(e))e=$c(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function F_(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function j_(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const k_=(e,t)=>{function n(r,...i){if(et(r),!L_)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const c=i[0];if(!c)throw new Error("nonce / iv required");e.varSizeNonce?et(c):et(c,e.nonceLength)}const s=e.tagLength;s&&i[1]!==void 0&&et(i[1]);const o=t(r,...i),a=(c,u)=>{if(u!==void 0){if(c!==2)throw new Error("cipher output not supported");et(u)}};let f=!1;return{encrypt(c,u){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,et(c),a(o.encrypt.length,u),o.encrypt(c,u)},decrypt(c,u){if(et(c),s&&c.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(c,u)}}}return Object.assign(n,e),n};function q0(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!M_(t))throw new Error("invalid output, must be aligned");return t}function V0(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),f=r?4:0,c=r?0:4;e.setUint32(t+f,o,r),e.setUint32(t+c,a,r)}function z_(e,t,n){Rc(n);const r=new Uint8Array(16),i=P_(r);return V0(i,0,BigInt(t),n),V0(i,8,BigInt(e),n),r}function M_(e){return e.byteOffset%4===0}function $c(e){return Uint8Array.from(e)}const H0=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),q_=H0("expand 16-byte k"),V_=H0("expand 32-byte k"),H_=kn(q_),K_=kn(V_);function ie(e,t){return e<<t|e>>>32-t}function Pc(e){return e.byteOffset%4===0}const eo=64,G_=16,K0=2**32-1,G0=new Uint32Array;function Z_(e,t,n,r,i,s,o,a){const f=i.length,c=new Uint8Array(eo),u=kn(c),d=Pc(i)&&Pc(s),h=d?kn(i):G0,l=d?kn(s):G0;for(let b=0;b<f;o++){if(e(t,n,r,u,o,a),o>=K0)throw new Error("arx: counter overflow");const y=Math.min(eo,f-b);if(d&&y===eo){const E=b/4;if(b%4!==0)throw new Error("arx: invalid block position");for(let A=0,C;A<G_;A++)C=E+A,l[C]=h[C]^u[A];b+=eo;continue}for(let E=0,A;E<y;E++)A=b+E,s[A]=i[A]^c[E];b+=y}}function Y_(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:s,rounds:o}=F_({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Nc(i),Nc(o),Rc(s),Rc(n),(a,f,c,u,d=0)=>{et(a),et(f),et(c);const h=c.length;if(u===void 0&&(u=new Uint8Array(h)),et(u),Nc(d),d<0||d>=K0)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const l=[];let b=a.length,y,E;if(b===32)l.push(y=$c(a)),E=K_;else if(b===16&&n)y=new Uint8Array(32),y.set(a),y.set(a,16),E=H_,l.push(y);else throw new Error(`arx: invalid 32-byte key, got length=${b}`);Pc(f)||l.push(f=$c(f));const A=kn(y);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(E,A,kn(f.subarray(0,16)),A),f=f.subarray(16)}const C=16-i;if(C!==f.length)throw new Error(`arx: nonce must be ${C} or 16 bytes`);if(C!==12){const _=new Uint8Array(12);_.set(f,s?0:12-f.length),f=_,l.push(f)}const x=kn(f);return Z_(e,E,A,x,c,u,d,o),zr(...l),u}}const Ae=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class W_{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Cc(t),et(t,32);const n=Ae(t,0),r=Ae(t,2),i=Ae(t,4),s=Ae(t,6),o=Ae(t,8),a=Ae(t,10),f=Ae(t,12),c=Ae(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|f<<5)&8065,this.r[8]=(f>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Ae(t,16+2*u)}process(t,n,r=!1){const i=r?0:2048,{h:s,r:o}=this,a=o[0],f=o[1],c=o[2],u=o[3],d=o[4],h=o[5],l=o[6],b=o[7],y=o[8],E=o[9],A=Ae(t,n+0),C=Ae(t,n+2),x=Ae(t,n+4),_=Ae(t,n+6),R=Ae(t,n+8),P=Ae(t,n+10),U=Ae(t,n+12),F=Ae(t,n+14);let D=s[0]+(A&8191),q=s[1]+((A>>>13|C<<3)&8191),z=s[2]+((C>>>10|x<<6)&8191),v=s[3]+((x>>>7|_<<9)&8191),p=s[4]+((_>>>4|R<<12)&8191),w=s[5]+(R>>>1&8191),g=s[6]+((R>>>14|P<<2)&8191),m=s[7]+((P>>>11|U<<5)&8191),S=s[8]+((U>>>8|F<<8)&8191),O=s[9]+(F>>>5|i),I=0,B=I+D*a+q*(5*E)+z*(5*y)+v*(5*b)+p*(5*l);I=B>>>13,B&=8191,B+=w*(5*h)+g*(5*d)+m*(5*u)+S*(5*c)+O*(5*f),I+=B>>>13,B&=8191;let T=I+D*f+q*a+z*(5*E)+v*(5*y)+p*(5*b);I=T>>>13,T&=8191,T+=w*(5*l)+g*(5*h)+m*(5*d)+S*(5*u)+O*(5*c),I+=T>>>13,T&=8191;let L=I+D*c+q*f+z*a+v*(5*E)+p*(5*y);I=L>>>13,L&=8191,L+=w*(5*b)+g*(5*l)+m*(5*h)+S*(5*d)+O*(5*u),I+=L>>>13,L&=8191;let $=I+D*u+q*c+z*f+v*a+p*(5*E);I=$>>>13,$&=8191,$+=w*(5*y)+g*(5*b)+m*(5*l)+S*(5*h)+O*(5*d),I+=$>>>13,$&=8191;let j=I+D*d+q*u+z*c+v*f+p*a;I=j>>>13,j&=8191,j+=w*(5*E)+g*(5*y)+m*(5*b)+S*(5*l)+O*(5*h),I+=j>>>13,j&=8191;let N=I+D*h+q*d+z*u+v*c+p*f;I=N>>>13,N&=8191,N+=w*a+g*(5*E)+m*(5*y)+S*(5*b)+O*(5*l),I+=N>>>13,N&=8191;let k=I+D*l+q*h+z*d+v*u+p*c;I=k>>>13,k&=8191,k+=w*f+g*a+m*(5*E)+S*(5*y)+O*(5*b),I+=k>>>13,k&=8191;let M=I+D*b+q*l+z*h+v*d+p*u;I=M>>>13,M&=8191,M+=w*c+g*f+m*a+S*(5*E)+O*(5*y),I+=M>>>13,M&=8191;let G=I+D*y+q*b+z*l+v*h+p*d;I=G>>>13,G&=8191,G+=w*u+g*c+m*f+S*a+O*(5*E),I+=G>>>13,G&=8191;let V=I+D*E+q*y+z*b+v*l+p*h;I=V>>>13,V&=8191,V+=w*d+g*u+m*c+S*f+O*a,I+=V>>>13,V&=8191,I=(I<<2)+I|0,I=I+B|0,B=I&8191,I=I>>>13,T+=I,s[0]=B,s[1]=T,s[2]=L,s[3]=$,s[4]=j,s[5]=N,s[6]=k,s[7]=M,s[8]=G,s[9]=V}finalize(){const{h:t,pad:n}=this,r=new Uint16Array(10);let i=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=i,i=t[a]>>>13,t[a]&=8191;t[0]+=i*5,i=t[0]>>>13,t[0]&=8191,t[1]+=i,i=t[1]>>>13,t[1]&=8191,t[2]+=i,r[0]=t[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=t[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)r[a]&=s;s=~s;for(let a=0;a<10;a++)t[a]=t[a]&s|r[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+n[0];t[0]=o&65535;for(let a=1;a<8;a++)o=(t[a]+n[a]|0)+(o>>>16)|0,t[a]=o&65535;zr(r)}update(t){M0(this),t=Cc(t),et(t);const{buffer:n,blockLen:r}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o===r){for(;r<=i-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){zr(this.h,this.r,this.buffer,this.pad)}digestInto(t){M0(this),$_(t,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:i}=this;if(i){for(n[i++]=1;i<16;i++)n[i]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)t[s++]=r[o]>>>0,t[s++]=r[o]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}}function X_(e){const t=(r,i)=>e(i).update(Cc(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const J_=X_(e=>new W_(e));function Q_(e,t,n,r,i,s=20){let o=e[0],a=e[1],f=e[2],c=e[3],u=t[0],d=t[1],h=t[2],l=t[3],b=t[4],y=t[5],E=t[6],A=t[7],C=i,x=n[0],_=n[1],R=n[2],P=o,U=a,F=f,D=c,q=u,z=d,v=h,p=l,w=b,g=y,m=E,S=A,O=C,I=x,B=_,T=R;for(let $=0;$<s;$+=2)P=P+q|0,O=ie(O^P,16),w=w+O|0,q=ie(q^w,12),P=P+q|0,O=ie(O^P,8),w=w+O|0,q=ie(q^w,7),U=U+z|0,I=ie(I^U,16),g=g+I|0,z=ie(z^g,12),U=U+z|0,I=ie(I^U,8),g=g+I|0,z=ie(z^g,7),F=F+v|0,B=ie(B^F,16),m=m+B|0,v=ie(v^m,12),F=F+v|0,B=ie(B^F,8),m=m+B|0,v=ie(v^m,7),D=D+p|0,T=ie(T^D,16),S=S+T|0,p=ie(p^S,12),D=D+p|0,T=ie(T^D,8),S=S+T|0,p=ie(p^S,7),P=P+z|0,T=ie(T^P,16),m=m+T|0,z=ie(z^m,12),P=P+z|0,T=ie(T^P,8),m=m+T|0,z=ie(z^m,7),U=U+v|0,O=ie(O^U,16),S=S+O|0,v=ie(v^S,12),U=U+v|0,O=ie(O^U,8),S=S+O|0,v=ie(v^S,7),F=F+p|0,I=ie(I^F,16),w=w+I|0,p=ie(p^w,12),F=F+p|0,I=ie(I^F,8),w=w+I|0,p=ie(p^w,7),D=D+q|0,B=ie(B^D,16),g=g+B|0,q=ie(q^g,12),D=D+q|0,B=ie(B^D,8),g=g+B|0,q=ie(q^g,7);let L=0;r[L++]=o+P|0,r[L++]=a+U|0,r[L++]=f+F|0,r[L++]=c+D|0,r[L++]=u+q|0,r[L++]=d+z|0,r[L++]=h+v|0,r[L++]=l+p|0,r[L++]=b+w|0,r[L++]=y+g|0,r[L++]=E+m|0,r[L++]=A+S|0,r[L++]=C+O|0,r[L++]=x+I|0,r[L++]=_+B|0,r[L++]=R+T|0}const e4=Y_(Q_,{counterRight:!1,counterLength:4,allowShortKeys:!1}),t4=new Uint8Array(16),Z0=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(t4.subarray(n))},n4=new Uint8Array(32);function Y0(e,t,n,r,i){const s=e(t,n,n4),o=J_.create(s);i&&Z0(o,i),Z0(o,r);const a=z_(r.length,i?i.length:0,!0);o.update(a);const f=o.digest();return zr(s,a),f}const r4=e=>(t,n,r)=>({encrypt(i,s){const o=i.length;s=q0(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);e(t,n,a,a,1);const f=Y0(e,t,n,a,r);return s.set(f,o),zr(f),s},decrypt(i,s){s=q0(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),f=Y0(e,t,n,o,r);if(!j_(a,f))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),e(t,n,s,s,1),zr(f),s}}),W0=k_({blockSize:64,nonceLength:12,tagLength:16},r4(e4));class X0 extends Qs{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Xs(t);const r=At(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?t.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),mt(s)}update(t){return Rn(this),this.iHash.update(t),this}digestInto(t){Rn(this),Bt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const to=(e,t,n)=>new X0(e,t).update(n).digest();to.create=(e,t)=>new X0(e,t);function i4(e,t,n){return Xs(e),n===void 0&&(n=new Uint8Array(e.outputLen)),to(e,At(n),At(t))}const Lc=Uint8Array.from([0]),J0=Uint8Array.of();function s4(e,t,n,r=32){Xs(e),sn(r);const i=e.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(r/i);n===void 0&&(n=J0);const o=new Uint8Array(s*i),a=to.create(e,t),f=a._cloneInto(),c=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)Lc[0]=u+1,f.update(u===0?J0:c).update(n).update(Lc).digestInto(c),o.set(c,i*u),a._cloneInto(f);return a.destroy(),f.destroy(),mt(c,Lc),o.slice(0,r)}const o4=(e,t,n,r,i)=>s4(e,i4(e,t,n),r,i),no=k0,Uc=BigInt(0),Fc=BigInt(1);function ro(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function ar(e,t,n=""){const r=Ws(e),i=e?.length,s=t!==void 0;if(!r||s&&i!==t){const o=n&&`"${n}" `,a=s?` of length ${t}`:"",f=r?`length=${i}`:`type=${typeof e}`;throw new Error(o+"expected Uint8Array"+a+", got "+f)}return e}function io(e){const t=e.toString(16);return t.length&1?"0"+t:t}function Q0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Uc:BigInt("0x"+e)}function so(e){return Q0(kr(e))}function oo(e){return Bt(e),Q0(kr(Uint8Array.from(e).reverse()))}function jc(e,t){return Js(e.toString(16).padStart(t*2,"0"))}function kc(e,t){return jc(e,t).reverse()}function Le(e,t,n){let r;if(typeof t=="string")try{r=Js(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(Ws(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=r.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}const zc=e=>typeof e=="bigint"&&Uc<=e;function a4(e,t,n){return zc(e)&&zc(t)&&zc(n)&&t<=e&&e<n}function Mc(e,t,n,r){if(!a4(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function eg(e){let t;for(t=0;e>Uc;e>>=Fc,t+=1);return t}const Ni=e=>(Fc<<BigInt(e))-Fc;function c4(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),i=h=>Uint8Array.of(h);let s=r(e),o=r(e),a=0;const f=()=>{s.fill(1),o.fill(0),a=0},c=(...h)=>n(o,s,...h),u=(h=r(0))=>{o=c(i(0),h),s=c(),h.length!==0&&(o=c(i(1),h),s=c())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const l=[];for(;h<t;){s=c();const b=s.slice();l.push(b),h+=s.length}return Cn(...l)};return(h,l)=>{f(),u(h);let b;for(;!(b=l(d()));)u();return f(),b}}function ao(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(i,s,o){const a=e[i];if(o&&a===void 0)return;const f=typeof a;if(f!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${f}`)}Object.entries(t).forEach(([i,s])=>r(i,s,!1)),Object.entries(n).forEach(([i,s])=>r(i,s,!0))}function tg(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(i!==void 0)return i;const s=e(n,...r);return t.set(n,s),s}}const tt=BigInt(0),Ve=BigInt(1),cr=BigInt(2),ng=BigInt(3),rg=BigInt(4),ig=BigInt(5),f4=BigInt(7),sg=BigInt(8),u4=BigInt(9),og=BigInt(16);function ft(e,t){const n=e%t;return n>=tt?n:t+n}function Dt(e,t,n){let r=e;for(;t-- >tt;)r*=r,r%=n;return r}function ag(e,t){if(e===tt)throw new Error("invert: expected non-zero number");if(t<=tt)throw new Error("invert: expected positive modulus, got "+t);let n=ft(e,t),r=t,i=tt,s=Ve;for(;n!==tt;){const o=r/n,a=r%n,f=i-s*o;r=n,n=a,i=s,s=f}if(r!==Ve)throw new Error("invert: does not exist");return ft(i,t)}function qc(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function cg(e,t){const n=(e.ORDER+Ve)/rg,r=e.pow(t,n);return qc(e,r,t),r}function l4(e,t){const n=(e.ORDER-ig)/sg,r=e.mul(t,cr),i=e.pow(r,n),s=e.mul(t,i),o=e.mul(e.mul(s,cr),i),a=e.mul(s,e.sub(o,e.ONE));return qc(e,a,t),a}function h4(e){const t=zn(e),n=fg(e),r=n(t,t.neg(t.ONE)),i=n(t,r),s=n(t,t.neg(r)),o=(e+f4)/og;return(a,f)=>{let c=a.pow(f,o),u=a.mul(c,r);const d=a.mul(c,i),h=a.mul(c,s),l=a.eql(a.sqr(u),f),b=a.eql(a.sqr(d),f);c=a.cmov(c,u,l),u=a.cmov(h,d,b);const y=a.eql(a.sqr(u),f),E=a.cmov(c,u,y);return qc(a,E,f),E}}function fg(e){if(e<ng)throw new Error("sqrt is not defined for small field");let t=e-Ve,n=0;for(;t%cr===tt;)t/=cr,n++;let r=cr;const i=zn(e);for(;lg(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return cg;let s=i.pow(r,t);const o=(t+Ve)/cr;return function(a,f){if(a.is0(f))return f;if(lg(a,f)!==1)throw new Error("Cannot find square root");let c=n,u=a.mul(a.ONE,s),d=a.pow(f,t),h=a.pow(f,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let l=1,b=a.sqr(d);for(;!a.eql(b,a.ONE);)if(l++,b=a.sqr(b),l===c)throw new Error("Cannot find square root");const y=Ve<<BigInt(c-l-1),E=a.pow(u,y);c=l,u=a.sqr(E),d=a.mul(d,u),h=a.mul(h,E)}return h}}function d4(e){return e%rg===ng?cg:e%sg===ig?l4:e%og===u4?h4(e):fg(e)}const g4=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function b4(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=g4.reduce((r,i)=>(r[i]="function",r),t);return ao(e,n),e}function p4(e,t,n){if(n<tt)throw new Error("invalid exponent, negatives unsupported");if(n===tt)return e.ONE;if(n===Ve)return t;let r=e.ONE,i=t;for(;n>tt;)n&Ve&&(r=e.mul(r,i)),i=e.sqr(i),n>>=Ve;return r}function ug(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((o,a,f)=>e.is0(a)?o:(r[f]=o,e.mul(o,a)),e.ONE),s=e.inv(i);return t.reduceRight((o,a,f)=>e.is0(a)?o:(r[f]=e.mul(o,r[f]),e.mul(o,a)),s),r}function lg(e,t){const n=(e.ORDER-Ve)/cr,r=e.pow(t,n),i=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function hg(e,t){t!==void 0&&sn(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function zn(e,t,n=!1,r={}){if(e<=tt)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,s,o=!1,a;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const h=t;h.BITS&&(i=h.BITS),h.sqrt&&(s=h.sqrt),typeof h.isLE=="boolean"&&(n=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof t=="number"&&(i=t),r.sqrt&&(s=r.sqrt);const{nBitLength:f,nByteLength:c}=hg(e,i);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:e,isLE:n,BITS:f,BYTES:c,MASK:Ni(f),ZERO:tt,ONE:Ve,allowedLengths:a,create:h=>ft(h,e),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return tt<=h&&h<e},is0:h=>h===tt,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&Ve)===Ve,neg:h=>ft(-h,e),eql:(h,l)=>h===l,sqr:h=>ft(h*h,e),add:(h,l)=>ft(h+l,e),sub:(h,l)=>ft(h-l,e),mul:(h,l)=>ft(h*l,e),pow:(h,l)=>p4(d,h,l),div:(h,l)=>ft(h*ag(l,e),e),sqrN:h=>h*h,addN:(h,l)=>h+l,subN:(h,l)=>h-l,mulN:(h,l)=>h*l,inv:h=>ag(h,e),sqrt:s||(h=>(u||(u=d4(e)),u(d,h))),toBytes:h=>n?kc(h,c):jc(h,c),fromBytes:(h,l=!0)=>{if(a){if(!a.includes(h.length)||h.length>c)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const y=new Uint8Array(c);y.set(h,n?0:y.length-h.length),h=y}if(h.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+h.length);let b=n?oo(h):so(h);if(o&&(b=ft(b,e)),!l&&!d.isValid(b))throw new Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:h=>ug(d,h),cmov:(h,l,b)=>b?l:h});return Object.freeze(d)}function dg(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function gg(e){const t=dg(e);return t+Math.ceil(t/2)}function y4(e,t,n=!1){const r=e.length,i=dg(t),s=gg(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=n?oo(e):so(e),a=ft(o,t-Ve)+Ve;return n?kc(a,i):jc(a,i)}const Mr=BigInt(0),fr=BigInt(1);function co(e,t){const n=t.negate();return e?n:t}function Vc(e,t){const n=ug(e.Fp,t.map(r=>r.Z));return t.map((r,i)=>e.fromAffine(r.toAffine(n[i])))}function bg(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Hc(e,t){bg(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,s=Ni(e),o=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function pg(e,t,n){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=n;let a=Number(e&i),f=e>>o;a>r&&(a-=s,f+=fr);const c=t*r,u=c+Math.abs(a)-1,d=a===0,h=a<0,l=t%2!==0;return{nextN:f,offset:u,isZero:d,isNeg:h,isNegF:l,offsetF:c}}function m4(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function w4(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Kc=new WeakMap,yg=new WeakMap;function Gc(e){return yg.get(e)||1}function mg(e){if(e!==Mr)throw new Error("invalid wNAF")}class v4{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let i=t;for(;n>Mr;)n&fr&&(r=r.add(i)),i=i.double(),n>>=fr;return r}precomputeWindow(t,n){const{windows:r,windowSize:i}=Hc(n,this.bits),s=[];let o=t,a=o;for(let f=0;f<r;f++){a=o,s.push(a);for(let c=1;c<i;c++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE;const o=Hc(t,this.bits);for(let a=0;a<o.windows;a++){const{nextN:f,offset:c,isZero:u,isNeg:d,isNegF:h,offsetF:l}=pg(r,a,o);r=f,u?s=s.add(co(h,n[l])):i=i.add(co(d,n[c]))}return mg(r),{p:i,f:s}}wNAFUnsafe(t,n,r,i=this.ZERO){const s=Hc(t,this.bits);for(let o=0;o<s.windows&&r!==Mr;o++){const{nextN:a,offset:f,isZero:c,isNeg:u}=pg(r,o,s);if(r=a,!c){const d=n[f];i=i.add(u?d.negate():d)}}return mg(r),i}getPrecomputes(t,n,r){let i=Kc.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(i=r(i)),Kc.set(n,i))),i}cached(t,n,r){const i=Gc(t);return this.wNAF(i,this.getPrecomputes(i,t,r),n)}unsafe(t,n,r,i){const s=Gc(t);return s===1?this._unsafeLadder(t,n,i):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,i)}createCache(t,n){bg(n,this.bits),yg.set(t,n),Kc.delete(t)}hasCache(t){return Gc(t)!==1}}function E4(e,t,n,r){let i=t,s=e.ZERO,o=e.ZERO;for(;n>Mr||r>Mr;)n&fr&&(s=s.add(i)),r&fr&&(o=o.add(i)),i=i.double(),n>>=fr,r>>=fr;return{p1:s,p2:o}}function _4(e,t,n,r){m4(n,e),w4(r,t);const i=n.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=eg(BigInt(i));let f=1;a>12?f=a-3:a>4?f=a-2:a>0&&(f=2);const c=Ni(f),u=new Array(Number(c)+1).fill(o),d=Math.floor((t.BITS-1)/f)*f;let h=o;for(let l=d;l>=0;l-=f){u.fill(o);for(let y=0;y<s;y++){const E=r[y],A=Number(E>>BigInt(l)&c);u[A]=u[A].add(n[y])}let b=o;for(let y=u.length-1,E=o;y>0;y--)E=E.add(u[y]),b=b.add(E);if(h=h.add(b),l!==0)for(let y=0;y<f;y++)h=h.double()}return h}function wg(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return b4(t),t}else return zn(e,{isLE:n})}function x4(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const a of["p","n","h"]){const f=t[a];if(!(typeof f=="bigint"&&f>Mr))throw new Error(`CURVE.${a} must be positive bigint`)}const i=wg(t.p,n.Fp,r),s=wg(t.n,n.Fn,r),o=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(const a of o)if(!i.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:i,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),R0("HashToScalar-");const Ci=BigInt(0),qr=BigInt(1),fo=BigInt(2);function S4(e){return ao(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(Fr({},e))}function O4(e){const t=S4(e),{P:n,type:r,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=t,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const f=o||or,c=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),l=a?fo**BigInt(254):fo**BigInt(447),b=a?BigInt(8)*fo**BigInt(251)-qr:BigInt(4)*fo**BigInt(445)-qr,y=l+b+qr,E=v=>ft(v,n),A=C(d);function C(v){return kc(E(v),u)}function x(v){const p=Le("u coordinate",v,u);return a&&(p[31]&=127),E(oo(p))}function _(v){return oo(i(Le("scalar",v,u)))}function R(v,p){const w=F(x(p),_(v));if(w===Ci)throw new Error("invalid private or public key received");return C(w)}function P(v){return R(v,A)}function U(v,p,w){const g=E(v*(p-w));return p=E(p-g),w=E(w+g),{x_2:p,x_3:w}}function F(v,p){Mc("u",v,Ci,n),Mc("scalar",p,l,y);const w=p,g=v;let m=qr,S=Ci,O=v,I=qr,B=Ci;for(let L=BigInt(c-1);L>=Ci;L--){const $=w>>L&qr;B^=$,{x_2:m,x_3:O}=U(B,m,O),{x_2:S,x_3:I}=U(B,S,I),B=$;const j=m+S,N=E(j*j),k=m-S,M=E(k*k),G=N-M,V=O+I,K=O-I,J=E(K*j),ee=E(V*k),re=J+ee,he=J-ee;O=E(re*re),I=E(g*E(he*he)),m=E(N*M),S=E(G*(N+E(h*G)))}({x_2:m,x_3:O}=U(B,m,O)),{x_2:S,x_3:I}=U(B,S,I);const T=s(S);return E(m*T)}const D={secretKey:u,publicKey:u,seed:u},q=(v=f(u))=>(Bt(v,D.seed),v);function z(v){const p=q(v);return{secretKey:p,publicKey:P(p)}}return{keygen:z,getSharedSecret:(v,p)=>R(v,p),getPublicKey:v=>P(v),scalarMult:R,scalarMultBase:P,utils:{randomSecretKey:q,randomPrivateKey:q},GuBytes:A.slice(),lengths:D}}const I4=BigInt(1),vg=BigInt(2),B4=BigInt(3),A4=BigInt(5),D4=BigInt(8),Eg=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),T4={p:Eg,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:D4,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function R4(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),s=Eg,o=e*e%s*e%s,a=Dt(o,vg,s)*o%s,f=Dt(a,I4,s)*e%s,c=Dt(f,A4,s)*f%s,u=Dt(c,t,s)*c%s,d=Dt(u,n,s)*u%s,h=Dt(d,r,s)*d%s,l=Dt(h,i,s)*h%s,b=Dt(l,i,s)*h%s,y=Dt(b,t,s)*c%s;return{pow_p_5_8:Dt(y,vg,s)*e%s,b2:o}}function N4(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const C4=zn(T4.p,{isLE:!0}),Zc=(()=>{const e=C4.ORDER;return O4({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:n,b2:r}=R4(t);return ft(Dt(n,B4,e)*r,e)},adjustScalarBytes:N4})})(),_g=(e,t)=>(e+(e>=0?t:-t)/xg)/t;function $4(e,t,n){const[[r,i],[s,o]]=t,a=_g(o*e,n),f=_g(-i*e,n);let c=e-a*r-f*s,u=-a*i-f*o;const d=c<fn,h=u<fn;d&&(c=-c),h&&(u=-u);const l=Ni(Math.ceil(eg(n)/2))+Vr;if(c<fn||c>=l||u<fn||u>=l)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:d,k1:c,k2neg:h,k2:u}}function Yc(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Wc(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return ro(n.lowS,"lowS"),ro(n.prehash,"prehash"),n.format!==void 0&&Yc(n.format),n}class P4 extends Error{constructor(t=""){super(t)}}const cn={Err:P4,_tlv:{encode:(e,t)=>{const{Err:n}=cn;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=io(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?io(i.length/2|128):"";return io(e)+s+i+t},decode(e,t){const{Err:n}=cn;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const f=i&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+f);if(c.length!==f)throw new n("tlv.decode: length bytes not complete");if(c[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of c)o=o<<8|u;if(r+=f,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=cn;if(e<fn)throw new t("integer: negative integers are not allowed");let n=io(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=cn;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return so(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=cn,i=Le("signature",e),{v:s,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:f}=r.decode(2,s),{v:c,l:u}=r.decode(2,f);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=cn,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),s=r+i;return t.encode(48,s)}},fn=BigInt(0),Vr=BigInt(1),xg=BigInt(2),uo=BigInt(3),L4=BigInt(4);function Hr(e,t){const{BYTES:n}=e;let r;if(typeof t=="bigint")r=t;else{let i=Le("private key",t);try{r=e.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function U4(e,t={}){const n=x4("weierstrass",e,t),{Fp:r,Fn:i}=n;let s=n.CURVE;const{h:o,n:a}=s;ao(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!r.is0(s.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const c=Og(r,i);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(v,p,w){const{x:g,y:m}=p.toAffine(),S=r.toBytes(g);if(ro(w,"isCompressed"),w){u();const O=!r.isOdd(m);return Cn(Sg(O),S)}else return Cn(Uint8Array.of(4),S,r.toBytes(m))}function h(v){ar(v,void 0,"Point");const{publicKey:p,publicKeyUncompressed:w}=c,g=v.length,m=v[0],S=v.subarray(1);if(g===p&&(m===2||m===3)){const O=r.fromBytes(S);if(!r.isValid(O))throw new Error("bad point: is not on curve, wrong x");const I=y(O);let B;try{B=r.sqrt(I)}catch(L){const $=L instanceof Error?": "+L.message:"";throw new Error("bad point: is not on curve, sqrt error"+$)}u();const T=r.isOdd(B);return(m&1)===1!==T&&(B=r.neg(B)),{x:O,y:B}}else if(g===w&&m===4){const O=r.BYTES,I=r.fromBytes(S.subarray(0,O)),B=r.fromBytes(S.subarray(O,O*2));if(!E(I,B))throw new Error("bad point: is not on curve");return{x:I,y:B}}else throw new Error(`bad point: got length ${g}, expected compressed=${p} or uncompressed=${w}`)}const l=t.toBytes||d,b=t.fromBytes||h;function y(v){const p=r.sqr(v),w=r.mul(p,v);return r.add(r.add(w,r.mul(v,s.a)),s.b)}function E(v,p){const w=r.sqr(p),g=y(v);return r.eql(w,g)}if(!E(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const A=r.mul(r.pow(s.a,uo),L4),C=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(A,C)))throw new Error("bad curve params: a or b");function x(v,p,w=!1){if(!r.isValid(p)||w&&r.is0(p))throw new Error(`bad point coordinate ${v}`);return p}function _(v){if(!(v instanceof D))throw new Error("ProjectivePoint expected")}function R(v){if(!f||!f.basises)throw new Error("no endo");return $4(v,f.basises,i.ORDER)}const P=tg((v,p)=>{const{X:w,Y:g,Z:m}=v;if(r.eql(m,r.ONE))return{x:w,y:g};const S=v.is0();p==null&&(p=S?r.ONE:r.inv(m));const O=r.mul(w,p),I=r.mul(g,p),B=r.mul(m,p);if(S)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:O,y:I}}),U=tg(v=>{if(v.is0()){if(t.allowInfinityPoint&&!r.is0(v.Y))return;throw new Error("bad point: ZERO")}const{x:p,y:w}=v.toAffine();if(!r.isValid(p)||!r.isValid(w))throw new Error("bad point: x or y not field elements");if(!E(p,w))throw new Error("bad point: equation left != right");if(!v.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function F(v,p,w,g,m){return w=new D(r.mul(w.X,v),w.Y,w.Z),p=co(g,p),w=co(m,w),p.add(w)}class D{constructor(p,w,g){this.X=x("x",p),this.Y=x("y",w,!0),this.Z=x("z",g),Object.freeze(this)}static CURVE(){return s}static fromAffine(p){const{x:w,y:g}=p||{};if(!p||!r.isValid(w)||!r.isValid(g))throw new Error("invalid affine point");if(p instanceof D)throw new Error("projective point not allowed");return r.is0(w)&&r.is0(g)?D.ZERO:new D(w,g,r.ONE)}static fromBytes(p){const w=D.fromAffine(b(ar(p,void 0,"point")));return w.assertValidity(),w}static fromHex(p){return D.fromBytes(Le("pointHex",p))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,w=!0){return z.createCache(this,p),w||this.multiply(uo),this}assertValidity(){U(this)}hasEvenY(){const{y:p}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(p)}equals(p){_(p);const{X:w,Y:g,Z:m}=this,{X:S,Y:O,Z:I}=p,B=r.eql(r.mul(w,I),r.mul(S,m)),T=r.eql(r.mul(g,I),r.mul(O,m));return B&&T}negate(){return new D(this.X,r.neg(this.Y),this.Z)}double(){const{a:p,b:w}=s,g=r.mul(w,uo),{X:m,Y:S,Z:O}=this;let I=r.ZERO,B=r.ZERO,T=r.ZERO,L=r.mul(m,m),$=r.mul(S,S),j=r.mul(O,O),N=r.mul(m,S);return N=r.add(N,N),T=r.mul(m,O),T=r.add(T,T),I=r.mul(p,T),B=r.mul(g,j),B=r.add(I,B),I=r.sub($,B),B=r.add($,B),B=r.mul(I,B),I=r.mul(N,I),T=r.mul(g,T),j=r.mul(p,j),N=r.sub(L,j),N=r.mul(p,N),N=r.add(N,T),T=r.add(L,L),L=r.add(T,L),L=r.add(L,j),L=r.mul(L,N),B=r.add(B,L),j=r.mul(S,O),j=r.add(j,j),L=r.mul(j,N),I=r.sub(I,L),T=r.mul(j,$),T=r.add(T,T),T=r.add(T,T),new D(I,B,T)}add(p){_(p);const{X:w,Y:g,Z:m}=this,{X:S,Y:O,Z:I}=p;let B=r.ZERO,T=r.ZERO,L=r.ZERO;const $=s.a,j=r.mul(s.b,uo);let N=r.mul(w,S),k=r.mul(g,O),M=r.mul(m,I),G=r.add(w,g),V=r.add(S,O);G=r.mul(G,V),V=r.add(N,k),G=r.sub(G,V),V=r.add(w,m);let K=r.add(S,I);return V=r.mul(V,K),K=r.add(N,M),V=r.sub(V,K),K=r.add(g,m),B=r.add(O,I),K=r.mul(K,B),B=r.add(k,M),K=r.sub(K,B),L=r.mul($,V),B=r.mul(j,M),L=r.add(B,L),B=r.sub(k,L),L=r.add(k,L),T=r.mul(B,L),k=r.add(N,N),k=r.add(k,N),M=r.mul($,M),V=r.mul(j,V),k=r.add(k,M),M=r.sub(N,M),M=r.mul($,M),V=r.add(V,M),N=r.mul(k,V),T=r.add(T,N),N=r.mul(K,V),B=r.mul(G,B),B=r.sub(B,N),N=r.mul(G,k),L=r.mul(K,L),L=r.add(L,N),new D(B,T,L)}subtract(p){return this.add(p.negate())}is0(){return this.equals(D.ZERO)}multiply(p){const{endo:w}=t;if(!i.isValidNot0(p))throw new Error("invalid scalar: out of range");let g,m;const S=O=>z.cached(this,O,I=>Vc(D,I));if(w){const{k1neg:O,k1:I,k2neg:B,k2:T}=R(p),{p:L,f:$}=S(I),{p:j,f:N}=S(T);m=$.add(N),g=F(w.beta,L,j,O,B)}else{const{p:O,f:I}=S(p);g=O,m=I}return Vc(D,[g,m])[0]}multiplyUnsafe(p){const{endo:w}=t,g=this;if(!i.isValid(p))throw new Error("invalid scalar: out of range");if(p===fn||g.is0())return D.ZERO;if(p===Vr)return g;if(z.hasCache(this))return this.multiply(p);if(w){const{k1neg:m,k1:S,k2neg:O,k2:I}=R(p),{p1:B,p2:T}=E4(D,g,S,I);return F(w.beta,B,T,m,O)}else return z.unsafe(g,p)}multiplyAndAddUnsafe(p,w,g){const m=this.multiplyUnsafe(w).add(p.multiplyUnsafe(g));return m.is0()?void 0:m}toAffine(p){return P(this,p)}isTorsionFree(){const{isTorsionFree:p}=t;return o===Vr?!0:p?p(D,this):z.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:p}=t;return o===Vr?this:p?p(D,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(p=!0){return ro(p,"isCompressed"),this.assertValidity(),l(D,this,p)}toHex(p=!0){return kr(this.toBytes(p))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(p=!0){return this.toBytes(p)}_setWindowSize(p){this.precompute(p)}static normalizeZ(p){return Vc(D,p)}static msm(p,w){return _4(D,i,p,w)}static fromPrivateKey(p){return D.BASE.multiply(Hr(i,p))}}D.BASE=new D(s.Gx,s.Gy,r.ONE),D.ZERO=new D(r.ZERO,r.ONE,r.ZERO),D.Fp=r,D.Fn=i;const q=i.BITS,z=new v4(D,t.endo?Math.ceil(q/2):q);return D.BASE.precompute(8),D}function Sg(e){return Uint8Array.of(e?2:3)}function Og(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function F4(e,t={}){const{Fn:n}=e,r=t.randomBytes||or,i=Object.assign(Og(e.Fp,n),{seed:gg(n.ORDER)});function s(h){try{return!!Hr(n,h)}catch{return!1}}function o(h,l){const{publicKey:b,publicKeyUncompressed:y}=i;try{const E=h.length;return l===!0&&E!==b||l===!1&&E!==y?!1:!!e.fromBytes(h)}catch{return!1}}function a(h=r(i.seed)){return y4(ar(h,i.seed,"seed"),n.ORDER)}function f(h,l=!0){return e.BASE.multiply(Hr(n,h)).toBytes(l)}function c(h){const l=a(h);return{secretKey:l,publicKey:f(l)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof e)return!0;const{secretKey:l,publicKey:b,publicKeyUncompressed:y}=i;if(n.allowedLengths||l===b)return;const E=Le("key",h).length;return E===b||E===y}function d(h,l,b=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(l)===!1)throw new Error("second arg must be public key");const y=Hr(n,h);return e.fromHex(l).multiply(y).toBytes(b)}return Object.freeze({getPublicKey:f,getSharedSecret:d,keygen:c,Point:e,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:h=>Hr(n,h),precompute(h=8,l=e.BASE){return l.precompute(h,!1)}},lengths:i})}function j4(e,t,n={}){Xs(t),ao(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||or,i=n.hmac||((w,...g)=>to(t,w,Cn(...g))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:f}=o,{keygen:c,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l}=F4(e,n),b={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},y="compact";function E(w){const g=a>>Vr;return w>g}function A(w,g){if(!o.isValidNot0(g))throw new Error(`invalid signature ${w}: out of range 1..Point.Fn.ORDER`);return g}function C(w,g){Yc(g);const m=l.signature,S=g==="compact"?m:g==="recovered"?m+1:void 0;return ar(w,S,`${g} signature`)}class x{constructor(g,m,S){this.r=A("r",g),this.s=A("s",m),S!=null&&(this.recovery=S),Object.freeze(this)}static fromBytes(g,m=y){C(g,m);let S;if(m==="der"){const{r:T,s:L}=cn.toSig(ar(g));return new x(T,L)}m==="recovered"&&(S=g[0],m="compact",g=g.subarray(1));const O=o.BYTES,I=g.subarray(0,O),B=g.subarray(O,O*2);return new x(o.fromBytes(I),o.fromBytes(B),S)}static fromHex(g,m){return this.fromBytes(Js(g),m)}addRecoveryBit(g){return new x(this.r,this.s,g)}recoverPublicKey(g){const m=s.ORDER,{r:S,s:O,recovery:I}=this;if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");if(a*xg<m&&I>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=I===2||I===3?S+a:S;if(!s.isValid(B))throw new Error("recovery id 2 or 3 invalid");const T=s.toBytes(B),L=e.fromBytes(Cn(Sg((I&1)===0),T)),$=o.inv(B),j=R(Le("msgHash",g)),N=o.create(-j*$),k=o.create(O*$),M=e.BASE.multiplyUnsafe(N).add(L.multiplyUnsafe(k));if(M.is0())throw new Error("point at infinify");return M.assertValidity(),M}hasHighS(){return E(this.s)}toBytes(g=y){if(Yc(g),g==="der")return Js(cn.hexFromSig(this));const m=o.toBytes(this.r),S=o.toBytes(this.s);if(g==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Cn(Uint8Array.of(this.recovery),m,S)}return Cn(m,S)}toHex(g){return kr(this.toBytes(g))}assertValidity(){}static fromCompact(g){return x.fromBytes(Le("sig",g),"compact")}static fromDER(g){return x.fromBytes(Le("sig",g),"der")}normalizeS(){return this.hasHighS()?new x(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return kr(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return kr(this.toBytes("compact"))}}const _=n.bits2int||function(w){if(w.length>8192)throw new Error("input is too large");const g=so(w),m=w.length*8-f;return m>0?g>>BigInt(m):g},R=n.bits2int_modN||function(w){return o.create(_(w))},P=Ni(f);function U(w){return Mc("num < 2^"+f,w,fn,P),o.toBytes(w)}function F(w,g){return ar(w,void 0,"message"),g?ar(t(w),void 0,"prehashed message"):w}function D(w,g,m){if(["recovered","canonical"].some(k=>k in m))throw new Error("sign() legacy options not supported");const{lowS:S,prehash:O,extraEntropy:I}=Wc(m,b);w=F(w,O);const B=R(w),T=Hr(o,g),L=[U(T),U(B)];if(I!=null&&I!==!1){const k=I===!0?r(l.secretKey):I;L.push(Le("extraEntropy",k))}const $=Cn(...L),j=B;function N(k){const M=_(k);if(!o.isValidNot0(M))return;const G=o.inv(M),V=e.BASE.multiply(M).toAffine(),K=o.create(V.x);if(K===fn)return;const J=o.create(G*o.create(j+K*T));if(J===fn)return;let ee=(V.x===K?0:2)|Number(V.y&Vr),re=J;return S&&E(J)&&(re=o.neg(J),ee^=1),new x(K,re,ee)}return{seed:$,k2sig:N}}function q(w,g,m={}){w=Le("message",w);const{seed:S,k2sig:O}=D(w,g,m);return c4(t.outputLen,o.BYTES,i)(S,O)}function z(w){let g;const m=typeof w=="string"||Ws(w),S=!m&&w!==null&&typeof w=="object"&&typeof w.r=="bigint"&&typeof w.s=="bigint";if(!m&&!S)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(S)g=new x(w.r,w.s);else if(m){try{g=x.fromBytes(Le("sig",w),"der")}catch(O){if(!(O instanceof cn.Err))throw O}if(!g)try{g=x.fromBytes(Le("sig",w),"compact")}catch{return!1}}return g||!1}function v(w,g,m,S={}){const{lowS:O,prehash:I,format:B}=Wc(S,b);if(m=Le("publicKey",m),g=F(Le("message",g),I),"strict"in S)throw new Error("options.strict was renamed to lowS");const T=B===void 0?z(w):x.fromBytes(Le("sig",w),B);if(T===!1)return!1;try{const L=e.fromBytes(m);if(O&&T.hasHighS())return!1;const{r:$,s:j}=T,N=R(g),k=o.inv(j),M=o.create(N*k),G=o.create($*k),V=e.BASE.multiplyUnsafe(M).add(L.multiplyUnsafe(G));return V.is0()?!1:o.create(V.x)===$}catch{return!1}}function p(w,g,m={}){const{prehash:S}=Wc(m,b);return g=F(g,S),x.fromBytes(w,"recovered").recoverPublicKey(g).toBytes()}return Object.freeze({keygen:c,getPublicKey:u,getSharedSecret:d,utils:h,lengths:l,Point:e,sign:q,verify:v,recoverPublicKey:p,Signature:x,hash:t})}function k4(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const i=zn(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),s={Fp:n,Fn:i,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function z4(e){const{CURVE:t,curveOpts:n}=k4(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}function M4(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,hg(n.Fn.ORDER,n.Fn.BITS))})}function q4(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:i}=z4(e),s=U4(t,n),o=j4(s,r,i);return M4(e,o)}function Xc(e,t){const n=r=>q4(Si(Fr({},e),{hash:r}));return Si(Fr({},n(t)),{create:n})}const Ig={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Bg={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Ag={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},V4=zn(Ig.p),H4=zn(Bg.p),K4=zn(Ag.p),G4=Xc(Si(Fr({},Ig),{Fp:V4,lowS:!1}),k0);Xc(Si(Fr({},Bg),{Fp:H4,lowS:!1}),D_),Xc(Si(Fr({},Ag),{Fp:K4,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),A_);const Z4=G4,Dg="base10",He="base16",ur="base64pad",Jc="base64url",$i="utf8",Tg=0,Kr=1,lo=2,Y4=0,Rg=1,Pi=12,Qc=32;function W4(){const e=Zc.utils.randomPrivateKey(),t=Zc.getPublicKey(e);return{privateKey:Qe(e,He),publicKey:Qe(t,He)}}function ef(){const e=or(Qc);return Qe(e,He)}function X4(e,t){const n=Zc.getSharedSecret(ot(e,He),ot(t,He)),r=o4(no,n,void 0,void 0,Qc);return Qe(r,He)}function J4(e){const t=no(ot(e,He));return Qe(t,He)}function ho(e){const t=no(ot(e,$i));return Qe(t,He)}function Ng(e){return ot(`${e}`,Dg)}function lr(e){return Number(Qe(e,Dg))}function Cg(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function $g(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function Q4(e){const t=Ng(typeof e.type<"u"?e.type:Tg);if(lr(t)===Kr&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof e.senderPublicKey<"u"?ot(e.senderPublicKey,He):void 0,r=typeof e.iv<"u"?ot(e.iv,He):or(Pi),i=ot(e.symKey,He),s=W0(i,r).encrypt(ot(e.message,$i)),o=Pg({type:t,sealed:s,iv:r,senderPublicKey:n});return e.encoding===Jc?Cg(o):o}function e5(e){const t=ot(e.symKey,He),{sealed:n,iv:r}=Li({encoded:e.encoded,encoding:e.encoding}),i=W0(t,r).decrypt(n);if(i===null)throw new Error("Failed to decrypt");return Qe(i,$i)}function t5(e,t){const n=Ng(lo),r=or(Pi),i=ot(e,$i),s=Pg({type:n,sealed:i,iv:r});return t===Jc?Cg(s):s}function n5(e,t){const{sealed:n}=Li({encoded:e,encoding:t});return Qe(n,$i)}function Pg(e){if(lr(e.type)===lo)return Qe(_i([e.type,e.sealed]),ur);if(lr(e.type)===Kr){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Qe(_i([e.type,e.senderPublicKey,e.iv,e.sealed]),ur)}return Qe(_i([e.type,e.iv,e.sealed]),ur)}function Li(e){const t=(e.encoding||ur)===Jc?$g(e.encoded):e.encoded,n=ot(t,ur),r=n.slice(Y4,Rg),i=Rg;if(lr(r)===Kr){const f=i+Qc,c=f+Pi,u=n.slice(i,f),d=n.slice(f,c),h=n.slice(c);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(lr(r)===lo){const f=n.slice(i),c=or(Pi);return{type:r,sealed:f,iv:c}}const s=i+Pi,o=n.slice(i,s),a=n.slice(s);return{type:r,sealed:a,iv:o}}function r5(e,t){const n=Li({encoded:e,encoding:t?.encoding});return Lg({type:lr(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Qe(n.senderPublicKey,He):void 0,receiverPublicKey:t?.receiverPublicKey})}function Lg(e){const t=e?.type||Tg;if(t===Kr){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Ug(e){return e.type===Kr&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}function Fg(e){return e.type===lo}function i5(e){const t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return _i([new Uint8Array([4]),t,n])}function s5(e,t){const[n,r,i]=e.split("."),s=Buffer.from($g(i),"base64");if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),f=`${n}.${r}`,c=no(f),u=i5(t);if(!Z4.verify(_i([o,a]),c,u))throw new Error("Invalid signature");return aa(e).payload}const o5="irn";function go(e){return e?.relay||{protocol:o5}}function Gr(e){const t=W8[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var a5=Object.defineProperty,c5=Object.defineProperties,f5=Object.getOwnPropertyDescriptors,jg=Object.getOwnPropertySymbols,u5=Object.prototype.hasOwnProperty,l5=Object.prototype.propertyIsEnumerable,kg=(e,t,n)=>t in e?a5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tf=(e,t)=>{for(var n in t||(t={}))u5.call(t,n)&&kg(e,n,t[n]);if(jg)for(var n of jg(t))l5.call(t,n)&&kg(e,n,t[n]);return e},h5=(e,t)=>c5(e,f5(t));function d5(e,t="-"){const n={},r="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(r)){const s=i.replace(r,""),o=e[i];n[s]=o}}),n}function zg(e){if(!e.includes("wc:")){const c=E0(e);c!=null&&c.includes("wc:")&&(e=c)}e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;const t=e.indexOf(":"),n=e.indexOf("?")!==-1?e.indexOf("?"):void 0,r=e.substring(0,t),i=e.substring(t+1,n).split("@"),s=typeof n<"u"?e.substring(n):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),f=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:g5(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:d5(a),methods:f,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function g5(e){return e.startsWith("//")?e.substring(2):e}function b5(e,t="-"){const n="relay",r={};return Object.keys(e).forEach(i=>{const s=i,o=n+t+s;e[s]&&(r[o]=e[s])}),r}function Mg(e){const t=new URLSearchParams,n=tf(tf(h5(tf({},b5(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")});return Object.entries(n).sort(([r],[i])=>r.localeCompare(i)).forEach(([r,i])=>{i!==void 0&&t.append(r,String(i))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}const p5={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},y5={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function oe(e,t){const{message:n,code:r}=y5[e];return{message:t?`${n} ${t}`:n,code:r}}function Ui(e,t){const{message:n,code:r}=p5[e];return{message:t?`${n} ${t}`:n,code:r}}function Zr(e){return typeof e>"u"}function qg(e,t){return t&&Zr(e)?!0:typeof e=="string"&&!!e.trim().length}function m5(e){function t(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(qg(e,!1)){if(t(e))return!0;const n=E0(e);return t(n)}}catch{}return!1}function w5(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function v5(e){return e?.topic}function nf(e){return typeof e<"u"&&typeof e!==null}function Vg(){const e=Zs();return new Promise(t=>{switch(e){case Ot.browser:t(E5());break;case Ot.reactNative:t(_5());break;case Ot.node:t(x5());break;default:t(!0)}})}function E5(){return Oi()&&navigator?.onLine}async function _5(){if(sr()&&typeof global<"u"&&global!=null&&global.NetInfo){const e=await(global==null?void 0:global.NetInfo.fetch());return e?.isConnected}return!0}function x5(){return!0}function S5(e){switch(Zs()){case Ot.browser:O5(e);break;case Ot.reactNative:I5(e);break}}function O5(e){!sr()&&Oi()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function I5(e){sr()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}function B5(){var e;return Oi()&&Er()?((e=Er())==null?void 0:e.visibilityState)==="visible":!0}function A5({logger:e,name:t}){const n=typeof e=="string"?N6({opts:{level:e,name:t}}).logger:e;return n.level=typeof e=="string"?e:e.level,n}var D5=Object.defineProperty,T5=(e,t,n)=>t in e?D5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jt=(e,t,n)=>T5(e,typeof t!="symbol"?t+"":t,n);class Hg{constructor(t,n){this.core=t,this.logger=n,jt(this,"keychain",new Map),jt(this,"name",fu),jt(this,"version",uu),jt(this,"initialized",!1),jt(this,"storagePrefix",vt),jt(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),jt(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),jt(this,"set",async(r,i)=>{this.isInitialized(),this.keychain.set(r,i),await this.persist()}),jt(this,"get",r=>{this.isInitialized();const i=this.keychain.get(r);if(typeof i>"u"){const{message:s}=oe("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(s)}return i}),jt(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=t,this.logger=it(n,this.name)}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,_c(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?xc(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var R5=Object.defineProperty,N5=(e,t,n)=>t in e?R5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Se=(e,t,n)=>N5(e,typeof t!="symbol"?t+"":t,n);class Kg{constructor(t,n,r){this.core=t,this.logger=n,Se(this,"name",au),Se(this,"keychain"),Se(this,"randomSessionIdentifier",ef()),Se(this,"initialized",!1),Se(this,"clientId"),Se(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Se(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),Se(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const i=await this.getClientSeed(),s=Cl(i),o=Nl(s.publicKey);return this.clientId=o,o}),Se(this,"generateKeyPair",()=>{this.isInitialized();const i=W4();return this.setPrivateKey(i.publicKey,i.privateKey)}),Se(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Cl(s),a=this.randomSessionIdentifier;return await f2(a,i,cu,o)}),Se(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),f=X4(a,s);return this.setSymKey(f,o)}),Se(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||J4(i);return await this.keychain.set(o,i),o}),Se(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),Se(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),Se(this,"encode",async(i,s,o)=>{this.isInitialized();const a=Lg(o),f=kt(s);if(Fg(a))return t5(f,o?.encoding);if(Ug(a)){const h=a.senderPublicKey,l=a.receiverPublicKey;i=await this.generateSharedKey(h,l)}const c=this.getSymKey(i),{type:u,senderPublicKey:d}=a;return Q4({type:u,symKey:c,message:f,senderPublicKey:d,encoding:o?.encoding})}),Se(this,"decode",async(i,s,o)=>{this.isInitialized();const a=r5(s,o);if(Fg(a)){const f=n5(s,o?.encoding);return gr(f)}if(Ug(a)){const f=a.receiverPublicKey,c=a.senderPublicKey;i=await this.generateSharedKey(f,c)}try{const f=this.getSymKey(i),c=e5({symKey:f,encoded:s,encoding:o?.encoding});return gr(c)}catch(f){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(f)}}),Se(this,"getPayloadType",(i,s=ur)=>{const o=Li({encoded:i,encoding:s});return lr(o.type)}),Se(this,"getPayloadSenderPublicKey",(i,s=ur)=>{const o=Li({encoded:i,encoding:s});return o.senderPublicKey?Qe(o.senderPublicKey,He):void 0}),this.core=t,this.logger=it(n,this.name),this.keychain=r||new Hg(this.core,this.logger)}get context(){return rt(this.logger)}async setPrivateKey(t,n){return await this.keychain.set(t,n),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Fo)}catch{t=ef(),await this.keychain.set(Fo,t)}return ot(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var C5=Object.defineProperty,$5=Object.defineProperties,P5=Object.getOwnPropertyDescriptors,Gg=Object.getOwnPropertySymbols,L5=Object.prototype.hasOwnProperty,U5=Object.prototype.propertyIsEnumerable,rf=(e,t,n)=>t in e?C5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F5=(e,t)=>{for(var n in t||(t={}))L5.call(t,n)&&rf(e,n,t[n]);if(Gg)for(var n of Gg(t))U5.call(t,n)&&rf(e,n,t[n]);return e},j5=(e,t)=>$5(e,P5(t)),ut=(e,t,n)=>rf(e,typeof t!="symbol"?t+"":t,n);class Zg extends ey{constructor(t,n){super(t,n),this.logger=t,this.core=n,ut(this,"messages",new Map),ut(this,"messagesWithoutClientAck",new Map),ut(this,"name",lu),ut(this,"version",hu),ut(this,"initialized",!1),ut(this,"storagePrefix",vt),ut(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),ut(this,"set",async(r,i,s)=>{this.isInitialized();const o=ho(i);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(r,a),s===ri.inbound){const f=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,j5(F5({},f),{[o]:i}))}return await this.persist(),o}),ut(this,"get",r=>{this.isInitialized();let i=this.messages.get(r);return typeof i>"u"&&(i={}),i}),ut(this,"getWithoutAck",r=>{this.isInitialized();const i={};for(const s of r){const o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),ut(this,"has",(r,i)=>{this.isInitialized();const s=this.get(r),o=ho(i);return typeof s[o]<"u"}),ut(this,"ack",async(r,i)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(r);if(typeof s>"u")return;const o=ho(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,s),await this.persist()}),ut(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=it(t,this.name),this.core=n}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,_c(t))}async setRelayerMessagesWithoutClientAck(t){await this.core.storage.setItem(this.storageKeyWithoutClientAck,_c(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?xc(t):void 0}async getRelayerMessagesWithoutClientAck(){const t=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof t<"u"?xc(t):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}const k5="PARSE_ERROR",z5="INVALID_REQUEST",M5="METHOD_NOT_FOUND",q5="INVALID_PARAMS",Yg="INTERNAL_ERROR",sf="SERVER_ERROR",V5=[-32700,-32600,-32601,-32602,-32603],Fi={[k5]:{code:-32700,message:"Parse error"},[z5]:{code:-32600,message:"Invalid Request"},[M5]:{code:-32601,message:"Method not found"},[q5]:{code:-32602,message:"Invalid params"},[Yg]:{code:-32603,message:"Internal error"},[sf]:{code:-32e3,message:"Server error"}},Wg=sf;function H5(e){return V5.includes(e)}function Xg(e){return Object.keys(Fi).includes(e)?Fi[e]:Fi[Wg]}function K5(e){const t=Object.values(Fi).find(n=>n.code===e);return t||Fi[Wg]}function G5(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}var Jg={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var of=function(e,t){return of=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},of(e,t)};function Z5(e,t){of(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var af=function(){return af=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},af.apply(this,arguments)};function Y5(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function W5(e,t,n,r){var i=arguments.length,s=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function X5(e,t){return function(n,r){t(n,r,e)}}function J5(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Q5(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function f(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,f)}c((r=r.apply(e,t||[])).next())})}function ex(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return f([c,u])}}function f(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function tx(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}function nx(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function cf(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qg(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function rx(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Qg(arguments[t]));return e}function ix(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function ji(e){return this instanceof ji?(this.v=e,this):new ji(e)}function sx(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(l){return new Promise(function(b,y){s.push([h,l,b,y])>1||a(h,l)})})}function a(h,l){try{f(r[h](l))}catch(b){d(s[0][3],b)}}function f(h){h.value instanceof ji?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,l){h(l),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ox(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(o){return(n=!n)?{value:ji(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function ax(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof cf=="function"?cf(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,f){o=e[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(c){s({value:c,done:a})},o)}}function cx(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function fx(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function ux(e){return e&&e.__esModule?e:{default:e}}function lx(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function hx(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}var dx=Object.freeze({__proto__:null,__extends:Z5,get __assign(){return af},__rest:Y5,__decorate:W5,__param:X5,__metadata:J5,__awaiter:Q5,__generator:ex,__createBinding:tx,__exportStar:nx,__values:cf,__read:Qg,__spread:rx,__spreadArrays:ix,__await:ji,__asyncGenerator:sx,__asyncDelegator:ox,__asyncValues:ax,__makeTemplateObject:cx,__importStar:fx,__importDefault:ux,__classPrivateFieldGet:lx,__classPrivateFieldSet:hx}),gx=vf(dx),un={},eb;function bx(){if(eb)return un;eb=1,Object.defineProperty(un,"__esModule",{value:!0}),un.isBrowserCryptoAvailable=un.getSubtleCrypto=un.getBrowerCrypto=void 0;function e(){return Tt?.crypto||Tt?.msCrypto||{}}un.getBrowerCrypto=e;function t(){const r=e();return r.subtle||r.webkitSubtle}un.getSubtleCrypto=t;function n(){return!!e()&&!!t()}return un.isBrowserCryptoAvailable=n,un}var ln={},tb;function px(){if(tb)return ln;tb=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.isBrowser=ln.isNode=ln.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ln.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ln.isNode=t;function n(){return!e()&&!t()}return ln.isBrowser=n,ln}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=gx;t.__exportStar(bx(),e),t.__exportStar(px(),e)})(Jg);function nb(e=3){const t=Date.now()*Math.pow(10,e),n=Math.floor(Math.random()*Math.pow(10,e));return t+n}function bo(e=6){return BigInt(nb(e))}function ff(e,t,n){return{id:n||nb(),jsonrpc:"2.0",method:e,params:t}}function rb(e,t){return{id:e,jsonrpc:"2.0",result:t}}function ib(e,t,n){return{id:e,jsonrpc:"2.0",error:yx(t,n)}}function yx(e,t){return typeof e>"u"?Xg(Yg):(typeof e=="string"&&(e=Object.assign(Object.assign({},Xg(sf)),{message:e})),typeof t<"u"&&(e.data=t),H5(e.code)&&(e=K5(e.code)),e)}class mx{}class wx extends mx{constructor(){super()}}class vx extends wx{constructor(t){super()}}const Ex="^wss?:";function _x(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function xx(e,t){const n=_x(e);return typeof n>"u"?!1:new RegExp(t).test(n)}function sb(e){return xx(e,Ex)}function Sx(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function ob(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function ab(e){return ob(e)&&"method"in e}function uf(e){return ob(e)&&(cb(e)||po(e))}function cb(e){return"result"in e}function po(e){return"error"in e}class Ox extends vx{constructor(t){super(t),this.events=new lt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async request(t,n){return this.requestStrict(ff(t.method,t.params||[],t.id||bo().toString()),n)}async requestStrict(t,n){return new Promise(async(r,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{po(s)?i(s.error):r(s.result)});try{await this.connection.send(t,n)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),uf(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Ix=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Bx=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",fb=e=>e.split("?")[0],ub=10,Ax=Ix();class Dx{constructor(t){if(this.url=t,this.events=new lt.exports.EventEmitter,this.registering=!1,!sb(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(kt(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!sb(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=t,this.registering=!0,new Promise((n,r)=>{const i=Jg.isReactNative()?void 0:{rejectUnauthorized:!Sx(t)},s=new Ax(t,[],i);Bx()?s.onerror=o=>{const a=o;r(this.emitError(a.error))}:s.on("error",o=>{r(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),n(s)}})}onOpen(t){t.onmessage=n=>this.onPayload(n),t.onclose=n=>this.onClose(n),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?gr(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n),i=r.message||r.toString(),s=ib(t,i);this.events.emit("payload",s)}parseError(t,n=this.url){return G5(t,fb(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>ub&&this.events.setMaxListeners(ub)}emitError(t){const n=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${fb(this.url)}`));return this.events.emit("register_error",n),n}}var Tx=Object.defineProperty,Rx=Object.defineProperties,Nx=Object.getOwnPropertyDescriptors,lb=Object.getOwnPropertySymbols,Cx=Object.prototype.hasOwnProperty,$x=Object.prototype.propertyIsEnumerable,lf=(e,t,n)=>t in e?Tx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Yr=(e,t)=>{for(var n in t||(t={}))Cx.call(t,n)&&lf(e,n,t[n]);if(lb)for(var n of lb(t))$x.call(t,n)&&lf(e,n,t[n]);return e},hb=(e,t)=>Rx(e,Nx(t)),wt=(e,t,n)=>lf(e,typeof t!="symbol"?t+"":t,n);class Px extends ty{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,wt(this,"events",new lt.exports.EventEmitter),wt(this,"name",gu),wt(this,"queue",new Map),wt(this,"publishTimeout",W.toMiliseconds(W.ONE_MINUTE)),wt(this,"initialPublishTimeout",W.toMiliseconds(W.ONE_SECOND*15)),wt(this,"needsTransportRestart",!1),wt(this,"publish",async(r,i,s)=>{var o,a,f,c,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:i,opts:s}});const d=s?.ttl||du,h=s?.prompt||!1,l=s?.tag||0,b=s?.id||bo().toString(),y=Gr(go().protocol),E={id:b,method:s?.publishMethod||y.publish,params:Yr({topic:r,message:i,ttl:d,prompt:h,tag:l,attestation:s?.attestation},s?.tvf)},A=`Failed to publish payload, please try again. id:${b} tag:${l}`;try{Zr((o=E.params)==null?void 0:o.prompt)&&((a=E.params)==null||delete a.prompt),Zr((f=E.params)==null?void 0:f.tag)&&((c=E.params)==null||delete c.tag);const C=new Promise(async x=>{const _=({id:P})=>{var U;((U=E.id)==null?void 0:U.toString())===P.toString()&&(this.removeRequestFromQueue(P),this.relayer.events.removeListener(pe.publish,_),x())};this.relayer.events.on(pe.publish,_);const R=Ut(new Promise((P,U)=>{this.rpcPublish(E,s).then(P).catch(F=>{this.logger.warn(F,F?.message),U(F)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${b} tag:${l}`);try{await R,this.events.removeListener(pe.publish,_)}catch(P){this.queue.set(b,{request:E,opts:s,attempt:1}),this.logger.warn(P,P?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:b,topic:r,message:i,opts:s}}),await Ut(C,this.publishTimeout,A)}catch(C){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(C),(u=s?.internal)!=null&&u.throwOnFailedPublish)throw C}finally{this.queue.delete(b)}}),wt(this,"publishCustom",async r=>{var i,s,o,a,f;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:c,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:l,prompt:b,tag:y,ttl:E=W.FIVE_MINUTES}=u,A=u.id||bo().toString(),C=Gr(go().protocol),x=l||C.publish,_={id:A,method:x,params:Yr(hb(Yr({},c),{ttl:E,prompt:b,tag:y,attestation:d}),h)},R=`Failed to publish custom payload, please try again. id:${A} tag:${y}`;try{Zr((i=_.params)==null?void 0:i.prompt)&&((s=_.params)==null||delete s.prompt),Zr((o=_.params)==null?void 0:o.tag)&&((a=_.params)==null||delete a.tag);const P=new Promise(async U=>{const F=({id:q})=>{var z;((z=_.id)==null?void 0:z.toString())===q.toString()&&(this.removeRequestFromQueue(q),this.relayer.events.removeListener(pe.publish,F),U())};this.relayer.events.on(pe.publish,F);const D=Ut(new Promise((q,z)=>{this.rpcPublish(_,u).then(q).catch(v=>{this.logger.warn(v,v?.message),z(v)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${x} id:${A} tag:${y}`);try{await D,this.events.removeListener(pe.publish,F)}catch(q){this.queue.set(A,{request:_,opts:u,attempt:1}),this.logger.warn(q,q?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:A,payload:c,opts:u}}),await Ut(P,this.publishTimeout,R)}catch(P){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(P),(f=u?.internal)!=null&&f.throwOnFailedPublish)throw P}finally{this.queue.delete(A)}}),wt(this,"on",(r,i)=>{this.events.on(r,i)}),wt(this,"once",(r,i)=>{this.events.once(r,i)}),wt(this,"off",(r,i)=>{this.events.off(r,i)}),wt(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.relayer=t,this.logger=it(n,this.name),this.registerEventListeners()}get context(){return rt(this.logger)}async rpcPublish(t,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:t});const r=await this.relayer.request(t);return this.relayer.events.emit(pe.publish,Yr(Yr({},t),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async(t,n)=>{var r;const i=t.attempt+1;this.queue.set(n,hb(Yr({},t),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${t.request.id}, tag: ${(r=t.request.params)==null?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(t.request,t.opts),this.logger.warn({},`Publisher: queue->published: ${t.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Hn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(pe.connection_stalled);return}this.checkQueue()}),this.relayer.on(pe.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}var Lx=Object.defineProperty,Ux=(e,t,n)=>t in e?Lx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wr=(e,t,n)=>Ux(e,typeof t!="symbol"?t+"":t,n);class Fx{constructor(){Wr(this,"map",new Map),Wr(this,"set",(t,n)=>{const r=this.get(t);this.exists(t,n)||this.map.set(t,[...r,n])}),Wr(this,"get",t=>this.map.get(t)||[]),Wr(this,"exists",(t,n)=>this.get(t).includes(n)),Wr(this,"delete",(t,n)=>{if(typeof n>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,n))return;const i=r.filter(s=>s!==n);if(!i.length){this.map.delete(t);return}this.map.set(t,i)}),Wr(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var jx=Object.defineProperty,kx=Object.defineProperties,zx=Object.getOwnPropertyDescriptors,db=Object.getOwnPropertySymbols,Mx=Object.prototype.hasOwnProperty,qx=Object.prototype.propertyIsEnumerable,hf=(e,t,n)=>t in e?jx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ki=(e,t)=>{for(var n in t||(t={}))Mx.call(t,n)&&hf(e,n,t[n]);if(db)for(var n of db(t))qx.call(t,n)&&hf(e,n,t[n]);return e},df=(e,t)=>kx(e,zx(t)),fe=(e,t,n)=>hf(e,typeof t!="symbol"?t+"":t,n);class gb extends iy{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,fe(this,"subscriptions",new Map),fe(this,"topicMap",new Fx),fe(this,"events",new lt.exports.EventEmitter),fe(this,"name",_u),fe(this,"version",xu),fe(this,"pending",new Map),fe(this,"cached",[]),fe(this,"initialized",!1),fe(this,"storagePrefix",vt),fe(this,"subscribeTimeout",W.toMiliseconds(W.ONE_MINUTE)),fe(this,"initialSubscribeTimeout",W.toMiliseconds(W.ONE_SECOND*15)),fe(this,"clientId"),fe(this,"batchSubscribeTopicsLimit",500),fe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),fe(this,"subscribe",async(r,i)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}});try{const o=go(i),a={topic:r,relay:o,transportType:i?.transportType};(s=i?.internal)!=null&&s.skipSubscribe||this.pending.set(r,a);const f=await this.rpcSubscribe(r,o,i);return typeof f=="string"&&(this.onSubscribe(f,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:i}})),f}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),fe(this,"unsubscribe",async(r,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(r,i.id,i):await this.unsubscribeByTopic(r,i)}),fe(this,"isSubscribed",r=>new Promise(i=>{i(this.topicMap.topics.includes(r))})),fe(this,"isKnownTopic",r=>new Promise(i=>{i(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(s=>s.topic===r))})),fe(this,"on",(r,i)=>{this.events.on(r,i)}),fe(this,"once",(r,i)=>{this.events.once(r,i)}),fe(this,"off",(r,i)=>{this.events.off(r,i)}),fe(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),fe(this,"start",async()=>{await this.onConnect()}),fe(this,"stop",async()=>{await this.onDisconnect()}),fe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),fe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}),fe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Hn.pulse,async()=>{await this.checkPending()}),this.events.on(Ge.created,async r=>{const i=Ge.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Ge.deleted,async r=>{const i=Ge.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}),this.relayer=t,this.logger=it(n,this.name),this.clientId=""}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(t,n){let r=!1;try{r=this.getSubscription(t).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,n){const r=this.topicMap.get(t);await Promise.all(r.map(async i=>await this.unsubscribeById(t,i,n)))}async unsubscribeById(t,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}});try{const i=go(r);await this.restartToComplete({topic:t,id:n,relay:i}),await this.rpcUnsubscribe(t,n,i);const s=Ui("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,n,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,n,r){var i,s;const o=await this.getSubscriptionId(t);if((i=r?.internal)!=null&&i.skipSubscribe)return o;(!r||r?.transportType===Zn.relay)&&await this.restartToComplete({topic:t,id:t,relay:n});const a={method:Gr(n.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const f=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{if(r?.transportType===Zn.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},W.toMiliseconds(W.ONE_SECOND)),o;const c=new Promise(async d=>{const h=l=>{l.topic===t&&(this.events.removeListener(Ge.created,h),d(l.id))};this.events.on(Ge.created,h);try{const l=await Ut(new Promise((b,y)=>{this.relayer.request(a).catch(E=>{this.logger.warn(E,E?.message),y(E)}).then(b)}),this.initialSubscribeTimeout,`Subscribing to ${t} failed, please try again`);this.events.removeListener(Ge.created,h),d(l)}catch{}}),u=await Ut(c,this.subscribeTimeout,`Subscribing to ${t} failed, please try again`);if(!u&&f)throw new Error(`Subscribing to ${t} failed, please try again`);return u?o:null}catch(c){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(pe.connection_stalled),f)throw c}return null}async rpcBatchSubscribe(t){if(!t.length)return;const n=t[0].relay,r={method:Gr(n.protocol).batchSubscribe,params:{topics:t.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Ut(new Promise(i=>{this.relayer.request(r).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(pe.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const n=t[0].relay,r={method:Gr(n.protocol).batchFetchMessages,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let i;try{i=await await Ut(new Promise((s,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(pe.connection_stalled)}return i}rpcUnsubscribe(t,n,r){const i={method:Gr(r.protocol).unsubscribe,params:{topic:t,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(t,n){this.setSubscription(t,df(ki({},n),{id:t})),this.pending.delete(n.topic)}onBatchSubscribe(t){t.length&&t.forEach(n=>{this.setSubscription(n.id,ki({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(t,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,t)&&this.deleteSubscription(n,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:n}),this.addSubscription(t,n)}addSubscription(t,n){this.subscriptions.set(t,ki({},n)),this.topicMap.set(n.topic,t),this.events.emit(Ge.created,n)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const n=this.subscriptions.get(t);if(!n){const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}deleteSubscription(t,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:n});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(Ge.deleted,df(ki({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ge.sync)}async onRestart(){if(this.cached.length){const t=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const i=t.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Ge.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size&&!t.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){t.length&&(await this.rpcBatchSubscribe(t),this.onBatchSubscribe(await Promise.all(t.map(async n=>df(ki({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const n=await this.rpcBatchFetchMessages(t);n&&n.messages&&(await X6(W.toMiliseconds(W.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(t){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(t),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(t){return ho(t+await this.getClientId())}}var Vx=Object.defineProperty,bb=Object.getOwnPropertySymbols,Hx=Object.prototype.hasOwnProperty,Kx=Object.prototype.propertyIsEnumerable,gf=(e,t,n)=>t in e?Vx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pb=(e,t)=>{for(var n in t||(t={}))Hx.call(t,n)&&gf(e,n,t[n]);if(bb)for(var n of bb(t))Kx.call(t,n)&&gf(e,n,t[n]);return e},se=(e,t,n)=>gf(e,typeof t!="symbol"?t+"":t,n);class yb extends ny{constructor(t){var n;super(t),se(this,"protocol","wc"),se(this,"version",2),se(this,"core"),se(this,"logger"),se(this,"events",new lt.exports.EventEmitter),se(this,"provider"),se(this,"messages"),se(this,"subscriber"),se(this,"publisher"),se(this,"name",yu),se(this,"transportExplicitlyClosed",!1),se(this,"initialized",!1),se(this,"connectionAttemptInProgress",!1),se(this,"relayUrl"),se(this,"projectId"),se(this,"packageName"),se(this,"bundleId"),se(this,"hasExperiencedNetworkDisruption",!1),se(this,"pingTimeout"),se(this,"heartBeatTimeout",W.toMiliseconds(W.THIRTY_SECONDS+W.FIVE_SECONDS)),se(this,"reconnectTimeout"),se(this,"connectPromise"),se(this,"reconnectInProgress",!1),se(this,"requestsInFlight",[]),se(this,"connectTimeout",W.toMiliseconds(W.ONE_SECOND*15)),se(this,"request",async r=>{var i,s;this.logger.debug("Publishing Request Payload");const o=r.id||bo().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");const a=`${o}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(a);const f=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==a),f}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),se(this,"resetPingTimeout",()=>{Gs()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,s,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null?void 0:s.terminate)==null||o.call(s)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),se(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),se(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(pe.connect)}),se(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),se(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(pe.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),se(this,"registerProviderListeners",()=>{this.provider.on(st.payload,this.onPayloadHandler),this.provider.on(st.connect,this.onConnectHandler),this.provider.on(st.disconnect,this.onDisconnectHandler),this.provider.on(st.error,this.onProviderErrorHandler)}),this.core=t.core,this.logger=A5({logger:(n=t.logger)!=null?n:pu,name:this.name}),this.messages=new Zg(this.logger,t.core),this.subscriber=new gb(this,this.logger),this.publisher=new Px(this,this.logger),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||jo,k6()?this.packageName=b0():z6()&&(this.bundleId=b0()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(t=>this.logger.warn(t,t?.message))}get context(){return rt(this.logger)}get connected(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(t,n,r){this.isInitialized(),await this.publisher.publish(t,n,r),await this.recordMessageEvent({topic:t,message:n,publishedAt:Date.now(),transportType:Zn.relay},ri.outbound)}async publishCustom(t){this.isInitialized(),await this.publisher.publishCustom(t)}async subscribe(t,n){var r,i,s;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(i=n?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"",f;const c=u=>{u.topic===t&&(this.subscriber.off(Ge.created,c),f())};return await Promise.all([new Promise(u=>{f=u,this.subscriber.on(Ge.created,c)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(t,pb({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(t,n){this.isInitialized(),await this.subscriber.unsubscribe(t,n)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Ut(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(t).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(t){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Vg())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if(t?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=t.sort((r,i)=>r.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(t,n){const{topic:r}=t;if(!n.sessionExists){const i=Ii(W.FIVE_MINUTES),s={topic:r,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,s)}this.events.emit(pe.message,t),await this.recordMessageEvent(t,ri.inbound)}async connect(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to connect"))};this.provider.once(st.disconnect,s),await Ut(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(st.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const f=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(st.disconnect,f),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(st.disconnect,f)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const i=r;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,W.toMiliseconds(n*1))),n++}}startPingTimeout(){var t,n,r,i,s;if(Gs())try{(n=(t=this.provider)==null?void 0:t.connection)!=null&&n.socket&&((s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ox(new Dx(K6({sdkVersion:ns,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(t,n){const{topic:r,message:i}=t;await this.messages.set(r,i,n)}async shouldIgnoreMessageEvent(t){const{topic:n,message:r}=t;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const i=this.messages.has(n,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),ab(t)){if(!t.method.endsWith(mu))return;const n=t.params,{topic:r,message:i,publishedAt:s,attestation:o}=n.data,a={topic:r,message:i,publishedAt:s,transportType:Zn.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(pb({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(t),await this.onMessageEvent(a)}else uf(t)&&this.events.emit(pe.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(await this.recordMessageEvent(t,ri.inbound),this.events.emit(pe.message,t))}async acknowledgePayload(t){const n=rb(t.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(st.payload,this.onPayloadHandler),this.provider.off(st.connect,this.onConnectHandler),this.provider.off(st.disconnect,this.onDisconnectHandler),this.provider.off(st.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await Vg();S5(async n=>{t!==n&&(t=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Hn.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&B5())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(pe.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t,t?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},W.toMiliseconds(wu)))))}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function Gx(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function mb(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function wb(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Zx="[object RegExp]",Yx="[object String]",Wx="[object Number]",Xx="[object Boolean]",vb="[object Arguments]",Jx="[object Symbol]",Qx="[object Date]",e9="[object Map]",t9="[object Set]",n9="[object Array]",r9="[object Function]",i9="[object ArrayBuffer]",bf="[object Object]",s9="[object Error]",o9="[object DataView]",a9="[object Uint8Array]",c9="[object Uint8ClampedArray]",f9="[object Uint16Array]",u9="[object Uint32Array]",l9="[object BigUint64Array]",h9="[object Int8Array]",d9="[object Int16Array]",g9="[object Int32Array]",b9="[object BigInt64Array]",p9="[object Float32Array]",y9="[object Float64Array]";function m9(){}function Eb(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function w9(e,t,n){return zi(e,t,void 0,void 0,void 0,void 0,n)}function zi(e,t,n,r,i,s,o){const a=o(e,t,n,r,i,s);if(a!==void 0)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return Mi(e,t,s,o)}return Mi(e,t,s,o)}function Mi(e,t,n,r){if(Object.is(e,t))return!0;let i=wb(e),s=wb(t);if(i===vb&&(i=bf),s===vb&&(s=bf),i!==s)return!1;switch(i){case Yx:return e.toString()===t.toString();case Wx:{const f=e.valueOf(),c=t.valueOf();return Gx(f,c)}case Xx:case Qx:case Jx:return Object.is(e.valueOf(),t.valueOf());case Zx:return e.source===t.source&&e.flags===t.flags;case r9:return e===t}n=n??new Map;const o=n.get(e),a=n.get(t);if(o!=null&&a!=null)return o===t;n.set(e,t),n.set(t,e);try{switch(i){case e9:{if(e.size!==t.size)return!1;for(const[f,c]of e.entries())if(!t.has(f)||!zi(c,t.get(f),f,e,t,n,r))return!1;return!0}case t9:{if(e.size!==t.size)return!1;const f=Array.from(e.values()),c=Array.from(t.values());for(let u=0;u<f.length;u++){const d=f[u],h=c.findIndex(l=>zi(d,l,void 0,e,t,n,r));if(h===-1)return!1;c.splice(h,1)}return!0}case n9:case a9:case c9:case f9:case u9:case l9:case h9:case d9:case g9:case b9:case p9:case y9:{if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let f=0;f<e.length;f++)if(!zi(e[f],t[f],f,e,t,n,r))return!1;return!0}case i9:return e.byteLength!==t.byteLength?!1:Mi(new Uint8Array(e),new Uint8Array(t),n,r);case o9:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:Mi(new Uint8Array(e),new Uint8Array(t),n,r);case s9:return e.name===t.name&&e.message===t.message;case bf:{if(!(Mi(e.constructor,t.constructor,n,r)||Eb(e)&&Eb(t)))return!1;const c=[...Object.keys(e),...mb(e)],u=[...Object.keys(t),...mb(t)];if(c.length!==u.length)return!1;for(let d=0;d<c.length;d++){const h=c[d],l=e[h];if(!Object.hasOwn(t,h))return!1;const b=t[h];if(!zi(l,b,h,e,t,n,r))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function v9(e,t){return w9(e,t,m9)}var E9=Object.defineProperty,_b=Object.getOwnPropertySymbols,_9=Object.prototype.hasOwnProperty,x9=Object.prototype.propertyIsEnumerable,pf=(e,t,n)=>t in e?E9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xb=(e,t)=>{for(var n in t||(t={}))_9.call(t,n)&&pf(e,n,t[n]);if(_b)for(var n of _b(t))x9.call(t,n)&&pf(e,n,t[n]);return e},nt=(e,t,n)=>pf(e,typeof t!="symbol"?t+"":t,n);class Sb extends ry{constructor(t,n,r,i=vt,s=void 0){super(t,n,r,i),this.core=t,this.logger=n,this.name=r,nt(this,"map",new Map),nt(this,"version",vu),nt(this,"cached",[]),nt(this,"initialized",!1),nt(this,"getKey"),nt(this,"storagePrefix",vt),nt(this,"recentlyDeleted",[]),nt(this,"recentlyDeletedLimit",200),nt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Zr(o)?this.map.set(this.getKey(o),o):w5(o)?this.map.set(o.id,o):v5(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),nt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),nt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),nt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(f=>v9(a[f],o[f]))):this.values)),nt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const f=xb(xb({},this.getData(o)),a);this.map.set(o,f),await this.persist()}),nt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=it(n,this.name),this.storagePrefix=i,this.getKey=s}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const n=this.map.get(t);if(!n){if(this.recentlyDeleted.includes(t)){const{message:i}=oe("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var S9=Object.defineProperty,O9=(e,t,n)=>t in e?S9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ne=(e,t,n)=>O9(e,typeof t!="symbol"?t+"":t,n);class Ob{constructor(t,n){this.core=t,this.logger=n,ne(this,"name",Su),ne(this,"version",Ou),ne(this,"events",new lt.exports),ne(this,"pairings"),ne(this,"initialized",!1),ne(this,"storagePrefix",vt),ne(this,"ignoredPayloadTypes",[Kr]),ne(this,"registeredMethods",[]),ne(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ne(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ne(this,"create",async r=>{this.isInitialized();const i=ef(),s=await this.core.crypto.setSymKey(i),o=Ii(W.FIVE_MINUTES),a={protocol:bu},f={topic:s,expiry:o,relay:a,active:!1,methods:r?.methods},c=Mg({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(yr.create,f),this.core.expirer.set(s,o),await this.pairings.set(s,f),await this.core.relayer.subscribe(s,{transportType:r?.transportType,internal:r?.internal}),{topic:s,uri:c}}),ne(this,"pair",async r=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[Nt.pairing_started]}});this.isValidPair(r,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:f,methods:c}=zg(r.uri);i.props.properties.topic=s,i.addTrace(Nt.pairing_uri_validation_success),i.addTrace(Nt.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),i.addTrace(Nt.existing_pairing),u.active)throw i.setError(Mt.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(Nt.pairing_not_expired)}const d=f||Ii(W.FIVE_MINUTES),h={topic:s,relay:a,expiry:d,active:!1,methods:c};this.core.expirer.set(s,d),await this.pairings.set(s,h),i.addTrace(Nt.store_new_pairing),r.activatePairing&&await this.activate({topic:s}),this.events.emit(yr.create,h),i.addTrace(Nt.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(Nt.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Mt.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(l){throw i.setError(Mt.subscribe_pairing_topic_failure),l}return i.addTrace(Nt.subscribe_pairing_topic_success),h}),ne(this,"activate",async({topic:r})=>{this.isInitialized();const i=Ii(W.FIVE_MINUTES);this.core.expirer.set(r,i),await this.pairings.update(r,{active:!0,expiry:i})}),ne(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=r;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:f}=G6();this.events.once(Sc("pairing_ping",s),({error:c})=>{c?f(c):a()}),await o()}}),ne(this,"updateExpiry",async({topic:r,expiry:i})=>{this.isInitialized(),await this.pairings.update(r,{expiry:i})}),ne(this,"updateMetadata",async({topic:r,metadata:i})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:i})}),ne(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ne(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ui("USER_DISCONNECTED")),await this.deletePairing(i))}),ne(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=r,f=this.core.crypto.keychain.get(i);return Mg({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:f,relay:s,expiryTimestamp:o,methods:a})}),ne(this,"sendRequest",async(r,i,s)=>{const o=ff(i,s),a=await this.core.crypto.encode(r,o),f=pr[i].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,f),o.id}),ne(this,"sendResult",async(r,i,s)=>{const o=rb(r,s),a=await this.core.crypto.encode(i,o),f=(await this.core.history.get(i,r)).request.method,c=pr[f].res;await this.core.relayer.publish(i,a,c),await this.core.history.resolve(o)}),ne(this,"sendError",async(r,i,s)=>{const o=ib(r,s),a=await this.core.crypto.encode(i,o),f=(await this.core.history.get(i,r)).request.method,c=pr[f]?pr[f].res:pr.unregistered_method.res;await this.core.relayer.publish(i,a,c),await this.core.history.resolve(o)}),ne(this,"deletePairing",async(r,i)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Ui("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),i?Promise.resolve():this.core.expirer.del(r)])}),ne(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(i=>m0(i.expiry));await Promise.all(r.map(i=>this.deletePairing(i.topic)))}),ne(this,"onRelayEventRequest",async r=>{const{topic:i,payload:s}=r;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),ne(this,"onRelayEventResponse",async r=>{const{topic:i,payload:s}=r,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),ne(this,"onPairingPingRequest",async(r,i)=>{const{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult(s,r,!0),this.events.emit(yr.ping,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),ne(this,"onPairingPingResponse",(r,i)=>{const{id:s}=i;setTimeout(()=>{cb(i)?this.events.emit(Sc("pairing_ping",s),{}):po(i)&&this.events.emit(Sc("pairing_ping",s),{error:i.error})},500)}),ne(this,"onPairingDeleteRequest",async(r,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(yr.delete,{id:s,topic:r})}catch(o){await this.sendError(s,r,o),this.logger.error(o)}}),ne(this,"onUnknownRpcMethodRequest",async(r,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Ui("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,r,a),this.logger.error(a)}catch(a){await this.sendError(s,r,a),this.logger.error(a)}}),ne(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Ui("WC_METHOD_UNSUPPORTED",r))}),ne(this,"isValidPair",(r,i)=>{var s;if(!nf(r)){const{message:a}=oe("MISSING_OR_INVALID",`pair() params: ${r}`);throw i.setError(Mt.malformed_pairing_uri),new Error(a)}if(!m5(r.uri)){const{message:a}=oe("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw i.setError(Mt.malformed_pairing_uri),new Error(a)}const o=zg(r?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=oe("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Mt.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=oe("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Mt.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&W.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Mt.pairing_expired);const{message:a}=oe("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ne(this,"isValidPing",async r=>{if(!nf(r)){const{message:s}=oe("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidPairingTopic(i)}),ne(this,"isValidDisconnect",async r=>{if(!nf(r)){const{message:s}=oe("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidPairingTopic(i)}),ne(this,"isValidPairingTopic",async r=>{if(!qg(r,!1)){const{message:i}=oe("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.pairings.keys.includes(r)){const{message:i}=oe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(m0(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:i}=oe("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}),this.core=t,this.logger=it(n,this.name),this.pairings=new Sb(this.core,this.logger,this.name,this.storagePrefix)}get context(){return rt(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(pe.message,async t=>{const{topic:n,message:r,transportType:i}=t;if(this.pairings.keys.includes(n)&&i!==Zn.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const s=await this.core.crypto.decode(n,r);ab(s)?(this.core.history.set(n,s),await this.onRelayEventRequest({topic:n,payload:s})):uf(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:n,payload:s}),this.core.history.delete(n,s.id)),await this.core.relayer.messages.ack(n,r)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(dt.expired,async t=>{const{topic:n}=W6(t.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(yr.expire,{topic:n}))})}}var I9=Object.defineProperty,B9=(e,t,n)=>t in e?I9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,De=(e,t,n)=>B9(e,typeof t!="symbol"?t+"":t,n);class Ib extends Q1{constructor(t,n){super(t,n),this.core=t,this.logger=n,De(this,"records",new Map),De(this,"events",new lt.exports.EventEmitter),De(this,"name",Iu),De(this,"version",Bu),De(this,"cached",[]),De(this,"initialized",!1),De(this,"storagePrefix",vt),De(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),De(this,"set",(r,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:r,request:{method:i.method,params:i.params||null},chainId:s,expiry:Ii(W.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(ht.created,o)}),De(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const i=await this.getRecord(r.id);typeof i.response>"u"&&(i.response=po(r)?{error:r.error}:{result:r.result},this.records.set(i.id,i),this.persist(),this.events.emit(ht.updated,i))}),De(this,"get",async(r,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:i}),await this.getRecord(i))),De(this,"delete",(r,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===r){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(ht.deleted,s)}}),this.persist()}),De(this,"exists",async(r,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===r:!1)),De(this,"on",(r,i)=>{this.events.on(r,i)}),De(this,"once",(r,i)=>{this.events.once(r,i)}),De(this,"off",(r,i)=>{this.events.off(r,i)}),De(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=it(n,this.name)}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:ff(n.request.method,n.request.params,n.id),chainId:n.chainId};return t.push(r)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const n=this.records.get(t);if(!n){const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ht.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ht.created,t=>{const n=ht.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(ht.updated,t=>{const n=ht.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(ht.deleted,t=>{const n=ht.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.core.heartbeat.on(Hn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(n=>{W.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(ht.deleted,n,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var A9=Object.defineProperty,D9=(e,t,n)=>t in e?A9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ue=(e,t,n)=>D9(e,typeof t!="symbol"?t+"":t,n);class Bb extends sy{constructor(t,n){super(t,n),this.core=t,this.logger=n,Ue(this,"expirations",new Map),Ue(this,"events",new lt.exports.EventEmitter),Ue(this,"name",Au),Ue(this,"version",Du),Ue(this,"cached",[]),Ue(this,"initialized",!1),Ue(this,"storagePrefix",vt),Ue(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ue(this,"has",r=>{try{const i=this.formatTarget(r);return typeof this.getExpiration(i)<"u"}catch{return!1}}),Ue(this,"set",(r,i)=>{this.isInitialized();const s=this.formatTarget(r),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(dt.created,{target:s,expiration:o})}),Ue(this,"get",r=>{this.isInitialized();const i=this.formatTarget(r);return this.getExpiration(i)}),Ue(this,"del",r=>{if(this.isInitialized(),this.has(r)){const i=this.formatTarget(r),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(dt.deleted,{target:i,expiration:s})}}),Ue(this,"on",(r,i)=>{this.events.on(r,i)}),Ue(this,"once",(r,i)=>{this.events.once(r,i)}),Ue(this,"off",(r,i)=>{this.events.off(r,i)}),Ue(this,"removeListener",(r,i)=>{this.events.removeListener(r,i)}),this.logger=it(n,this.name)}get context(){return rt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Z6(t);if(typeof t=="number")return Y6(t);const{message:n}=oe("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(n)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(dt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:n}=oe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const n=this.expirations.get(t);if(!n){const{message:r}=oe("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(t,n){const{expiry:r}=n;W.toMiliseconds(r)-Date.now()<=0&&this.expire(t,n)}expire(t,n){this.expirations.delete(t),this.events.emit(dt.expired,{target:t,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,n)=>this.checkExpiry(n,t))}registerEventListeners(){this.core.heartbeat.on(Hn.pulse,()=>this.checkExpirations()),this.events.on(dt.created,t=>{const n=dt.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(dt.expired,t=>{const n=dt.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(dt.deleted,t=>{const n=dt.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=oe("NOT_INITIALIZED",this.name);throw new Error(t)}}}var T9=Object.defineProperty,R9=(e,t,n)=>t in e?T9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ye=(e,t,n)=>R9(e,typeof t!="symbol"?t+"":t,n);class Ab extends oy{constructor(t,n,r){super(t,n,r),this.core=t,this.logger=n,this.store=r,ye(this,"name",Tu),ye(this,"abortController"),ye(this,"isDevEnv"),ye(this,"verifyUrlV3",Nu),ye(this,"storagePrefix",vt),ye(this,"version",Uo),ye(this,"publicKey"),ye(this,"fetchPromise"),ye(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&W.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ye(this,"register",async i=>{if(!Oi()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,f=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const c=Er(),u=this.startAbortTimer(W.ONE_SECOND*5),d=await new Promise((h,l)=>{const b=()=>{window.removeEventListener("message",E),c.body.removeChild(y),l("attestation aborted")};this.abortController.signal.addEventListener("abort",b);const y=c.createElement("iframe");y.src=f,y.style.display="none",y.addEventListener("error",b,{signal:this.abortController.signal});const E=A=>{if(A.data&&typeof A.data=="string")try{const C=JSON.parse(A.data);if(C.type==="verify_attestation"){if(aa(C.attestation).payload.id!==o)return;clearInterval(u),c.body.removeChild(y),this.abortController.signal.removeEventListener("abort",b),window.removeEventListener("message",E),h(C.attestation===null?"":C.attestation)}}catch(C){this.logger.warn(C)}};c.body.appendChild(y),window.addEventListener("message",E,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(c){this.logger.warn(c)}return""}),ye(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(aa(s).payload.id!==a)return;const c=await this.isValidJwtAttestation(s);if(c){if(!c.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return c}}if(!o)return;const f=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,f)}),ye(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(W.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ye(this,"getVerifyUrl",i=>{let s=i||ii;return Cu.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${ii}`),s=ii),s}),ye(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(W.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),ye(this,"persistPublicKey",async i=>{this.logger.debug(i,"persisting public key to local storage"),await this.store.setItem(this.storeKey,i),this.publicKey=i}),ye(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ye(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ye(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ye(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),ye(this,"validateAttestation",(i,s)=>{const o=s5(i,s.publicKey),a={hasExpired:W.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=it(n,this.name),this.abortController=new AbortController,this.isDevEnv=v0(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return rt(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),W.toMiliseconds(t))}}var N9=Object.defineProperty,C9=(e,t,n)=>t in e?N9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Db=(e,t,n)=>C9(e,typeof t!="symbol"?t+"":t,n);class Tb extends ay{constructor(t,n){super(t,n),this.projectId=t,this.logger=n,Db(this,"context",$u),Db(this,"registerDeviceToken",async r=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=r,f=`${Pu}/${this.projectId}/clients`;await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=it(n,this.context)}}var $9=Object.defineProperty,Rb=Object.getOwnPropertySymbols,P9=Object.prototype.hasOwnProperty,L9=Object.prototype.propertyIsEnumerable,yf=(e,t,n)=>t in e?$9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qi=(e,t)=>{for(var n in t||(t={}))P9.call(t,n)&&yf(e,n,t[n]);if(Rb)for(var n of Rb(t))L9.call(t,n)&&yf(e,n,t[n]);return e},Oe=(e,t,n)=>yf(e,typeof t!="symbol"?t+"":t,n);class Nb extends cy{constructor(t,n,r=!0){super(t,n,r),this.core=t,this.logger=n,Oe(this,"context",Uu),Oe(this,"storagePrefix",vt),Oe(this,"storageVersion",Lu),Oe(this,"events",new Map),Oe(this,"shouldPersist",!1),Oe(this,"init",async()=>{if(!v0())try{const i={eventId:w0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:p0(this.core.relayer.protocol,this.core.relayer.version,ns)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Oe(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:f}}=i,c=w0(),u=this.core.projectId||"",d=Date.now(),h=qi({eventId:c,timestamp:d,props:{event:s,type:o,properties:{topic:a,trace:f}},bundleId:u,domain:this.getAppDomain()},this.setMethods(c));return this.telemetryEnabled&&(this.events.set(c,h),this.shouldPersist=!0),h}),Oe(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(f=>f.props.properties.topic===o);if(a)return qi(qi({},a),this.setMethods(a.eventId))}),Oe(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),Oe(this,"setEventListeners",()=>{this.core.heartbeat.on(Hn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{W.fromMiliseconds(Date.now())-W.fromMiliseconds(i.timestamp)>Fu&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Oe(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),Oe(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),Oe(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Oe(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Oe(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,qi(qi({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),Oe(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),Oe(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${ju}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${ns}${s}`,{method:"POST",body:JSON.stringify(i)})}),Oe(this,"getAppDomain",()=>q6().url),this.logger=it(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var U9=Object.defineProperty,Cb=Object.getOwnPropertySymbols,F9=Object.prototype.hasOwnProperty,j9=Object.prototype.propertyIsEnumerable,mf=(e,t,n)=>t in e?U9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$b=(e,t)=>{for(var n in t||(t={}))F9.call(t,n)&&mf(e,n,t[n]);if(Cb)for(var n of Cb(t))j9.call(t,n)&&mf(e,n,t[n]);return e},le=(e,t,n)=>mf(e,typeof t!="symbol"?t+"":t,n);class yo extends Y1{constructor(t){var n;super(t),le(this,"protocol",Lo),le(this,"version",Uo),le(this,"name",ni),le(this,"relayUrl"),le(this,"projectId"),le(this,"customStoragePrefix"),le(this,"events",new lt.exports.EventEmitter),le(this,"logger"),le(this,"heartbeat"),le(this,"relayer"),le(this,"crypto"),le(this,"storage"),le(this,"history"),le(this,"expirer"),le(this,"pairing"),le(this,"verify"),le(this,"echoClient"),le(this,"linkModeSupportedApps"),le(this,"eventClient"),le(this,"initialized",!1),le(this,"logChunkController"),le(this,"on",(a,f)=>this.events.on(a,f)),le(this,"once",(a,f)=>this.events.once(a,f)),le(this,"off",(a,f)=>this.events.off(a,f)),le(this,"removeListener",(a,f)=>this.events.removeListener(a,f)),le(this,"dispatchEnvelope",({topic:a,message:f,sessionExists:c})=>{if(!a||!f)return;const u={topic:a,message:f,publishedAt:Date.now(),transportType:Zn.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:c})});const r=this.getGlobalCore(t?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||jo,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const i=z1({level:typeof t?.logger=="string"&&t.logger?t.logger:su.logger,name:ni}),{logger:s,chunkLoggerController:o}=K1({opts:i,maxSizeInBytes:t?.maxLogBlobSizeInBytes,loggerOverride:t?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,f;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((f=this.logChunkController)==null||f.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=it(s,this.name),this.heartbeat=new Io,this.crypto=new Kg(this,this.logger,t?.keychain),this.history=new Ib(this,this.logger),this.expirer=new Bb(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new i1($b($b({},ou),t?.storageOptions)),this.relayer=new yb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ob(this,this.logger),this.verify=new Ab(this,this.logger,this.storage),this.echoClient=new Tb(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Nb(this,this.logger,t?.telemetryEnabled),this.setGlobalCore(this)}static async init(t){const n=new yo(t);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(Eu,r),n}get context(){return rt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(ko,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ko)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(t,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(t.message),t}}getGlobalCore(t=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${t}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(t){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=t.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=t}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&process.env.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}}const k9=yo;H.CORE_CONTEXT=ni,H.CORE_DEFAULT=su,H.CORE_PROTOCOL=Lo,H.CORE_STORAGE_OPTIONS=ou,H.CORE_STORAGE_PREFIX=vt,H.CORE_VERSION=Uo,H.CRYPTO_CLIENT_SEED=Fo,H.CRYPTO_CONTEXT=au,H.CRYPTO_JWT_TTL=cu,H.Core=k9,H.Crypto=Kg,H.ECHO_CONTEXT=$u,H.ECHO_URL=Pu,H.EVENTS_CLIENT_API_URL=ju,H.EVENTS_STORAGE_CLEANUP_INTERVAL=Fu,H.EVENTS_STORAGE_CONTEXT=Uu,H.EVENTS_STORAGE_VERSION=Lu,H.EVENT_CLIENT_AUTHENTICATE_ERRORS=vy,H.EVENT_CLIENT_AUTHENTICATE_TRACES=wy,H.EVENT_CLIENT_CONTEXT=py,H.EVENT_CLIENT_PAIRING_ERRORS=Mt,H.EVENT_CLIENT_PAIRING_TRACES=Nt,H.EVENT_CLIENT_SESSION_ERRORS=my,H.EVENT_CLIENT_SESSION_TRACES=yy,H.EXPIRER_CONTEXT=Au,H.EXPIRER_DEFAULT_TTL=gy,H.EXPIRER_EVENTS=dt,H.EXPIRER_STORAGE_VERSION=Du,H.EchoClient=Tb,H.EventClient=Nb,H.Expirer=Bb,H.HISTORY_CONTEXT=Iu,H.HISTORY_EVENTS=ht,H.HISTORY_STORAGE_VERSION=Bu,H.JsonRpcHistory=Ib,H.KEYCHAIN_CONTEXT=fu,H.KEYCHAIN_STORAGE_VERSION=uu,H.KeyChain=Hg,H.MESSAGES_CONTEXT=lu,H.MESSAGES_STORAGE_VERSION=hu,H.MESSAGE_DIRECTION=ri,H.MessageTracker=Zg,H.PAIRING_CONTEXT=Su,H.PAIRING_DEFAULT_TTL=dy,H.PAIRING_EVENTS=yr,H.PAIRING_RPC_OPTS=pr,H.PAIRING_STORAGE_VERSION=Ou,H.PENDING_SUB_RESOLUTION_TIMEOUT=hy,H.PUBLISHER_CONTEXT=gu,H.PUBLISHER_DEFAULT_TTL=du,H.Pairing=Ob,H.RELAYER_CONTEXT=yu,H.RELAYER_DEFAULT_LOGGER=pu,H.RELAYER_DEFAULT_PROTOCOL=bu,H.RELAYER_DEFAULT_RELAY_URL=jo,H.RELAYER_EVENTS=pe,H.RELAYER_PROVIDER_EVENTS=st,H.RELAYER_RECONNECT_TIMEOUT=wu,H.RELAYER_SDK_VERSION=ns,H.RELAYER_STORAGE_OPTIONS=fy,H.RELAYER_SUBSCRIBER_SUFFIX=mu,H.RELAYER_TRANSPORT_CUTOFF=uy,H.Relayer=yb,H.STORE_STORAGE_VERSION=vu,H.SUBSCRIBER_CONTEXT=_u,H.SUBSCRIBER_DEFAULT_TTL=ly,H.SUBSCRIBER_EVENTS=Ge,H.SUBSCRIBER_STORAGE_VERSION=xu,H.Store=Sb,H.Subscriber=gb,H.TRANSPORT_TYPES=Zn,H.TRUSTED_VERIFY_URLS=Cu,H.VERIFY_CONTEXT=Tu,H.VERIFY_SERVER=ii,H.VERIFY_SERVER_V3=Nu,H.Verify=Ab,H.WALLETCONNECT_CLIENT_ID=Eu,H.WALLETCONNECT_LINK_MODE_APPS=ko,H.default=yo,Object.defineProperty(H,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
